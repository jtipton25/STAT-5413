[
["index.html", "A Minimal Book Example Chapter 1 Prerequisites", " A Minimal Book Example Yihui Xie 2020-01-13 Chapter 1 Prerequisites This is a sample book written in Markdown. You can use anything that Pandoc’s Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). The bookdown package can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): https://yihui.name/tinytex/. "],
["intro.html", "Chapter 2 Introduction 2.1 Notation 2.2 Probability Distributions 2.3 Hierarchical modeling 2.4 Spatial Data 2.5 Types of spatial data", " Chapter 2 Introduction library(tidyverse) 2.1 Notation The dimensions of different mathematical objects are very important for the study of spatial statistics. To communicate this, we use the following notation. A scalar random variable is represented by a lowercase alphanumeric letter (\\(x\\), \\(y\\), \\(z\\), etc.), a vector random variable is respresented by a bold lowercase alphanumeric letter (\\(\\mathbf{x}\\), \\(\\mathbf{y}\\), \\(\\mathbf{z}\\), etc.), and a matrix random variable is respresented by a bold uppercase alphanumeric letter (\\(\\mathbf{X}\\), \\(\\mathbf{Y}\\), \\(\\mathbf{Z}\\), etc.). We use a similar notation for parameters as well where scalar parameters are represented by a lowercase Greek letter (\\(\\mu\\), \\(\\alpha\\), \\(\\beta\\), etc.), a vector parameter is respresented by a bold lowercase Greek letter (\\(\\boldsymbol{\\mu}\\), \\(\\boldsymbol{\\alpha}\\), \\(\\boldsymbol{\\beta}\\), etc.), and a matrix random variable is respresented by a bold uppercase Greek letter (\\(\\boldsymbol{\\Sigma}\\), \\(\\boldsymbol{\\Psi}\\), \\(\\boldsymbol{\\Gamma}\\), etc.). 2.2 Probability Distributions We also need notation to explain probability distributions. We use the notation \\([y]\\) to denote the probability density function \\(p(y)\\) of the random variable \\(y\\) and \\([y|x]\\) to denote the probability density function \\(p(y|x)\\) of \\(y\\) given \\(x\\). For example, if \\(y\\) is a Gaussian random variable with mean \\(\\mu\\) and standard deviation \\(\\sigma\\) we write \\[ \\begin{align*} [y | \\mu, \\sigma] &amp; = \\frac{1}{\\sqrt{2 \\pi \\sigma^2}} \\exp \\left\\{-\\frac{1}{2 \\sigma^2} (y - \\mu)^2 \\right\\}. \\end{align*} \\] We can also denote that \\(y\\) has a Gaussian (normal) distribution given mean \\(\\mu\\) and variance \\(\\sigma^2\\) using the \\(\\sim\\) notation \\[ \\begin{align*} y | \\mu, \\sigma &amp; \\sim \\operatorname{N}(\\mu, \\sigma^2). \\end{align*} \\] 2.2.1 Example: linear regression \\[ \\begin{align*} \\left[y_i | \\boldsymbol{\\theta} \\right] &amp; \\sim \\operatorname{N}(X_i \\beta, \\sigma^2) \\\\ \\boldsymbol{\\theta} &amp; = (\\beta, \\sigma^2) \\end{align*} \\] ## Sample data set.seed(404) dat &lt;- data.frame(x=(x=runif(200, 0, 50)), y=rnorm(200, 10 * x, 100)) ## breaks: where you want to compute densities breaks &lt;- seq(0, max(dat$x), len=7)[-c(1, 7)] dat$section &lt;- cut(dat$x, breaks) ## Get the residuals dat$res &lt;- residuals(lm(y ~ x, data=dat)) ## Compute densities for each section, and flip the axes, and add means of sections ## Note: the densities need to be scaled in relation to the section size (2000 here) ys &lt;- seq(-300, 300, length = 50) xs &lt;- rep(breaks, each = 50) + 1000 * dnorm(ys, 0, 100) res &lt;- matrix(0, 50, 5) for (i in 1:5) { res[, i] &lt;- 10 * breaks[i] + ys } dens &lt;- data.frame(x = xs, y=c(res), grouping = cut(xs, breaks)) ggplot(dat, aes(x, y)) + geom_point(size = 2) + geom_smooth(method=&quot;lm&quot;, fill=NA, lwd=2, se = FALSE) + geom_path(data=dens, aes(x, y, group = grouping), color=&quot;salmon&quot;, lwd=2) + theme_bw() + geom_vline(xintercept=breaks, lty=2) 2.3 Hierarchical modeling Follow Berliner (1996) framework for hierarchical probability models Model encodes our understanding of the scientific process of interest Model accounts for as much uncertainty as possible Model results in a probability distribution Note: nature may be deterministic – often probabilistic models outperform physical models. Example: model individual rain drops vs. probability/intensity of rain Update model with data Use the model to generate parameter estimates given data 2.3.1 Bayesian Hierarchical models (BHMs) Break the model into components: Data Model. Process Model. Parameter Model. Combined, the data model, the process model, and the parameter model define a posterior distribution. \\[ {\\Large \\begin{align*} \\color{cyan}{[\\mathbf{z}, \\boldsymbol{\\theta}_D, \\boldsymbol{\\theta}_P | \\mathbf{y}]} &amp; \\propto \\color{red}{[\\mathbf{y} | \\boldsymbol{\\theta}_D, \\mathbf{z}]} \\color{blue}{[\\mathbf{z} | \\boldsymbol{\\theta}_P]} \\color{orange}{[\\boldsymbol{\\theta}_D] [\\boldsymbol{\\theta}_P]} \\end{align*} }% \\] 2.3.2 Empirical Hierarchical models (EHMs) Break the model into components: Data Model. Process Model. Parameter estimates (fixed values) are substituted before fitting the model Combined, the data model and the process model define a predictive distribution. Thus, numerical evaluation of the predictive distribution is typically required to estimate unceratinty (bootstrap, MLE asymptotics) Note: the predictive distribution is not a posterior distribution because the normalizing constant is not known \\[ {\\Large \\begin{align*} \\color{plum}{[\\mathbf{z} | \\mathbf{y}]} &amp; \\propto \\color{red}{[\\mathbf{y} | \\boldsymbol{\\theta}_D, \\mathbf{z}]} \\color{blue}{[\\mathbf{z} | \\boldsymbol{\\theta}_P]} \\end{align*} }% \\] 2.3.3 Data Model \\[ {\\Large \\begin{align*} \\color{red}{[\\mathbf{y} | \\boldsymbol{\\theta}_D, \\mathbf{z}]} \\end{align*} } \\] Describes how the data are collected and observed. Account for measurement process and uncertainty. Model the data in the manner in which they were collected. Data \\(\\mathbf{y}\\). Noisy. Expensive. Not what you want to make inference on. Latent variables \\(\\mathbf{z}\\). Think of \\(\\mathbf{z}\\) as the ideal data. No measurement error - the exact quantity you want to observe but can’t. Data model parameters \\(\\boldsymbol{\\theta}_D\\). 2.3.4 Process Model \\[ {\\Large \\begin{align*} \\color{blue}{[\\mathbf{z} | \\boldsymbol{\\theta}_P]} \\end{align*} } \\] Where the science happens! Latent process \\(\\mathbf{z}\\) is modeled. Can be dynamic in space and/or time Process parameters \\(\\boldsymbol{\\theta}_P\\). Virtually all interesting scientific questions can be made with inference about \\(\\mathbf{z}\\) 2.3.5 Parameter (Prior) Model (BMHs only) \\[ {\\Large \\begin{align*} \\color{orange}{[\\boldsymbol{\\theta}_D] [\\boldsymbol{\\theta}_P]} \\end{align*} } \\] Probability distributions define “reasonable” ranges for parameters. Parameter models are useful for a variety of problems: Choosing important variables. Preventing over-fitting (regularization). “Pooling” estimates across categories. 2.3.6 Posterior Distribution \\[ {\\Large \\begin{align*} \\color{cyan}{[\\mathbf{z}, \\boldsymbol{\\theta}_D, \\boldsymbol{\\theta}_P | \\mathbf{y}]} &amp; \\propto [\\mathbf{y} | \\boldsymbol{\\theta}_D, \\mathbf{z}] [\\mathbf{z} | \\boldsymbol{\\theta}_P] [\\boldsymbol{\\theta}_D] [\\boldsymbol{\\theta}_P] \\end{align*} } \\] Probability distribution over all unknowns in the model. Inference is made using the posterior distribution. Because the posterior distribution is a probability distribution (BHMs), uncertainty is easy to calculate. This is not true for EHMs. 2.3.7 Scientifically Motivated Statistical Modeling Criticize the model Does the model fit the data well? Do the predictions make sense? Are there subsets of the data that don’t fit the model well? Make inference using the model. If the model fits the data, use the model fit for prediction or inference. 2.4 Spatial Data All data occur at some location is space and time. For know we focus on spatial analyses and will later extend this to spatio-temporal analyses. Let \\(\\mathcal{D}\\) represent the spatial domain and let \\(\\mathbf{s}\\) be a spatial location. In general, we will let \\(\\mathcal{A} \\subset \\mathcal{D}\\) be a subdomain of the spatial region of \\(\\mathbf{D}\\). Insert Diagram from class here 2.5 Types of spatial data There are three primary types of spatial data that we are going to consider Geostatistical data Occur everywhere continuous support examples: temperature, precipitation Areal data Occur only over discrete areas can be thought of as an integral of a continuous process over a subdomain \\(\\mathcal{A} \\in \\mathcal{D}\\) examples: cases of a disease by counties, votes in an election by congressional district Point process data The count and location of the data are random examples: tornados, lightning strikes References "],
["spatial-visualization.html", "Chapter 3 Spatial Visualization 3.1 Spatial data", " Chapter 3 Spatial Visualization library(tidyverse) library(here) Many different file types for spatial data Typically data are in “flat files” like comma-seperated value (CSV) files read.csv(here(&quot;path&quot;, &quot;to&quot;, &quot;file.csv&quot;)) “shapefiles” which can be read using rgdal or maptools packages library(rgdal) library(maptools) “NetCDF” files cane be read using ncdf4 or RNetCDF library(ncdf4) library(RNetCDF) 3.1 Spatial data To install the data from the textbook, go to https://spacetimewithr.org/ and follow the link to the code. # install.packages(&quot;devtools&quot;) library(devtools) install_github(&quot;andrewzm/STRbook&quot;) Note that this package is relatively large because it contains a decent amount of spatial data. library(STRbook) "],
["day-3.html", "Chapter 4 Day 3", " Chapter 4 Day 3 "],
["applications.html", "Chapter 5 Applications 5.1 Example one 5.2 Example two", " Chapter 5 Applications Some significant applications are demonstrated in this chapter. 5.1 Example one 5.2 Example two "],
["final-words.html", "Chapter 6 Final Words", " Chapter 6 Final Words We have finished a nice book. "],
["references.html", "References", " References "]
]
