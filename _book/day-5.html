<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Day 5 | Notes for STAT 5413 - Spatial Statistics</title>
  <meta name="description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Day 5 | Notes for STAT 5413 - Spatial Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Day 5 | Notes for STAT 5413 - Spatial Statistics" />
  
  <meta name="twitter:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

<meta name="author" content="John Tipton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day-4.html"/>
<link rel="next" href="day-6.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.12/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.9.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 5413 Spatial Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="day-1.html"><a href="day-1.html"><i class="fa fa-check"></i><b>1</b> Day 1</a><ul>
<li class="chapter" data-level="1.1" data-path="day-1.html"><a href="day-1.html#notation"><i class="fa fa-check"></i><b>1.1</b> Notation</a></li>
<li class="chapter" data-level="1.2" data-path="day-1.html"><a href="day-1.html#probability-distributions"><i class="fa fa-check"></i><b>1.2</b> Probability Distributions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="day-1.html"><a href="day-1.html#example-linear-regression"><i class="fa fa-check"></i><b>1.2.1</b> Example: linear regression</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="day-1.html"><a href="day-1.html#hierarchical-modeling"><i class="fa fa-check"></i><b>1.3</b> Hierarchical modeling</a><ul>
<li class="chapter" data-level="1.3.1" data-path="day-1.html"><a href="day-1.html#bayesian-hierarchical-models-bhms"><i class="fa fa-check"></i><b>1.3.1</b> Bayesian Hierarchical models (BHMs)</a></li>
<li class="chapter" data-level="1.3.2" data-path="day-1.html"><a href="day-1.html#empirical-hierarchical-models-ehms"><i class="fa fa-check"></i><b>1.3.2</b> Empirical Hierarchical models (EHMs)</a></li>
<li class="chapter" data-level="1.3.3" data-path="day-1.html"><a href="day-1.html#data-model"><i class="fa fa-check"></i><b>1.3.3</b> Data Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="day-1.html"><a href="day-1.html#process-model"><i class="fa fa-check"></i><b>1.3.4</b> Process Model</a></li>
<li class="chapter" data-level="1.3.5" data-path="day-1.html"><a href="day-1.html#parameter-prior-model-bmhs-only"><i class="fa fa-check"></i><b>1.3.5</b> Parameter (Prior) Model (BMHs only)</a></li>
<li class="chapter" data-level="1.3.6" data-path="day-1.html"><a href="day-1.html#posterior-distribution"><i class="fa fa-check"></i><b>1.3.6</b> Posterior Distribution</a></li>
<li class="chapter" data-level="1.3.7" data-path="day-1.html"><a href="day-1.html#scientifically-motivated-statistical-modeling"><i class="fa fa-check"></i><b>1.3.7</b> Scientifically Motivated Statistical Modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-2.html"><a href="day-2.html"><i class="fa fa-check"></i><b>2</b> Day 2</a><ul>
<li class="chapter" data-level="2.1" data-path="day-2.html"><a href="day-2.html#spatial-data"><i class="fa fa-check"></i><b>2.1</b> Spatial Data</a></li>
<li class="chapter" data-level="2.2" data-path="day-2.html"><a href="day-2.html#types-of-spatial-data"><i class="fa fa-check"></i><b>2.2</b> Types of spatial data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="day-2.html"><a href="day-2.html#geostatistical-data"><i class="fa fa-check"></i><b>2.2.1</b> Geostatistical data</a></li>
<li class="chapter" data-level="2.2.2" data-path="day-2.html"><a href="day-2.html#areal-data"><i class="fa fa-check"></i><b>2.2.2</b> Areal data</a></li>
<li class="chapter" data-level="2.2.3" data-path="day-2.html"><a href="day-2.html#point-process-data"><i class="fa fa-check"></i><b>2.2.3</b> Point process data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-3.html"><a href="day-3.html"><i class="fa fa-check"></i><b>3</b> Day 3</a><ul>
<li class="chapter" data-level="3.1" data-path="day-3.html"><a href="day-3.html#anouncements"><i class="fa fa-check"></i><b>3.1</b> Anouncements</a></li>
<li class="chapter" data-level="3.2" data-path="day-3.html"><a href="day-3.html#files-for-spatial-data"><i class="fa fa-check"></i><b>3.2</b> Files for spatial data</a></li>
<li class="chapter" data-level="3.3" data-path="day-3.html"><a href="day-3.html#textbook-package"><i class="fa fa-check"></i><b>3.3</b> Textbook package</a></li>
<li class="chapter" data-level="3.4" data-path="day-3.html"><a href="day-3.html#spatial-visualization"><i class="fa fa-check"></i><b>3.4</b> Spatial Visualization</a><ul>
<li class="chapter" data-level="3.4.1" data-path="day-3.html"><a href="day-3.html#spatial-visualization-using-fields"><i class="fa fa-check"></i><b>3.4.1</b> Spatial visualization using <em>fields</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-4.html"><a href="day-4.html"><i class="fa fa-check"></i><b>4</b> Day 4</a><ul>
<li class="chapter" data-level="4.1" data-path="day-4.html"><a href="day-4.html#announcements"><i class="fa fa-check"></i><b>4.1</b> Announcements</a></li>
<li class="chapter" data-level="4.2" data-path="day-4.html"><a href="day-4.html#visualization-continued"><i class="fa fa-check"></i><b>4.2</b> Visualization (continued)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="day-4.html"><a href="day-4.html#spatial-visualization-using-fields-1"><i class="fa fa-check"></i><b>4.2.1</b> Spatial visualization using <em>fields</em></a></li>
<li class="chapter" data-level="4.2.2" data-path="day-4.html"><a href="day-4.html#in-class-activity"><i class="fa fa-check"></i><b>4.2.2</b> In Class Activity:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day-4.html"><a href="day-4.html#interactive-visualization-interactive-with-html-format-only"><i class="fa fa-check"></i><b>4.3</b> Interactive visualization (Interactive with HTML format only)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="day-4.html"><a href="day-4.html#interactive-display-of-data"><i class="fa fa-check"></i><b>4.3.1</b> Interactive display of data</a></li>
<li class="chapter" data-level="4.3.2" data-path="day-4.html"><a href="day-4.html#animations"><i class="fa fa-check"></i><b>4.3.2</b> Animations</a></li>
<li class="chapter" data-level="4.3.3" data-path="day-4.html"><a href="day-4.html#interactive-plotting-using-plotly"><i class="fa fa-check"></i><b>4.3.3</b> Interactive plotting using <em>plotly</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day-5.html"><a href="day-5.html"><i class="fa fa-check"></i><b>5</b> Day 5</a><ul>
<li class="chapter" data-level="5.1" data-path="day-5.html"><a href="day-5.html#announcements-1"><i class="fa fa-check"></i><b>5.1</b> Announcements</a></li>
<li class="chapter" data-level="5.2" data-path="day-5.html"><a href="day-5.html#spatial-means-and-covariances"><i class="fa fa-check"></i><b>5.2</b> Spatial means and covariances</a><ul>
<li class="chapter" data-level="5.2.1" data-path="day-5.html"><a href="day-5.html#gaussian-processes"><i class="fa fa-check"></i><b>5.2.1</b> Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day-6.html"><a href="day-6.html"><i class="fa fa-check"></i><b>6</b> Day 6</a><ul>
<li class="chapter" data-level="6.1" data-path="day-6.html"><a href="day-6.html#announcements-2"><i class="fa fa-check"></i><b>6.1</b> Announcements</a></li>
<li class="chapter" data-level="6.2" data-path="day-6.html"><a href="day-6.html#gaussian-process-assumptions"><i class="fa fa-check"></i><b>6.2</b> Gaussian process assumptions</a></li>
<li class="chapter" data-level="6.3" data-path="day-6.html"><a href="day-6.html#recall-hierachical-modeling"><i class="fa fa-check"></i><b>6.3</b> Recall Hierachical modeling</a><ul>
<li class="chapter" data-level="6.3.1" data-path="day-6.html"><a href="day-6.html#data-model-1"><i class="fa fa-check"></i><b>6.3.1</b> Data Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="day-7.html"><a href="day-7.html"><i class="fa fa-check"></i><b>7</b> Day 7</a><ul>
<li class="chapter" data-level="7.1" data-path="day-7.html"><a href="day-7.html#common-isotropic-correlation-functions"><i class="fa fa-check"></i><b>7.1</b> Common isotropic correlation functions</a></li>
<li class="chapter" data-level="7.2" data-path="day-7.html"><a href="day-7.html#covariograms-and-semivariograms"><i class="fa fa-check"></i><b>7.2</b> Covariograms and semivariograms</a><ul>
<li class="chapter" data-level="7.2.1" data-path="day-7.html"><a href="day-7.html#semivariograms-and-variograms"><i class="fa fa-check"></i><b>7.2.1</b> Semivariograms and variograms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="day-8.html"><a href="day-8.html"><i class="fa fa-check"></i><b>8</b> Day 8</a><ul>
<li class="chapter" data-level="8.1" data-path="day-8.html"><a href="day-8.html#announcements-3"><i class="fa fa-check"></i><b>8.1</b> Announcements</a></li>
<li class="chapter" data-level="8.2" data-path="day-8.html"><a href="day-8.html#estimation-of-the-spatial-process"><i class="fa fa-check"></i><b>8.2</b> Estimation of the spatial process</a><ul>
<li class="chapter" data-level="8.2.1" data-path="day-8.html"><a href="day-8.html#estimation-of-the-spatial-process-using-variograms"><i class="fa fa-check"></i><b>8.2.1</b> Estimation of the spatial process using variograms</a></li>
<li class="chapter" data-level="8.2.2" data-path="day-8.html"><a href="day-8.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.2.2</b> Maximum Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="day-8.html"><a href="day-8.html#maximum-likelihood-1"><i class="fa fa-check"></i><b>8.3</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="day-9.html"><a href="day-9.html"><i class="fa fa-check"></i><b>9</b> Day 9</a><ul>
<li class="chapter" data-level="9.1" data-path="day-9.html"><a href="day-9.html#announcements-4"><i class="fa fa-check"></i><b>9.1</b> Announcements</a></li>
<li class="chapter" data-level="9.2" data-path="day-9.html"><a href="day-9.html#asymptotic-properties-of-the-mle"><i class="fa fa-check"></i><b>9.2</b> Asymptotic properties of the MLE</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="day-10.html"><a href="day-10.html"><i class="fa fa-check"></i><b>10</b> Day 10</a><ul>
<li class="chapter" data-level="10.1" data-path="day-10.html"><a href="day-10.html#announcements-5"><i class="fa fa-check"></i><b>10.1</b> Announcements</a></li>
<li class="chapter" data-level="10.2" data-path="day-10.html"><a href="day-10.html#asymptotic-properties-of-the-mle-1"><i class="fa fa-check"></i><b>10.2</b> Asymptotic properties of the MLE</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="day-11.html"><a href="day-11.html"><i class="fa fa-check"></i><b>11</b> Day 11</a><ul>
<li class="chapter" data-level="11.1" data-path="day-11.html"><a href="day-11.html#announcements-6"><i class="fa fa-check"></i><b>11.1</b> Announcements</a></li>
<li class="chapter" data-level="11.2" data-path="day-11.html"><a href="day-11.html#example-spatial-analysis"><i class="fa fa-check"></i><b>11.2</b> Example spatial analysis</a></li>
<li class="chapter" data-level="11.3" data-path="day-11.html"><a href="day-11.html#spatial-model-fitting"><i class="fa fa-check"></i><b>11.3</b> Spatial model fitting</a><ul>
<li class="chapter" data-level="11.3.1" data-path="day-11.html"><a href="day-11.html#fit-the-maximum-likelihood-estimate-using-the-geor-package"><i class="fa fa-check"></i><b>11.3.1</b> Fit the maximum likelihood estimate using the <em>geoR</em> package</a></li>
<li class="chapter" data-level="11.3.2" data-path="day-11.html"><a href="day-11.html#fitting-a-spatial-model-using-the-nlme-package"><i class="fa fa-check"></i><b>11.3.2</b> Fitting a spatial model using the <em>nlme</em> package</a></li>
<li class="chapter" data-level="11.3.3" data-path="day-11.html"><a href="day-11.html#model-fitting-with-autokrige-function"><i class="fa fa-check"></i><b>11.3.3</b> model fitting with <em>autokrige</em> function</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="day-11.html"><a href="day-11.html#kriging"><i class="fa fa-check"></i><b>11.4</b> Kriging</a><ul>
<li class="chapter" data-level="11.4.1" data-path="day-11.html"><a href="day-11.html#kriging-equations-with-mean-mu-0"><i class="fa fa-check"></i><b>11.4.1</b> Kriging Equations with mean <span class="math inline">\(\mu = 0\)</span></a></li>
<li class="chapter" data-level="11.4.2" data-path="day-11.html"><a href="day-11.html#kriging-equations-with-unknown-mean"><i class="fa fa-check"></i><b>11.4.2</b> Kriging Equations with unknown mean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="day-12.html"><a href="day-12.html"><i class="fa fa-check"></i><b>12</b> Day 12</a><ul>
<li class="chapter" data-level="12.1" data-path="day-12.html"><a href="day-12.html#announcements-7"><i class="fa fa-check"></i><b>12.1</b> Announcements</a></li>
<li class="chapter" data-level="12.2" data-path="day-12.html"><a href="day-12.html#introduction-to-mcmc"><i class="fa fa-check"></i><b>12.2</b> Introduction to MCMC</a></li>
<li class="chapter" data-level="12.3" data-path="day-12.html"><a href="day-12.html#example-simple-linear-regression"><i class="fa fa-check"></i><b>12.3</b> Example: Simple linear regression</a></li>
<li class="chapter" data-level="12.4" data-path="day-12.html"><a href="day-12.html#the-posterior-distribution"><i class="fa fa-check"></i><b>12.4</b> The posterior distribution</a><ul>
<li class="chapter" data-level="12.4.1" data-path="day-12.html"><a href="day-12.html#full-conditional-distribution-of-mu"><i class="fa fa-check"></i><b>12.4.1</b> Full conditional distribution of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="12.4.2" data-path="day-12.html"><a href="day-12.html#full-conditional-distribution-for-beta"><i class="fa fa-check"></i><b>12.4.2</b> Full conditional distribution for <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="12.4.3" data-path="day-12.html"><a href="day-12.html#full-conditional-distribution-for-sigma2"><i class="fa fa-check"></i><b>12.4.3</b> Full conditional distribution for <span class="math inline">\(\sigma^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="day-12.html"><a href="day-12.html#fitting-the-model"><i class="fa fa-check"></i><b>12.5</b> Fitting the model</a><ul>
<li class="chapter" data-level="12.5.1" data-path="day-12.html"><a href="day-12.html#general-recommendations-for-writing-mcmc-software"><i class="fa fa-check"></i><b>12.5.1</b> General recommendations for writing MCMC software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="day-13.html"><a href="day-13.html"><i class="fa fa-check"></i><b>13</b> Day 13</a><ul>
<li class="chapter" data-level="13.1" data-path="day-13.html"><a href="day-13.html#announcements-8"><i class="fa fa-check"></i><b>13.1</b> Announcements</a></li>
<li class="chapter" data-level="13.2" data-path="day-13.html"><a href="day-13.html#the-metropolis-algorithm"><i class="fa fa-check"></i><b>13.2</b> The Metropolis Algorithm</a></li>
<li class="chapter" data-level="13.3" data-path="day-13.html"><a href="day-13.html#the-proposal-distribution"><i class="fa fa-check"></i><b>13.3</b> The proposal distribution</a></li>
<li class="chapter" data-level="13.4" data-path="day-13.html"><a href="day-13.html#the-metropolis-update"><i class="fa fa-check"></i><b>13.4</b> The Metropolis update</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="day-14.html"><a href="day-14.html"><i class="fa fa-check"></i><b>14</b> Day 14</a><ul>
<li class="chapter" data-level="14.1" data-path="day-14.html"><a href="day-14.html#announcements-9"><i class="fa fa-check"></i><b>14.1</b> Announcements</a></li>
<li class="chapter" data-level="14.2" data-path="day-14.html"><a href="day-14.html#the-metropolis-hastings-algorithm"><i class="fa fa-check"></i><b>14.2</b> The Metropolis-Hastings Algorithm</a></li>
<li class="chapter" data-level="14.3" data-path="day-14.html"><a href="day-14.html#the-metropolis-hastings-algorithm-1"><i class="fa fa-check"></i><b>14.3</b> The Metropolis-Hastings algorithm</a></li>
<li class="chapter" data-level="14.4" data-path="day-14.html"><a href="day-14.html#example-1"><i class="fa fa-check"></i><b>14.4</b> Example</a></li>
<li class="chapter" data-level="14.5" data-path="day-14.html"><a href="day-14.html#posterior"><i class="fa fa-check"></i><b>14.5</b> Posterior</a></li>
<li class="chapter" data-level="14.6" data-path="day-14.html"><a href="day-14.html#conditional-posterior-for-phi"><i class="fa fa-check"></i><b>14.6</b> Conditional posterior for <span class="math inline">\(\phi\)</span></a></li>
<li class="chapter" data-level="14.7" data-path="day-14.html"><a href="day-14.html#conditional-posterior-for-sigma2"><i class="fa fa-check"></i><b>14.7</b> Conditional posterior for <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="14.8" data-path="day-14.html"><a href="day-14.html#mcmc-using-a-symmetric-proposal-metropolis"><i class="fa fa-check"></i><b>14.8</b> MCMC using a symmetric proposal (Metropolis)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="day-15.html"><a href="day-15.html"><i class="fa fa-check"></i><b>15</b> Day 15</a><ul>
<li class="chapter" data-level="15.1" data-path="day-15.html"><a href="day-15.html#announcements-10"><i class="fa fa-check"></i><b>15.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="day-16.html"><a href="day-16.html"><i class="fa fa-check"></i><b>16</b> Day 16</a><ul>
<li class="chapter" data-level="16.1" data-path="day-16.html"><a href="day-16.html#announcements-11"><i class="fa fa-check"></i><b>16.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="day-17.html"><a href="day-17.html"><i class="fa fa-check"></i><b>17</b> Day 17</a><ul>
<li class="chapter" data-level="17.1" data-path="day-17.html"><a href="day-17.html#announcements-12"><i class="fa fa-check"></i><b>17.1</b> Announcements</a></li>
<li class="chapter" data-level="17.2" data-path="day-17.html"><a href="day-17.html#gaussian-process-representations"><i class="fa fa-check"></i><b>17.2</b> Gaussian process representations</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="day-18.html"><a href="day-18.html"><i class="fa fa-check"></i><b>18</b> Day 18</a><ul>
<li class="chapter" data-level="18.1" data-path="day-18.html"><a href="day-18.html#announcements-13"><i class="fa fa-check"></i><b>18.1</b> Announcements</a></li>
<li class="chapter" data-level="18.2" data-path="day-18.html"><a href="day-18.html#gaussian-process-representations-continued"><i class="fa fa-check"></i><b>18.2</b> Gaussian process representations continued</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="day-19.html"><a href="day-19.html"><i class="fa fa-check"></i><b>19</b> Day 19</a><ul>
<li class="chapter" data-level="19.1" data-path="day-19.html"><a href="day-19.html#announcements-14"><i class="fa fa-check"></i><b>19.1</b> Announcements</a></li>
<li class="chapter" data-level="19.2" data-path="day-19.html"><a href="day-19.html#stochastic-integration"><i class="fa fa-check"></i><b>19.2</b> Stochastic Integration</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="day-20.html"><a href="day-20.html"><i class="fa fa-check"></i><b>20</b> Day 20</a><ul>
<li class="chapter" data-level="20.1" data-path="day-20.html"><a href="day-20.html#announcements-15"><i class="fa fa-check"></i><b>20.1</b> Announcements</a></li>
<li class="chapter" data-level="20.2" data-path="day-20.html"><a href="day-20.html#spbayes-example"><i class="fa fa-check"></i><b>20.2</b> spBayes example</a></li>
<li class="chapter" data-level="20.3" data-path="day-20.html"><a href="day-20.html#global-vs.local-basis-function"><i class="fa fa-check"></i><b>20.3</b> Global vs. Local Basis function</a><ul>
<li class="chapter" data-level="20.3.1" data-path="day-20.html"><a href="day-20.html#an-example-global-basis-fourier-basis"><i class="fa fa-check"></i><b>20.3.1</b> An example global basis: Fourier Basis</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="day-20.html"><a href="day-20.html#example-local-basis"><i class="fa fa-check"></i><b>20.4</b> example local basis</a></li>
<li class="chapter" data-level="20.5" data-path="day-20.html"><a href="day-20.html#fitting-spatial-models-many-ways"><i class="fa fa-check"></i><b>20.5</b> Fitting spatial models many ways</a></li>
<li class="chapter" data-level="20.6" data-path="day-20.html"><a href="day-20.html#empirical-orthogonal-functions"><i class="fa fa-check"></i><b>20.6</b> Empirical Orthogonal Functions</a></li>
<li class="chapter" data-level="20.7" data-path="day-20.html"><a href="day-20.html#spatial-modeling-with-mgcv-package"><i class="fa fa-check"></i><b>20.7</b> Spatial modeling with <code>mgcv</code> package</a></li>
<li class="chapter" data-level="20.8" data-path="day-20.html"><a href="day-20.html#spatial-modeling-with-kernels"><i class="fa fa-check"></i><b>20.8</b> Spatial modeling with Kernels</a><ul>
<li class="chapter" data-level="20.8.1" data-path="day-20.html"><a href="day-20.html#kernel-regression-with-a-ridge-penalty"><i class="fa fa-check"></i><b>20.8.1</b> Kernel regression with a ridge penalty</a></li>
<li class="chapter" data-level="20.8.2" data-path="day-20.html"><a href="day-20.html#kernel-regression-with-a-lasso-penalty"><i class="fa fa-check"></i><b>20.8.2</b> Kernel regression with a lasso penalty</a></li>
<li class="chapter" data-level="20.8.3" data-path="day-20.html"><a href="day-20.html#truncated-kernels---local-support"><i class="fa fa-check"></i><b>20.8.3</b> Truncated Kernels - local support</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="day-20.html"><a href="day-20.html#sparse-vs.dense-matrix-computation"><i class="fa fa-check"></i><b>20.9</b> Sparse vs. Dense matrix computation</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="day-21.html"><a href="day-21.html"><i class="fa fa-check"></i><b>21</b> Day 21</a><ul>
<li class="chapter" data-level="21.1" data-path="day-21.html"><a href="day-21.html#announcements-16"><i class="fa fa-check"></i><b>21.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="day-22.html"><a href="day-22.html"><i class="fa fa-check"></i><b>22</b> Day 22</a><ul>
<li class="chapter" data-level="22.1" data-path="day-22.html"><a href="day-22.html#announcements-17"><i class="fa fa-check"></i><b>22.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="day-23.html"><a href="day-23.html"><i class="fa fa-check"></i><b>23</b> Day 23</a><ul>
<li class="chapter" data-level="23.1" data-path="day-23.html"><a href="day-23.html#announcements-18"><i class="fa fa-check"></i><b>23.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html"><i class="fa fa-check"></i><b>24</b> Day 24 – Scaling GPs for large data</a><ul>
<li class="chapter" data-level="24.1" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#announcements-19"><i class="fa fa-check"></i><b>24.1</b> Announcements</a></li>
<li class="chapter" data-level="24.2" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#local-analysis"><i class="fa fa-check"></i><b>24.2</b> Local analysis</a></li>
<li class="chapter" data-level="24.3" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#low-rank-approimxations"><i class="fa fa-check"></i><b>24.3</b> Low rank approimxations</a></li>
<li class="chapter" data-level="24.4" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#spectral-basis-functions"><i class="fa fa-check"></i><b>24.4</b> Spectral basis functions</a></li>
<li class="chapter" data-level="24.5" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#kernel-convolutions"><i class="fa fa-check"></i><b>24.5</b> Kernel convolutions</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html"><i class="fa fa-check"></i><b>25</b> Day 25 – Scaling GPs for large data</a><ul>
<li class="chapter" data-level="25.1" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#announcements-20"><i class="fa fa-check"></i><b>25.1</b> Announcements</a></li>
<li class="chapter" data-level="25.2" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#gaussian-predictive-process-spbayes-package"><i class="fa fa-check"></i><b>25.2</b> <span>Gaussian Predictive Process</span> (spBayes package)</a></li>
<li class="chapter" data-level="25.3" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#sparse-matrix-routines"><i class="fa fa-check"></i><b>25.3</b> Sparse matrix routines</a></li>
<li class="chapter" data-level="25.4" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#the-stochastic-pde-approach"><i class="fa fa-check"></i><b>25.4</b> The stochastic PDE approach</a></li>
<li class="chapter" data-level="25.5" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#approximate-likelihood-methods"><i class="fa fa-check"></i><b>25.5</b> Approximate likelihood methods</a></li>
<li class="chapter" data-level="25.6" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#vecchia-approximations"><i class="fa fa-check"></i><b>25.6</b> Vecchia Approximations</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="day-26.html"><a href="day-26.html"><i class="fa fa-check"></i><b>26</b> Day 26</a><ul>
<li class="chapter" data-level="26.1" data-path="day-26.html"><a href="day-26.html#announcements-21"><i class="fa fa-check"></i><b>26.1</b> Announcements</a></li>
<li class="chapter" data-level="26.2" data-path="day-26.html"><a href="day-26.html#multivariate-data"><i class="fa fa-check"></i><b>26.2</b> Multivariate Data</a></li>
<li class="chapter" data-level="26.3" data-path="day-26.html"><a href="day-26.html#classical-multivariate-geostatistics"><i class="fa fa-check"></i><b>26.3</b> Classical Multivariate Geostatistics</a><ul>
<li class="chapter" data-level="26.3.1" data-path="day-26.html"><a href="day-26.html#cross-variograms-and-cross-covariance-functions"><i class="fa fa-check"></i><b>26.3.1</b> cross-variograms and cross-covariance functions</a></li>
<li class="chapter" data-level="26.3.2" data-path="day-26.html"><a href="day-26.html#cokriging"><i class="fa fa-check"></i><b>26.3.2</b> Cokriging</a></li>
<li class="chapter" data-level="26.3.3" data-path="day-26.html"><a href="day-26.html#linear-model-of-coregionalization"><i class="fa fa-check"></i><b>26.3.3</b> Linear Model of Coregionalization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="day-27.html"><a href="day-27.html"><i class="fa fa-check"></i><b>27</b> Day 27</a><ul>
<li class="chapter" data-level="27.1" data-path="day-27.html"><a href="day-27.html#announcements-22"><i class="fa fa-check"></i><b>27.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="day-28.html"><a href="day-28.html"><i class="fa fa-check"></i><b>28</b> Day 28</a><ul>
<li class="chapter" data-level="28.1" data-path="day-28.html"><a href="day-28.html#announcements-23"><i class="fa fa-check"></i><b>28.1</b> Announcements</a></li>
<li class="chapter" data-level="28.2" data-path="day-28.html"><a href="day-28.html#intro-to-stan"><i class="fa fa-check"></i><b>28.2</b> Intro to stan</a><ul>
<li class="chapter" data-level="28.2.1" data-path="day-28.html"><a href="day-28.html#example-linear-regression-1"><i class="fa fa-check"></i><b>28.2.1</b> Example: Linear regression</a></li>
<li class="chapter" data-level="28.2.2" data-path="day-28.html"><a href="day-28.html#example-spatial-model-in-stan"><i class="fa fa-check"></i><b>28.2.2</b> Example: Spatial model in stan</a></li>
<li class="chapter" data-level="28.2.3" data-path="day-28.html"><a href="day-28.html#example-predictive-process-model-in-stan"><i class="fa fa-check"></i><b>28.2.3</b> Example: Predictive process model in stan</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="day-28.html"><a href="day-28.html#stan-hints-and-tips"><i class="fa fa-check"></i><b>28.3</b> stan Hints and tips</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="day-29.html"><a href="day-29.html"><i class="fa fa-check"></i><b>29</b> Day 29</a><ul>
<li class="chapter" data-level="29.1" data-path="day-29.html"><a href="day-29.html#announcements-24"><i class="fa fa-check"></i><b>29.1</b> Announcements</a></li>
<li class="chapter" data-level="29.2" data-path="day-29.html"><a href="day-29.html#areal-data-1"><i class="fa fa-check"></i><b>29.2</b> Areal Data</a></li>
<li class="chapter" data-level="29.3" data-path="day-29.html"><a href="day-29.html#gaussian-markov-random-fields-gmrfs"><i class="fa fa-check"></i><b>29.3</b> Gaussian Markov random fields (GMRFs)</a><ul>
<li class="chapter" data-level="29.3.1" data-path="day-29.html"><a href="day-29.html#example-2"><i class="fa fa-check"></i><b>29.3.1</b> Example:</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="day-29.html"><a href="day-29.html#conditional-autoregressive-models-car-models"><i class="fa fa-check"></i><b>29.4</b> Conditional Autoregressive models (CAR models)</a><ul>
<li class="chapter" data-level="29.4.1" data-path="day-29.html"><a href="day-29.html#models-built-based-on-conditional-distributions-y_i-mathbfy_-i"><i class="fa fa-check"></i><b>29.4.1</b> Models built based on conditional distributions: <span class="math inline">\(y_i | \mathbf{y}_{-i}\)</span></a></li>
<li class="chapter" data-level="29.4.2" data-path="day-29.html"><a href="day-29.html#simultaneous-autoregressive-sar-model"><i class="fa fa-check"></i><b>29.4.2</b> Simultaneous autoregressive (SAR) model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="day-30.html"><a href="day-30.html"><i class="fa fa-check"></i><b>30</b> Day 30</a><ul>
<li class="chapter" data-level="30.1" data-path="day-30.html"><a href="day-30.html#announcements-25"><i class="fa fa-check"></i><b>30.1</b> Announcements</a></li>
<li class="chapter" data-level="30.2" data-path="day-30.html"><a href="day-30.html#change-of-spatial-support"><i class="fa fa-check"></i><b>30.2</b> Change of Spatial Support</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="day-31.html"><a href="day-31.html"><i class="fa fa-check"></i><b>31</b> Day 31</a><ul>
<li class="chapter" data-level="31.1" data-path="day-31.html"><a href="day-31.html#announcements-26"><i class="fa fa-check"></i><b>31.1</b> Announcements</a></li>
<li class="chapter" data-level="31.2" data-path="day-31.html"><a href="day-31.html#generalized-non-gaussian-spatial-models"><i class="fa fa-check"></i><b>31.2</b> Generalized (non-Gaussian) spatial models</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="day-32.html"><a href="day-32.html"><i class="fa fa-check"></i><b>32</b> Day 32</a><ul>
<li class="chapter" data-level="32.1" data-path="day-32.html"><a href="day-32.html#announcements-27"><i class="fa fa-check"></i><b>32.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="day-33.html"><a href="day-33.html"><i class="fa fa-check"></i><b>33</b> Day 33</a><ul>
<li class="chapter" data-level="33.1" data-path="day-33.html"><a href="day-33.html#announcements-28"><i class="fa fa-check"></i><b>33.1</b> Announcements</a></li>
<li class="chapter" data-level="33.2" data-path="day-33.html"><a href="day-33.html#spatio-temporal-data"><i class="fa fa-check"></i><b>33.2</b> Spatio-temporal data</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="day-34.html"><a href="day-34.html"><i class="fa fa-check"></i><b>34</b> Day 34</a><ul>
<li class="chapter" data-level="34.1" data-path="day-34.html"><a href="day-34.html#announcements-29"><i class="fa fa-check"></i><b>34.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="day-35.html"><a href="day-35.html"><i class="fa fa-check"></i><b>35</b> Day 35</a><ul>
<li class="chapter" data-level="35.1" data-path="day-35.html"><a href="day-35.html#announcements-30"><i class="fa fa-check"></i><b>35.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="day-36.html"><a href="day-36.html"><i class="fa fa-check"></i><b>36</b> Day 36</a><ul>
<li class="chapter" data-level="36.1" data-path="day-36.html"><a href="day-36.html#announcements-31"><i class="fa fa-check"></i><b>36.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="day-37.html"><a href="day-37.html"><i class="fa fa-check"></i><b>37</b> Day 37</a><ul>
<li class="chapter" data-level="37.1" data-path="day-37.html"><a href="day-37.html#announcements-32"><i class="fa fa-check"></i><b>37.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="day-38.html"><a href="day-38.html"><i class="fa fa-check"></i><b>38</b> Day 38</a><ul>
<li class="chapter" data-level="38.1" data-path="day-38.html"><a href="day-38.html#announcements-33"><i class="fa fa-check"></i><b>38.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="day-39.html"><a href="day-39.html"><i class="fa fa-check"></i><b>39</b> Day 39</a><ul>
<li class="chapter" data-level="39.1" data-path="day-39.html"><a href="day-39.html#announcements-34"><i class="fa fa-check"></i><b>39.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="day-40.html"><a href="day-40.html"><i class="fa fa-check"></i><b>40</b> Day 40</a><ul>
<li class="chapter" data-level="40.1" data-path="day-40.html"><a href="day-40.html#announcements-35"><i class="fa fa-check"></i><b>40.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="day-41.html"><a href="day-41.html"><i class="fa fa-check"></i><b>41</b> Day 41</a><ul>
<li class="chapter" data-level="41.1" data-path="day-41.html"><a href="day-41.html#announcements-36"><i class="fa fa-check"></i><b>41.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="day-42.html"><a href="day-42.html"><i class="fa fa-check"></i><b>42</b> Day 42</a><ul>
<li class="chapter" data-level="42.1" data-path="day-42.html"><a href="day-42.html#announcements-37"><i class="fa fa-check"></i><b>42.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="day-43.html"><a href="day-43.html"><i class="fa fa-check"></i><b>43</b> Day 43</a><ul>
<li class="chapter" data-level="43.1" data-path="day-43.html"><a href="day-43.html#announcements-38"><i class="fa fa-check"></i><b>43.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for STAT 5413 - Spatial Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-5" class="section level1">
<h1><span class="header-section-number">5</span> Day 5</h1>
<div id="announcements-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Announcements</h2>
<ul>
<li>HW Assignment</li>
<li>Another datacamp coming soon</li>
</ul>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="kw">library</span>(fields)</a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="kw">library</span>(mvnfast)</a>
<a class="sourceLine" id="cb108-4" data-line-number="4"><span class="kw">library</span>(plotly)</a>
<a class="sourceLine" id="cb108-5" data-line-number="5"><span class="kw">library</span>(splines)</a>
<a class="sourceLine" id="cb108-6" data-line-number="6"><span class="kw">set.seed</span>(<span class="dv">404</span>)</a></code></pre></div>
</div>
<div id="spatial-means-and-covariances" class="section level2">
<h2><span class="header-section-number">5.2</span> Spatial means and covariances</h2>
<p>Let <span class="math inline">\(\{ y(\mathbf{s}_i) \}\)</span> be a set of observations of a process at locations <span class="math inline">\(\{ \mathbf{s}_i \in \mathcal{D}, i = 1, \ldots, n \}\)</span>.</p>
<ul>
<li>In one dimension, <span class="math inline">\(y(\mathbf{s})\)</span> is a curve</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2">s &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> n)</a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="co">## calculate the pairwise distance between locations</span></a>
<a class="sourceLine" id="cb109-4" data-line-number="4"><span class="co">## rdist from the fields package is much faster than the dist function</span></a>
<a class="sourceLine" id="cb109-5" data-line-number="5">D &lt;-<span class="st"> </span><span class="kw">rdist</span>(s, s)</a>
<a class="sourceLine" id="cb109-6" data-line-number="6">Sigma &lt;-<span class="st"> </span><span class="kw">exp</span>( <span class="op">-</span><span class="st"> </span>D)</a>
<a class="sourceLine" id="cb109-7" data-line-number="7">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb109-8" data-line-number="8">    <span class="dt">s =</span> s,</a>
<a class="sourceLine" id="cb109-9" data-line-number="9">    <span class="dt">y =</span> <span class="kw">c</span>(<span class="kw">rmvn</span>(<span class="dv">1</span>, <span class="dt">mu =</span> <span class="kw">rep</span>(<span class="dv">0</span>, n), <span class="dt">sigma =</span> Sigma))</a>
<a class="sourceLine" id="cb109-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb109-11" data-line-number="11"></a>
<a class="sourceLine" id="cb109-12" data-line-number="12">dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-13" data-line-number="13"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> s, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb109-15" data-line-number="15"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;y(s)&quot;</span>)</a></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<ul>
<li>In two dimensions, <span class="math inline">\(y(\mathbf{s})\)</span> is a surface</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2">s &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</a>
<a class="sourceLine" id="cb110-3" data-line-number="3">    <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="kw">sqrt</span>(n)),</a>
<a class="sourceLine" id="cb110-4" data-line-number="4">    <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="kw">sqrt</span>(n))</a>
<a class="sourceLine" id="cb110-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb110-6" data-line-number="6">    </a>
<a class="sourceLine" id="cb110-7" data-line-number="7"><span class="co">## calculate the pairwise distance between locations</span></a>
<a class="sourceLine" id="cb110-8" data-line-number="8"><span class="co">## rdist from the fields package is much faster than the dist function</span></a>
<a class="sourceLine" id="cb110-9" data-line-number="9">D &lt;-<span class="st"> </span><span class="kw">rdist</span>(s, s)</a>
<a class="sourceLine" id="cb110-10" data-line-number="10">Sigma &lt;-<span class="st"> </span><span class="kw">exp</span>( <span class="op">-</span><span class="st"> </span>D)</a>
<a class="sourceLine" id="cb110-11" data-line-number="11">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb110-12" data-line-number="12">    <span class="dt">s1 =</span> s[, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb110-13" data-line-number="13">    <span class="dt">s2 =</span> s[, <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb110-14" data-line-number="14">    <span class="dt">y  =</span> <span class="kw">c</span>(<span class="kw">rmvn</span>(<span class="dv">1</span>, <span class="dt">mu =</span> <span class="kw">rep</span>(<span class="dv">0</span>, n), <span class="dt">sigma =</span> Sigma))</a>
<a class="sourceLine" id="cb110-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb110-16" data-line-number="16"></a>
<a class="sourceLine" id="cb110-17" data-line-number="17"></a>
<a class="sourceLine" id="cb110-18" data-line-number="18"><span class="kw">plot_ly</span>(</a>
<a class="sourceLine" id="cb110-19" data-line-number="19">    <span class="dt">z =</span> <span class="op">~</span><span class="kw">matrix</span>(dat<span class="op">$</span>y, <span class="kw">sqrt</span>(n), <span class="kw">sqrt</span>(n))</a>
<a class="sourceLine" id="cb110-20" data-line-number="20">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-21" data-line-number="21"><span class="st">    </span><span class="kw">add_surface</span>()</a></code></pre></div>
<div id="htmlwidget-4a0c7c92b1066cbf0cb0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a0c7c92b1066cbf0cb0">{"x":{"visdat":{"c3e7c6e5a7b":["function () ","plotlyVisDat"]},"cur_data":"c3e7c6e5a7b","attrs":{"c3e7c6e5a7b":{"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"matrix(dat$y, sqrt(n), sqrt(n))"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"matrix(dat$y, sqrt(n), sqrt(n))","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666666","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[0.501416864425549,0.435895701528687,0.628313783883863,0.601419906989639,0.527125611387579,0.112301284546732,0.039417800703418,-0.141329188503773,0.144822963182121,0.0991911967806825,-0.0327578176913367,-0.359899360115763,-0.0408256360960392,-0.667323758250688,-0.734767494516802,-0.38023074927526,-0.956544347469717,-0.855788524202129,-1.18955711755161,-0.988557415617179],[0.133778899740329,0.194377309144107,0.50845186448173,0.468950123280319,0.762434611776852,0.616473002882306,-0.166314207146979,0.149223369209974,0.26819300385184,0.0315000667577179,-0.0533484237772506,-0.190393826973107,-0.146638835756673,-0.795102181579004,-0.886669033769316,-1.18143537603294,-1.26815939744817,-1.10661959451609,-1.48579734975524,-1.31857874205859],[-0.202377154430921,-0.192675900911297,0.234612562697065,0.457710478567229,0.0625218103850959,0.440663425848814,0.2351468058189,0.183555515939713,0.0908309117312485,0.087924039844749,0.186087729174762,-0.0250075867171204,-0.217924214818886,-0.457269247535323,-0.649606552605636,-0.969894210537576,-1.09306384540197,-1.14195141749346,-1.11757176732988,-1.05679133535213],[-0.471002907403495,-0.691349967145552,-0.697097530718834,0.112514848821716,0.139482757765891,0.0554543145384681,-0.198868264113203,0.125388220614828,-0.393835761775508,-0.197882386293528,0.56136915354297,-0.112508626381851,-0.401641075501706,-0.517938520880625,-0.823940013294395,-1.12091451932549,-1.02713165667056,-0.826631182888008,-0.841910409674551,-1.54984932323357],[-0.763950706984163,-1.225820774775,-0.545750659141781,-0.0917669725384061,-0.0616656332558033,-0.541487481939438,-0.608113424737945,-0.0121532576720792,-0.379937387284535,-0.275117152289933,-0.156529763438442,-0.117377148425861,-0.367759655341907,-0.536254020195993,-0.379290338951281,-0.796057672955571,-0.822011943188999,-0.887741785568159,-0.657027417097065,-1.01763167370177],[-0.798115217186631,-0.143439712771957,-0.29419664568677,-0.5451227199258,-0.206681144490966,-0.686096958449856,-0.824834853392164,-0.818662210568302,-0.124494975613672,-0.890726570737812,-0.392063170646233,-0.264246486881924,-0.183924981912505,-0.501442892468276,-0.36720010850879,-0.355649030362111,-0.698058826414791,-0.934897260395495,-0.412273103910154,-0.211500149134742],[-0.501144827299452,-0.143551781401895,-0.177619118282617,-0.18688030921036,-0.259239990744858,-0.397856795537658,-0.400937245108777,-0.445657772040838,-0.181109953998177,-0.124526862564246,0.392666709934574,0.138564688125225,-0.10917735001052,-0.318463690490847,-0.368845333097744,-0.411354194748746,-0.605001484861918,-0.69276493365337,-0.59584829844197,-0.0303647377233954],[-0.632208960609581,-0.338493379673158,-0.111209179110824,-0.325964764541674,0.036399917976128,-0.504947202680517,-0.369206887877921,-0.376604729687358,-0.446566844277536,-0.351276226856326,0.0273044333679633,0.0198330786642088,-0.100470137764912,-0.205878299055047,-0.681066904160175,-0.641472475602351,-0.689936117354138,-1.00168355689688,-0.509118072164439,-0.291312059782999],[-0.960295111051469,-0.896999687316198,-0.756044427374535,-0.443501213283358,-0.579799679718357,-0.511577978672976,-0.64788009737273,-0.330775190075048,-0.36317568496346,-0.416107582815025,-0.370302451960135,-0.150888361166695,-0.141344921229453,-0.721816588992522,-0.31568877700652,-0.672449450941603,-1.37604445689561,-1.29722104268379,-0.648862131841714,-0.437896752790101],[-1.32853456827554,-1.03134776389011,-1.0511653246759,-0.800684131473944,-1.10592701377484,-0.632889322113568,-0.39065753274837,0.27527474271868,-0.13200343090194,-0.512618815794071,-0.557044820376544,-0.600283009764221,-0.66972066981869,-0.882781786132015,-0.562397377026324,-0.502232635062436,-1.07526718687346,-1.00949350230526,-1.03923542220946,-0.527572930514143],[-1.02824968846789,-1.21211941860079,-1.19477753816763,-0.777501602713316,-0.817118240190677,-1.16048353544469,-0.789509424911956,-0.521086134680191,-0.500510017753917,-0.484611841944348,-0.445948921762347,-0.773212058114292,-0.586645127199826,-0.56248306774685,-0.771815371188743,-0.888539846641985,-1.01594082678709,-1.17387828107104,-1.26659529611474,-0.493458322378082],[-0.668950991190453,-1.28062702165923,-1.19348268378045,-0.883738953778243,-1.47345431142706,-1.29789615566947,-1.04617601099074,-0.811113656873868,-0.551907299935902,0.0322352967349472,-0.482470337352642,-0.179288748874893,-0.800900309839165,-0.990176300299336,-0.708295340567447,-0.922964831631871,-0.963647317334981,-1.02058078353483,-0.889074830071325,-0.612410760903464],[-1.04875228974718,-1.22163243345006,-1.19228900219844,-1.02546075751929,-1.53593753221428,-1.30630195552372,-1.33443105881042,-0.84527582261496,-0.64739286146674,-0.657562283889777,-0.311207200449213,-1.14560367473706,-1.08844287540445,-0.594597278070922,-1.01264148438755,-1.20180173737559,-1.17095063523868,-0.854325386810569,-0.637094473704528,-0.367097395181139],[-1.16118107448635,-1.43029743729191,-1.39859524981185,-1.58455303629277,-1.72544972140308,-1.06716199955959,-1.04015455732811,-0.904607940201564,-0.578646188309272,-0.433334349585216,-0.445169055347543,-1.07402710472363,-0.913381815905734,-1.2876175194082,-1.32307177467789,-1.57155676517315,-1.62274354401458,-0.66402651127585,-0.574724476510892,-0.84540405045229],[-0.821393372344755,-1.59703105189842,-1.91364637393687,-1.90720496755768,-1.84137158222431,-1.34448750489331,-1.23801719175094,-1.04915078325098,-0.777364839194894,-0.546475125996129,-0.318260039084485,-1.13500663037329,-1.27021907222466,-0.875548762955598,-0.766679350816849,-1.08778581702045,-0.988748806906829,-0.514966304348566,-0.804384069364706,-1.04578239022411],[-1.18679344863807,-1.42296541615496,-1.94588121803795,-2.12258776771557,-1.57160160397042,-1.51095900917988,-1.1533752005967,-1.59113030125909,-0.978637585181172,-0.272756938036946,-0.638213237689997,-0.967868498459082,-1.53116904164358,-1.54664728262367,-1.61140859581918,-1.30330199374122,-0.804270680942264,-0.575515866730707,-0.403735417038006,-0.87900890893699],[-1.27927438632742,-1.46501725061535,-1.69090334919374,-1.71303198822079,-1.32546330292344,-1.44247285690441,-1.30128175493722,-1.63203929610837,-1.06270083810043,-0.259187718365259,-0.762416888851237,-1.42682220170486,-1.38104865747077,-1.48109778833101,-1.56985773473167,-1.513167168223,-1.33109345060025,-0.951184320369449,-0.720484956966187,-0.918482971506078],[-0.921397847503572,-1.23435916825674,-1.12527262049609,-1.07823449844753,-1.17253179039788,-1.24514543874772,-1.39962875113254,-1.38136673664197,-1.66858895017743,-0.759242459417587,-0.807262768908263,-1.41495110231754,-1.32255950495988,-1.46508361344791,-1.24742401134537,-0.93550401159575,-1.32232841506921,-1.20471924153544,-0.987958925887488,-1.18211288041871],[-0.991143633524427,-0.30298895681385,-0.63308722388831,-0.922043368186724,-1.04227012820007,-1.02796989194588,-1.62741424818935,-1.69208435953628,-1.32596122557025,-1.22851009804541,-1.15488751593009,-1.076349483084,-1.54518636449072,-1.1780789438744,-1.13519038758067,-1.03877887696317,-1.07704468547697,-0.839962496660709,-1.06330411232881,-1.2400140693856],[-0.987711248523153,-0.865583576403865,-0.547850109228496,-1.10813251236337,-1.00383211770861,-0.987109562801653,-1.65686895584211,-1.66565673634244,-1.53867289629176,-1.04130115317857,-1.24488592900142,-1.1754612493966,-1.09212221975952,-1.23521862046824,-1.15046177421778,-1.28755337574019,-1.22544016641019,-1.30021296372613,-1.22227821815701,-0.930559695187954]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="gaussian-processes" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Gaussian processes</h3>
<ul>
<li>A <a href="https://en.wikipedia.org/wiki/Gaussian_process">Gaussian process</a> is an infinite-dimensional function (the function is defined for inginitely many locations <span class="math inline">\(\mathbf{s} \in \mathcal{D}\)</span>) with the property that the finite-dimensional vector <span class="math inline">\(\mathbf{y}(\mathbf{s}) = (y(\mathbf{s}_1), \ldots, y(\mathbf{s}_n) )&#39;\)</span> at any finite subset of locations <span class="math inline">\(\mathbf{s}_1, \ldots, \mathbf{s}_n \in \mathcal{D}\)</span> has a multivariate Gaussian distribution. (A good book is available free online here: <a href="http://www.gaussianprocess.org/gpml/">http://www.gaussianprocess.org/gpml/</a>)</li>
</ul>
<div id="mean-and-covariance" class="section level4">
<h4><span class="header-section-number">5.2.1.1</span> Mean and covariance</h4>
<ul>
<li><p>A univariate normal distribution is fully characterized by a mean <span class="math inline">\(\mu\)</span> and a variance <span class="math inline">\(\sigma^2\)</span>.</p></li>
<li><p>A multivariate normal distribution is fully characeterized by a mean vector <span class="math inline">\(\boldsymbol{\mu}\)</span> and a covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span>.</p>
<ul>
<li>The mean is an <span class="math inline">\(n\)</span>-dimensional vector with</li>
</ul>
<p><span class="math display">\[\begin{align*}
  E\left( y(\mathbf{s}) \right) = \boldsymbol{\mu}(\mathbf{s}) = \begin{pmatrix} \mu(\mathbf{s}_1) \\ \vdots \\ \mu(\mathbf{s}_n) \end{pmatrix}
  \end{align*}\]</span></p>
<ul>
<li>The covariance matrix is an <span class="math inline">\(n \times n\)</span> matrix with</li>
</ul>
<p><span class="math display">\[\begin{align*}
  \operatorname{Cov} \left( y(\mathbf{s}) \right) &amp; = \begin{bmatrix}
  \operatorname{Var} \left( y(\mathbf{s}_1) \right) &amp; \operatorname{Cov} \left( y(\mathbf{s}_1), y(\mathbf{s}_2) \right) &amp; \cdots &amp; \operatorname{Cov} \left( y(\mathbf{s}_1), y(\mathbf{s}_n) \right) \\
  \operatorname{Cov} \left( y(\mathbf{s}_2), y(\mathbf{s}_1) \right) &amp; \operatorname{Var} \left( y(\mathbf{s}_2) \right) &amp; \cdots &amp; \operatorname{Cov} \left( y(\mathbf{s}_2), y(\mathbf{s}_n) \right) \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \operatorname{Cov} \left( y(\mathbf{s}_n), y(\mathbf{s}_1) \right) &amp;    \operatorname{Cov} \left( y(\mathbf{s}_n), y(\mathbf{s}_2) \right) &amp; \cdots &amp; \operatorname{Var} \left( y(\mathbf{s}_n) \right)  \\
  \end{bmatrix}
  \end{align*}\]</span></p></li>
<li><p>Recall that the multivariate normal pdf is</p></li>
</ul>
<p><span class="math display">\[\begin{align*}
[\mathbf{y} | \boldsymbol{\mu}, \boldsymbol{\Sigma}] &amp; = (2 \pi)^{-\frac{n}{2}} |\boldsymbol{\Sigma}|^{-\frac{1}{2}} e^{-\frac{1}{2} \left( \mathbf{y} - \boldsymbol{\mu} \right)&#39; \boldsymbol{\Sigma}^{-1} \left( \mathbf{y} - \boldsymbol{\mu} \right)}
\end{align*}\]</span></p>
<ul>
<li>Define the precision matrix <span class="math inline">\(\boldsymbol{\Omega} = \boldsymbol{\Sigma}^{-1}\)</span>. Then, the multivariate normal pdf can be written as</li>
</ul>
<p><span class="math display">\[\begin{align*}
[\mathbf{y} | \boldsymbol{\mu}, \boldsymbol{\Omega}] &amp; = (2 \pi)^{-\frac{n}{2}} |\boldsymbol{\Omega}|^{\frac{1}{2}} e^{-\frac{1}{2} \left( \mathbf{y} - \boldsymbol{\mu} \right)&#39; \boldsymbol{\Omega} \left( \mathbf{y} - \boldsymbol{\mu} \right)}
\end{align*}\]</span></p>
</div>
<div id="mean-and-covariance-functions" class="section level4">
<h4><span class="header-section-number">5.2.1.2</span> Mean and covariance <strong>functions</strong></h4>
<ul>
<li><p>A Gaussian process is fully characterized by a mean function <span class="math inline">\(E\left( y(\mathbf{s}) \right) = \mu(\mathbf{s})\)</span> that maps <span class="math inline">\(\mathcal{R}^d \rightarrow \mathcal{R}^1\)</span> (for a <span class="math inline">\(d\)</span>-dimensional location <span class="math inline">\(\mathbf{s}\)</span> – typically <span class="math inline">\(d=2\)</span>) and a covariance function <span class="math inline">\(\operatorname{Cov} \left( y(\mathbf{s}_i), y(\mathbf{s}_j) \right) = C(\mathbf{s}, \mathbf{s}&#39;)\)</span>.</p>
<ul>
<li><p>This means that once you know the mean function <span class="math inline">\(\mu(\mathbf{s})\)</span> and the covariance function <span class="math inline">\(C(\mathbf{s}, \mathbf{s}&#39;)\)</span> you have full knowledge of the distribution</p></li>
<li><p>Note: this is different than a multivariate normal distribution as this is an infinite-dimensional function – cannot be represented with a vector and/or matrix.</p></li>
</ul></li>
<li><p>Any finite realization of a GP has the pdf</p></li>
</ul>
<p><span class="math display">\[\begin{align*}
[\mathbf{y} | \boldsymbol{\mu}, \boldsymbol{\Sigma}] &amp; = (2 \pi)^{-\frac{n}{2}} |\boldsymbol{\Sigma}|^{-\frac{1}{2}} e^{-\frac{1}{2} \left( \mathbf{y} - \boldsymbol{\mu} \right)&#39; \boldsymbol{\Sigma}^{-1} \left( \mathbf{y} - \boldsymbol{\mu} \right)}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\mu}\)</span> is determined by the function <span class="math inline">\(\mu(\cdot)\)</span> and
<span class="math inline">\(\boldsymbol{\Sigma}\)</span> is determined by the function <span class="math inline">\(C(\cdot, \cdot)\)</span>.</p>
</div>
<div id="the-gaussian-process-mean-function" class="section level4">
<h4><span class="header-section-number">5.2.1.3</span> The Gaussian process mean function</h4>
<ul>
<li><p>There are many possible valid choices for the mean function <span class="math inline">\(\mu(\mathbf{s})\)</span> (almost any possible function is allowed).</p>
<ul>
<li><p>Constant function: <span class="math inline">\(\mu(\mathbf{s}) \equiv \beta_0\)</span></p></li>
<li><p>Spatial covariates: <span class="math inline">\(\mu(\mathbf{s}) \equiv \mathbf{X}(\mathbf{s}) \boldsymbol{\beta} = \beta_0 + \sum_{j=1}^p x_j(\mathbf{s}) \beta_j\)</span></p>
<ul>
<li>Examples: elevation, distance to water, latitude</li>
</ul></li>
<li><p>Linear spatial trends: <span class="math inline">\(\mu(\mathbf{s}_i) \equiv \beta_0 + \beta_1 s_{i1} + \beta_2 s_{i2}\)</span></p></li>
<li><p>Higher-order spatial trends: <span class="math inline">\(\mu(\mathbf{s}_i) \equiv \sum_{j=1}^p f_j(\mathbf{s}) \beta_j\)</span> where <span class="math inline">\(f_j(\mathbf{s})\)</span> is some function of location <span class="math inline">\(\mathbf{s}\)</span> (i.e., B-splines, Fourier bases, wavelets, etc.)</p></li>
</ul></li>
<li><p>How to choose:</p>
<ul>
<li>AIC / BIC / cross-validation</li>
</ul></li>
</ul>
</div>
<div id="example" class="section level4">
<h4><span class="header-section-number">5.2.1.4</span> Example</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2">X &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> n)</a>
<a class="sourceLine" id="cb111-3" data-line-number="3">X_bs &lt;-<span class="st"> </span><span class="kw">bs</span>(X, <span class="dt">df =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb111-4" data-line-number="4">beta &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">ncol</span>(X_bs))</a>
<a class="sourceLine" id="cb111-5" data-line-number="5">y &lt;-<span class="st"> </span>X <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>X_bs <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb111-6" data-line-number="6"></a>
<a class="sourceLine" id="cb111-7" data-line-number="7">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">X =</span> X, <span class="dt">y =</span> y, <span class="dt">mu =</span> X <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>X_bs <span class="op">%*%</span><span class="st"> </span>beta)</a>
<a class="sourceLine" id="cb111-8" data-line-number="8">dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-9" data-line-number="9"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb111-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> mu), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<ul>
<li>A simple mean structure can leave behind a strong residual covariance structure</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">dat<span class="op">$</span>simple &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X))</a>
<a class="sourceLine" id="cb112-2" data-line-number="2">dat<span class="op">$</span>simple_resids &lt;-<span class="st"> </span><span class="kw">resid</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X))</a>
<a class="sourceLine" id="cb112-3" data-line-number="3"></a>
<a class="sourceLine" id="cb112-4" data-line-number="4">dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-5" data-line-number="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb112-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> mu), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> simple), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-9" data-line-number="9"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Simple linear fit&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-10" data-line-number="10"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">30</span>))</a>
<a class="sourceLine" id="cb112-11" data-line-number="11"></a>
<a class="sourceLine" id="cb112-12" data-line-number="12">dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-13" data-line-number="13"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> simple_resids)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb112-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-16" data-line-number="16"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Simple linear fit residuals&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-17" data-line-number="17"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">30</span>))</a></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-55-1.png" width="49%" /><img src="STAT-5413_files/figure-html/unnamed-chunk-55-2.png" width="49%" /></p>
<ul>
<li>A complex mean structure can lead to independent residuals</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1">dat<span class="op">$</span>complex &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span>X_bs))</a>
<a class="sourceLine" id="cb113-2" data-line-number="2">dat<span class="op">$</span>complex_resids &lt;-<span class="st"> </span><span class="kw">resid</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span>X_bs))</a>
<a class="sourceLine" id="cb113-3" data-line-number="3"></a>
<a class="sourceLine" id="cb113-4" data-line-number="4">dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-5" data-line-number="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb113-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> mu), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> complex), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-9" data-line-number="9"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Complex spline fit&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-10" data-line-number="10"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">30</span>))</a>
<a class="sourceLine" id="cb113-11" data-line-number="11"></a>
<a class="sourceLine" id="cb113-12" data-line-number="12">dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-13" data-line-number="13"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> complex_resids)) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb113-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-16" data-line-number="16"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Complex spline fit residuals&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-17" data-line-number="17"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">30</span>))</a></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-56-1.png" width="49%" /><img src="STAT-5413_files/figure-html/unnamed-chunk-56-2.png" width="49%" /></p>
<ul>
<li><p>How do you interpret this residual correlation?</p>
<ul>
<li><p>Missing covariates that have a spatial pattern</p>
<ul>
<li>For example, what if you are modeling temperature in a mountainous region and don’t include elevation as a covariate?</li>
</ul></li>
<li>Advection/diffusion processes
<ul>
<li>Example: the wind blowing, the spread of disease</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="gaussian-process-covariance-functions" class="section level4">
<h4><span class="header-section-number">5.2.1.5</span> Gaussian Process Covariance Functions</h4>
<ul>
<li><p>Unlike the mean functions, only specific covariance functions are valid.</p></li>
<li><p>The covaraince function at a finite subset of <span class="math inline">\(n\)</span> points is called the covariance matrix.</p></li>
<li><p>For a covariance matrix to be from a valid covariance function, the covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span> must be <strong>symmetric</strong> and <strong>positive-definite</strong>.</p>
<ul>
<li><p>A matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is symmetric if <span class="math inline">\(\boldsymbol{\Sigma}&#39; = \boldsymbol{\Sigma}\)</span></p></li>
<li><p>A matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is positive definite iff and only if</p></li>
</ul>
<p><span class="math display">\[\begin{align*}
  \boldsymbol{\Sigma} \mbox{ is positive definite } &amp;  \iff \\
  \mathbf{z}&#39; \boldsymbol{\Sigma} \mathbf{z} \geq 0 \hspace{1em} \forall \mathbf{z} \in \mathcal{R}^n &amp; \iff \\
  \mbox{all eigenvalues of } \boldsymbol{\Sigma} \mbox{ are strictly positive} &amp; \iff \\
  |\boldsymbol{\Sigma}| &gt; 0
  \end{align*}\]</span></p></li>
<li><p>Therefore, the covariance fuction <span class="math inline">\(C(\mathbf{s}_i, \mathbf{s}_j)\)</span> is a valid covariance function if the <span class="math inline">\(n \times n\)</span> covariance matrix at any finite collection of <span class="math inline">\(n\)</span> locations <span class="math inline">\(\mathbf{s}_1, \ldots, \mathbf{s}_n\)</span> has the properties</p>
<ul>
<li><p><strong>symmetry:</strong> <span class="math inline">\(C(\mathbf{s}_i, \mathbf{s}_j) = C(\mathbf{s}_j, \mathbf{s}_i) \hspace{1em} \forall \mathbf{s}_i, \mathbf{s}_j\)</span></p></li>
<li><p><strong>positive definite:</strong> <span class="math inline">\(\sum_{i=1}^n \sum_{j=1}^n z_i z_j C(\mathbf{s}_i, \mathbf{s}_j) &gt; 0 \hspace{1em} \forall n, \mathbf{s}_1, \ldots, \mathbf{s}_n, \mbox{ and } z_1, \ldots, z_n \in \mathcal{R}\)</span></p></li>
<li><p>proving that these properties hold is <strong>hard</strong> – Often rely on spectral methods (showing the eigenvalues of the function are all strictly positive).</p></li>
</ul></li>
</ul>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["STAT-5413.pdf", "STAT-5413.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
