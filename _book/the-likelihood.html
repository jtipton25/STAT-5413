<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 The likelihood | Notes for STAT 5413 - Spatial Statistics</title>
  <meta name="description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="8 The likelihood | Notes for STAT 5413 - Spatial Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 The likelihood | Notes for STAT 5413 - Spatial Statistics" />
  
  <meta name="twitter:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

<meta name="author" content="John Tipton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day-7.html"/>
<link rel="next" href="day-8.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 5413 Spatial Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="day-1.html"><a href="day-1.html"><i class="fa fa-check"></i><b>1</b> Day 1</a><ul>
<li class="chapter" data-level="1.1" data-path="day-1.html"><a href="day-1.html#notation"><i class="fa fa-check"></i><b>1.1</b> Notation</a></li>
<li class="chapter" data-level="1.2" data-path="day-1.html"><a href="day-1.html#probability-distributions"><i class="fa fa-check"></i><b>1.2</b> Probability Distributions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="day-1.html"><a href="day-1.html#example-linear-regression"><i class="fa fa-check"></i><b>1.2.1</b> Example: linear regression</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="day-1.html"><a href="day-1.html#hierarchical-modeling"><i class="fa fa-check"></i><b>1.3</b> Hierarchical modeling</a><ul>
<li class="chapter" data-level="1.3.1" data-path="day-1.html"><a href="day-1.html#bayesian-hierarchical-models-bhms"><i class="fa fa-check"></i><b>1.3.1</b> Bayesian Hierarchical models (BHMs)</a></li>
<li class="chapter" data-level="1.3.2" data-path="day-1.html"><a href="day-1.html#empirical-hierarchical-models-ehms"><i class="fa fa-check"></i><b>1.3.2</b> Empirical Hierarchical models (EHMs)</a></li>
<li class="chapter" data-level="1.3.3" data-path="day-1.html"><a href="day-1.html#data-model"><i class="fa fa-check"></i><b>1.3.3</b> Data Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="day-1.html"><a href="day-1.html#process-model"><i class="fa fa-check"></i><b>1.3.4</b> Process Model</a></li>
<li class="chapter" data-level="1.3.5" data-path="day-1.html"><a href="day-1.html#parameter-prior-model-bmhs-only"><i class="fa fa-check"></i><b>1.3.5</b> Parameter (Prior) Model (BMHs only)</a></li>
<li class="chapter" data-level="1.3.6" data-path="day-1.html"><a href="day-1.html#posterior-distribution"><i class="fa fa-check"></i><b>1.3.6</b> Posterior Distribution</a></li>
<li class="chapter" data-level="1.3.7" data-path="day-1.html"><a href="day-1.html#scientifically-motivated-statistical-modeling"><i class="fa fa-check"></i><b>1.3.7</b> Scientifically Motivated Statistical Modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-2.html"><a href="day-2.html"><i class="fa fa-check"></i><b>2</b> Day 2</a><ul>
<li class="chapter" data-level="2.1" data-path="day-2.html"><a href="day-2.html#spatial-data"><i class="fa fa-check"></i><b>2.1</b> Spatial Data</a></li>
<li class="chapter" data-level="2.2" data-path="day-2.html"><a href="day-2.html#types-of-spatial-data"><i class="fa fa-check"></i><b>2.2</b> Types of spatial data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="day-2.html"><a href="day-2.html#geostatistical-data"><i class="fa fa-check"></i><b>2.2.1</b> Geostatistical data</a></li>
<li class="chapter" data-level="2.2.2" data-path="day-2.html"><a href="day-2.html#areal-data"><i class="fa fa-check"></i><b>2.2.2</b> Areal data</a></li>
<li class="chapter" data-level="2.2.3" data-path="day-2.html"><a href="day-2.html#point-process-data"><i class="fa fa-check"></i><b>2.2.3</b> Point process data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-3.html"><a href="day-3.html"><i class="fa fa-check"></i><b>3</b> Day 3</a><ul>
<li class="chapter" data-level="3.1" data-path="day-3.html"><a href="day-3.html#anouncements"><i class="fa fa-check"></i><b>3.1</b> Anouncements</a></li>
<li class="chapter" data-level="3.2" data-path="day-3.html"><a href="day-3.html#files-for-spatial-data"><i class="fa fa-check"></i><b>3.2</b> Files for spatial data</a></li>
<li class="chapter" data-level="3.3" data-path="day-3.html"><a href="day-3.html#textbook-package"><i class="fa fa-check"></i><b>3.3</b> Textbook package</a></li>
<li class="chapter" data-level="3.4" data-path="day-3.html"><a href="day-3.html#spatial-visualization"><i class="fa fa-check"></i><b>3.4</b> Spatial Visualization</a><ul>
<li class="chapter" data-level="3.4.1" data-path="day-3.html"><a href="day-3.html#spatial-visualization-using-fields"><i class="fa fa-check"></i><b>3.4.1</b> Spatial visualization using <em>fields</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-4.html"><a href="day-4.html"><i class="fa fa-check"></i><b>4</b> Day 4</a><ul>
<li class="chapter" data-level="4.1" data-path="day-4.html"><a href="day-4.html#announcements"><i class="fa fa-check"></i><b>4.1</b> Announcements</a></li>
<li class="chapter" data-level="4.2" data-path="day-4.html"><a href="day-4.html#visualization-continued"><i class="fa fa-check"></i><b>4.2</b> Visualization (continued)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="day-4.html"><a href="day-4.html#spatial-visualization-using-fields-1"><i class="fa fa-check"></i><b>4.2.1</b> Spatial visualization using <em>fields</em></a></li>
<li class="chapter" data-level="4.2.2" data-path="day-4.html"><a href="day-4.html#in-class-activity"><i class="fa fa-check"></i><b>4.2.2</b> In Class Activity:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day-4.html"><a href="day-4.html#interactive-visualization-interactive-with-html-format-only"><i class="fa fa-check"></i><b>4.3</b> Interactive visualization (Interactive with HTML format only)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="day-4.html"><a href="day-4.html#interactive-display-of-data"><i class="fa fa-check"></i><b>4.3.1</b> Interactive display of data</a></li>
<li class="chapter" data-level="4.3.2" data-path="day-4.html"><a href="day-4.html#animations"><i class="fa fa-check"></i><b>4.3.2</b> Animations</a></li>
<li class="chapter" data-level="4.3.3" data-path="day-4.html"><a href="day-4.html#interactive-plotting-using-plotly"><i class="fa fa-check"></i><b>4.3.3</b> Interactive plotting using <em>plotly</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day-5.html"><a href="day-5.html"><i class="fa fa-check"></i><b>5</b> Day 5</a><ul>
<li class="chapter" data-level="5.1" data-path="day-5.html"><a href="day-5.html#announcements-1"><i class="fa fa-check"></i><b>5.1</b> Announcements</a></li>
<li class="chapter" data-level="5.2" data-path="day-5.html"><a href="day-5.html#spatial-means-and-covariances"><i class="fa fa-check"></i><b>5.2</b> Spatial means and covariances</a><ul>
<li class="chapter" data-level="5.2.1" data-path="day-5.html"><a href="day-5.html#gaussian-processes"><i class="fa fa-check"></i><b>5.2.1</b> Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day-6.html"><a href="day-6.html"><i class="fa fa-check"></i><b>6</b> Day 6</a><ul>
<li class="chapter" data-level="6.1" data-path="day-6.html"><a href="day-6.html#announcements-2"><i class="fa fa-check"></i><b>6.1</b> Announcements</a></li>
<li class="chapter" data-level="6.2" data-path="day-6.html"><a href="day-6.html#gaussian-process-assumptions"><i class="fa fa-check"></i><b>6.2</b> Gaussian process assumptions</a></li>
<li class="chapter" data-level="6.3" data-path="day-6.html"><a href="day-6.html#recall-hierachical-modeling"><i class="fa fa-check"></i><b>6.3</b> Recall Hierachical modeling</a><ul>
<li class="chapter" data-level="6.3.1" data-path="day-6.html"><a href="day-6.html#data-model-1"><i class="fa fa-check"></i><b>6.3.1</b> Data Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="day-7.html"><a href="day-7.html"><i class="fa fa-check"></i><b>7</b> Day 7</a><ul>
<li class="chapter" data-level="7.1" data-path="day-7.html"><a href="day-7.html#common-isotropic-correlation-functions"><i class="fa fa-check"></i><b>7.1</b> Common isotropic correlation functions</a></li>
<li class="chapter" data-level="7.2" data-path="day-7.html"><a href="day-7.html#covariograms-and-semivariograms"><i class="fa fa-check"></i><b>7.2</b> Covariograms and semivariograms</a><ul>
<li class="chapter" data-level="7.2.1" data-path="day-7.html"><a href="day-7.html#semivariograms-and-variograms"><i class="fa fa-check"></i><b>7.2.1</b> Semivariograms and variograms</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="day-7.html"><a href="day-7.html#estimation-of-the-spatial-process"><i class="fa fa-check"></i><b>7.3</b> Estimation of the spatial process</a><ul>
<li class="chapter" data-level="7.3.1" data-path="day-7.html"><a href="day-7.html#estimation-of-the-spatial-process-using-variograms"><i class="fa fa-check"></i><b>7.3.1</b> Estimation of the spatial process using variograms</a></li>
<li class="chapter" data-level="7.3.2" data-path="day-7.html"><a href="day-7.html#maximum-likelihood"><i class="fa fa-check"></i><b>7.3.2</b> Maximum Likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-likelihood.html"><a href="the-likelihood.html"><i class="fa fa-check"></i><b>8</b> The likelihood</a><ul>
<li class="chapter" data-level="8.1" data-path="the-likelihood.html"><a href="the-likelihood.html#maximum-likelihood-1"><i class="fa fa-check"></i><b>8.1</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="day-8.html"><a href="day-8.html"><i class="fa fa-check"></i><b>9</b> Day 8</a></li>
<li class="chapter" data-level="10" data-path="day-9.html"><a href="day-9.html"><i class="fa fa-check"></i><b>10</b> Day 9</a></li>
<li class="chapter" data-level="11" data-path="day-10.html"><a href="day-10.html"><i class="fa fa-check"></i><b>11</b> Day 10</a></li>
<li class="chapter" data-level="12" data-path="day-11.html"><a href="day-11.html"><i class="fa fa-check"></i><b>12</b> Day 11</a></li>
<li class="chapter" data-level="13" data-path="day-12.html"><a href="day-12.html"><i class="fa fa-check"></i><b>13</b> Day 12</a></li>
<li class="chapter" data-level="14" data-path="day-13.html"><a href="day-13.html"><i class="fa fa-check"></i><b>14</b> Day 13</a></li>
<li class="chapter" data-level="15" data-path="day-14.html"><a href="day-14.html"><i class="fa fa-check"></i><b>15</b> Day 14</a></li>
<li class="chapter" data-level="16" data-path="day-15.html"><a href="day-15.html"><i class="fa fa-check"></i><b>16</b> Day 15</a></li>
<li class="chapter" data-level="17" data-path="day-16.html"><a href="day-16.html"><i class="fa fa-check"></i><b>17</b> Day 16</a></li>
<li class="chapter" data-level="18" data-path="day-17.html"><a href="day-17.html"><i class="fa fa-check"></i><b>18</b> Day 17</a></li>
<li class="chapter" data-level="19" data-path="day-18.html"><a href="day-18.html"><i class="fa fa-check"></i><b>19</b> Day 18</a></li>
<li class="chapter" data-level="20" data-path="day-19.html"><a href="day-19.html"><i class="fa fa-check"></i><b>20</b> Day 19</a></li>
<li class="chapter" data-level="21" data-path="day-20.html"><a href="day-20.html"><i class="fa fa-check"></i><b>21</b> Day 20</a></li>
<li class="chapter" data-level="22" data-path="day-21.html"><a href="day-21.html"><i class="fa fa-check"></i><b>22</b> Day 21</a></li>
<li class="chapter" data-level="23" data-path="day-22.html"><a href="day-22.html"><i class="fa fa-check"></i><b>23</b> Day 22</a></li>
<li class="chapter" data-level="24" data-path="day-23.html"><a href="day-23.html"><i class="fa fa-check"></i><b>24</b> Day 23</a></li>
<li class="chapter" data-level="25" data-path="day-24.html"><a href="day-24.html"><i class="fa fa-check"></i><b>25</b> Day 24</a></li>
<li class="chapter" data-level="26" data-path="day-25.html"><a href="day-25.html"><i class="fa fa-check"></i><b>26</b> Day 25</a></li>
<li class="chapter" data-level="27" data-path="day-26.html"><a href="day-26.html"><i class="fa fa-check"></i><b>27</b> Day 26</a></li>
<li class="chapter" data-level="28" data-path="day-27.html"><a href="day-27.html"><i class="fa fa-check"></i><b>28</b> Day 27</a></li>
<li class="chapter" data-level="29" data-path="day-28.html"><a href="day-28.html"><i class="fa fa-check"></i><b>29</b> Day 28</a></li>
<li class="chapter" data-level="30" data-path="day-29.html"><a href="day-29.html"><i class="fa fa-check"></i><b>30</b> Day 29</a></li>
<li class="chapter" data-level="31" data-path="day-30.html"><a href="day-30.html"><i class="fa fa-check"></i><b>31</b> Day 30</a></li>
<li class="chapter" data-level="32" data-path="day-31.html"><a href="day-31.html"><i class="fa fa-check"></i><b>32</b> Day 31</a></li>
<li class="chapter" data-level="33" data-path="day-32.html"><a href="day-32.html"><i class="fa fa-check"></i><b>33</b> Day 32</a></li>
<li class="chapter" data-level="34" data-path="day-33.html"><a href="day-33.html"><i class="fa fa-check"></i><b>34</b> Day 33</a></li>
<li class="chapter" data-level="35" data-path="day-34.html"><a href="day-34.html"><i class="fa fa-check"></i><b>35</b> Day 34</a></li>
<li class="chapter" data-level="36" data-path="day-35.html"><a href="day-35.html"><i class="fa fa-check"></i><b>36</b> Day 35</a></li>
<li class="chapter" data-level="37" data-path="day-36.html"><a href="day-36.html"><i class="fa fa-check"></i><b>37</b> Day 36</a></li>
<li class="chapter" data-level="38" data-path="day-37.html"><a href="day-37.html"><i class="fa fa-check"></i><b>38</b> Day 37</a></li>
<li class="chapter" data-level="39" data-path="day-38.html"><a href="day-38.html"><i class="fa fa-check"></i><b>39</b> Day 38</a></li>
<li class="chapter" data-level="40" data-path="day-39.html"><a href="day-39.html"><i class="fa fa-check"></i><b>40</b> Day 39</a></li>
<li class="chapter" data-level="41" data-path="day-40.html"><a href="day-40.html"><i class="fa fa-check"></i><b>41</b> Day 40</a></li>
<li class="chapter" data-level="42" data-path="day-41.html"><a href="day-41.html"><i class="fa fa-check"></i><b>42</b> Day 41</a></li>
<li class="chapter" data-level="43" data-path="day-42.html"><a href="day-42.html"><i class="fa fa-check"></i><b>43</b> Day 42</a></li>
<li class="chapter" data-level="44" data-path="day-43.html"><a href="day-43.html"><i class="fa fa-check"></i><b>44</b> Day 43</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for STAT 5413 - Spatial Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-likelihood" class="section level1">
<h1><span class="header-section-number">8</span> The likelihood</h1>
<p>To understand the benefits of Bayesian analysis, it is useful to recall the likelihood framework. Assume that our model can be simplified so that the data are <span class="math inline">\(\mathbf{y} = (y_1, \ldots, y_N)&#39;\)</span> and the parameters are <span class="math inline">\(\boldsymbol{\theta}\)</span>. Before observation, the data <span class="math inline">\(\mathbf{y}\)</span> are considered a random variable. After observation, the data <span class="math inline">\(\mathbf{y}\)</span> are considered fixed and known. The likelihood is a formal representation of how likely the data <span class="math inline">\(\mathbf{y}\)</span> are to arise given a probability distribution with parameters <span class="math inline">\(\boldsymbol{\theta}\)</span>. The likelihood function <span class="math inline">\(L(\boldsymbol{\theta} | \mathbf{y})\)</span> is defined as
<span class="math display">\[\begin{align*}
L(\boldsymbol{\theta} | \mathbf{y}) &amp; = [\mathbf{y} | \boldsymbol{\theta}],
\end{align*}\]</span>
where the function says that the likelihood of the parameter conditional on the data is is the conditional probability density of the data conditional on the parameters.</p>
<p>If one assumes the observations are conditionally independent given the parameters <span class="math inline">\(\boldsymbol{\theta}\)</span>, the likelihood can be written as
<span class="math display">\[\begin{align*}
L(\boldsymbol{\theta} | \mathbf{y}) &amp; = \prod_{i=1}^N [y_i | \boldsymbol{\theta}],
\end{align*}\]</span>
Note the distinction between the use of the term likelihood function for the left side of the equation with the use of the term likelihood in Bayesian statistics to describe the right side of the above equation. A distinction between the likelihood function and the probability distribution function is in what is considered the random variable. In the likelihood function, the data <span class="math inline">\(\mathbf{y}\)</span> is assumed known and the parameters <span class="math inline">\(\boldsymbol{\theta}\)</span> are random. For the probability distribution function, the data <span class="math inline">\(\mathbf{y}\)</span> are considered are random variable conditional on a fixed, known parameter <span class="math inline">\(\boldsymbol{\theta}\)</span>. To illustrate this difference, consider a univariate gamma probability distribution with shape parameter <span class="math inline">\(\alpha = 10\)</span> and scale parameter <span class="math inline">\(\theta=10\)</span>. If we observe a single <span class="math inline">\(y=2\)</span>, the following figure shows the density function and likelihood function, with <span class="math inline">\(\alpha\)</span> assumed fixed and known.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(latex2exp)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">alpha &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">theta &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">density_function &lt;-<span class="st"> </span><span class="cf">function</span> (x) {</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  <span class="kw">return</span>(<span class="kw">dgamma</span>(x, alpha, theta))</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">likelihood_function &lt;-<span class="st"> </span><span class="cf">function</span> (x) {</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">  <span class="kw">return</span>(<span class="kw">dgamma</span>(y, alpha, x))</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">## plot density function</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="kw">curve</span>(<span class="kw">density_function</span>(x), <span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">main =</span> <span class="st">&quot;Density function&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;y&quot;</span>, </a>
<a class="sourceLine" id="cb15-14" data-line-number="14">      <span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">lbrack$y|$</span><span class="ch">\\</span><span class="st">theta$ $</span><span class="ch">\\</span><span class="st">rbrack$&quot;</span>))</a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="kw">text</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="kw">paste0</span>(</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">  <span class="st">&quot;Area = &quot;</span>, <span class="kw">round</span>(<span class="kw">integrate</span>(density_function, <span class="dv">0</span>, <span class="ot">Inf</span>)[<span class="dv">1</span>]<span class="op">$</span>value, <span class="dt">digits=</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="kw">points</span>(<span class="dv">2</span>, <span class="kw">density_function</span>(<span class="dv">2</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="kw">curve</span>(<span class="kw">likelihood_function</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;Likelihood function&quot;</span>,</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">      <span class="dt">xlab=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">theta$&quot;</span>), <span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;$L(y|</span><span class="ch">\\</span><span class="st">theta)$&quot;</span>))</a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="kw">text</span>(<span class="dv">5</span>, <span class="fl">0.3</span>, <span class="kw">paste0</span>(</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">  <span class="st">&quot;Area = &quot;</span>, <span class="kw">round</span>(<span class="kw">integrate</span>(likelihood_function, <span class="dv">0</span>, <span class="ot">Inf</span>)[<span class="dv">1</span>]<span class="op">$</span>value, <span class="dt">digits=</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="kw">points</span>(<span class="dv">10</span>, <span class="kw">likelihood_function</span>(<span class="dv">10</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Notice that the area under the curve of the density function is 1 (because it is a formal probability distribution) whereas the area under the likelihood function is not 1 (the area is 10). Hence, when performing optimization using a likelihood function, one is <strong>not</strong> optimizing a probability function. Because the likelihood is not a probability, we appeal to frequentist (rather than probabilistic) interpretations when interpreting likelihood analyses. For example, the interpretation of a 95% confidence interval is “under repeated sampling from the population, 95% of the confidence intervals will contain the true value,” in comparison to the probabilistic interpretation “the probability the interval contains the true value is 95%.” The density function and the likelihood function share a common point at <span class="math inline">\(y=2\)</span> and <span class="math inline">\(\theta=10\)</span>, (shown in red in the figure above) given the fixed value of <span class="math inline">\(\alpha\)</span>. This suggests that the likelihood and density functions are the same only when the parameter is assumed to be a fixed, known value.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">## check that the density function and the likelihood function share the same point</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">all.equal</span>(<span class="kw">density_function</span>(<span class="dv">2</span>), <span class="kw">likelihood_function</span>(<span class="dv">10</span>))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Philosophically, there is a subtle difference between the density function and the likelihood function that is important to understand. In the likelihood function, we allow the parameter <span class="math inline">\(\theta\)</span> to vary; however, we do not assume that <span class="math inline">\(\theta\)</span> is a random variable. To be a random variable there must be a formal probability distribution for <span class="math inline">\(\theta\)</span>. We showed earlier that the likelihood function does not integrate to 1 so we don’t view <span class="math inline">\(\theta\)</span> as a random variable and the likelihood function is not a probability distribution for <span class="math inline">\(\theta\)</span>.</p>
<div id="maximum-likelihood-1" class="section level2">
<h2><span class="header-section-number">8.1</span> Maximum likelihood</h2>
<p>Maximum likelihood estimation has the goal of finding the set of parameters <span class="math inline">\(\hat{\boldsymbol{\theta}}\)</span> that were most likely to give rise to the data. Because the likelihood does not integrate to 1, the likelihood by itself is not infomative; only comparisons among likelihoods are meaningful because the likelihood can be shifted up or down in the y-axis by an arbitraty constant <span class="math inline">\(c\)</span>. To cancel out the unkown constant <span class="math inline">\(c\)</span>, we take ratios of the likelihoods at values <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>, giving rise to the likelihood ratio
<span class="math display">\[\begin{align*}
\frac{L(\theta_1 | y)}{L(\theta_2 | y)} &amp; = \frac{[y|\theta_1]}{[y|\theta_2]}.
\end{align*}\]</span>
The likelihood ratio expresses the strength of evidence in favor of <span class="math inline">\(\theta_1\)</span> relative to <span class="math inline">\(\theta_2\)</span>. In general, we use the log likelihood ratio to express the strength of evidence where positive values of the log likelihood ratio give evidence in support of <span class="math inline">\(\theta_1\)</span> and negative values of the log likelihood ratio give evidence in support of <span class="math inline">\(\theta_2\)</span>, conditional on the data.</p>
<p>The maximum likelihood estimate is the value <span class="math inline">\(\hat{\theta}\)</span> such that
<span class="math display">\[\begin{align*}
\log \left( \frac{L(\hat{\theta} | y)}{L(\theta^\star | y)} \right) &amp; \geq 0
\end{align*}\]</span>
for all values of <span class="math inline">\(\theta^\star\)</span>. The following figure demonstrates this idea visually.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">curve</span>(<span class="kw">likelihood_function</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;Likelihood function&quot;</span>,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">      <span class="dt">xlab=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">theta$&quot;</span>), <span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;$L(y|</span><span class="ch">\\</span><span class="st">theta)$&quot;</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.02</span>, <span class="fl">0.66</span>))</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw">segments</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="kw">likelihood_function</span>(<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw">arrows</span>(<span class="dv">3</span>, <span class="kw">likelihood_function</span>(<span class="dv">3</span>), <span class="dv">0</span>, <span class="kw">likelihood_function</span>(<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw">text</span>(<span class="fl">3.1</span>, <span class="fl">-0.02</span>, <span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">theta_1$ = 3&quot;</span>))</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="kw">text</span>(<span class="fl">1.5</span>, <span class="kw">likelihood_function</span>(<span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="fl">.02</span>, <span class="kw">TeX</span>(<span class="st">&quot;$L(y|</span><span class="ch">\\</span><span class="st">theta_1)$&quot;</span>))</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="kw">segments</span>(<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="kw">likelihood_function</span>(<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="kw">arrows</span>(<span class="dv">6</span>, <span class="kw">likelihood_function</span>(<span class="dv">6</span>), <span class="dv">0</span>, <span class="kw">likelihood_function</span>(<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="kw">text</span>(<span class="fl">6.1</span>, <span class="fl">-0.02</span>, <span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">theta_2$ = 6&quot;</span>))</a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="kw">text</span>(<span class="fl">1.5</span>, <span class="kw">likelihood_function</span>(<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.02</span>, <span class="kw">TeX</span>(<span class="st">&quot;$L(y|</span><span class="ch">\\</span><span class="st">theta_2)$&quot;</span>))</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="kw">segments</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="kw">likelihood_function</span>(<span class="dv">5</span>), <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="kw">text</span>(<span class="fl">5.3</span>, <span class="fl">0.66</span>, <span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">hat{</span><span class="ch">\\</span><span class="st">theta}_{MLE}$ = 5&quot;</span>))</a></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>For example, if <span class="math inline">\(\theta_1 = 3\)</span> and <span class="math inline">\(\theta_2 = 6\)</span>, the log likelihood ratio is -0.9314718 which suggests evidence is in favor of <span class="math inline">\(\theta_2\)</span> relative to <span class="math inline">\(\theta_1\)</span>. In comparison, the log likelihood ratio of the MLE <span class="math inline">\(\hat{\theta}_{MLE}\)</span> is 0.1767844 which gives evidence in favor of <span class="math inline">\(\hat{\theta}_{MLE}\)</span>.</p>
<ul>
<li>Instead of using the variogram in <a href="day-7.html#eq:variogram">(7.1)</a>, we can use maximum liklihood.</li>
<li><p>More formal and principled estimation framework.</p></li>
<li><p>Allows for parameter uncertainty quantification.</p></li>
<li><p>Goal: estimate the parameters <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\boldsymbol{\theta} = (\tau^2, \sigma^2, \nu, \phi)&#39;\)</span>.</p></li>
<li><p>The log-likelihood to maximize is</p></li>
</ul>
<p><span class="math display">\[\begin{align*}
\log[\boldsymbol{\beta}, \boldsymbol{\theta} | \mathbf{y}] &amp; = - \frac{1}{2} \log|\boldsymbol{\Sigma}(\boldsymbol{\theta})| - \frac{1}{2} \left( \mathbf{y} - \mathbf{X} \boldsymbol{\beta} \right)&#39; \boldsymbol{\Sigma}(\boldsymbol{\theta})^{-1} \left( \mathbf{y} - \mathbf{X} \boldsymbol{\beta} \right)
\end{align*}\]</span></p>
<ul>
<li>This is a multivariate optimization and difficult to optimize directly. Instead, notice the estimate <span class="math inline">\(\hat{\boldsymbol{\beta}}(\boldsymbol{\theta}) = (\mathbf{X}&#39; \hat{\boldsymbol{\Sigma}}^{-1} \mathbf{X})^{-1} \mathbf{X}&#39; \hat{\boldsymbol{\Sigma}}^{-1} \mathbf{y}\)</span> is a known function of <span class="math inline">\(\boldsymbol{\theta}\)</span> so we can profile it out of the equation. Thus, we can instead optimize the profile likelihood</li>
</ul>
<p><span class="math display">\[\begin{align*}
\log[\boldsymbol{\theta} | \mathbf{y}]_{prof} &amp; = - \frac{1}{2} \log|\boldsymbol{\Sigma}(\boldsymbol{\theta})| - \frac{1}{2} \left( \mathbf{y} - \mathbf{X} \boldsymbol{\beta}(\boldsymbol{\theta}) \right)&#39; \boldsymbol{\Sigma}(\boldsymbol{\theta})^{-1} \left( \mathbf{y} - \mathbf{X} \boldsymbol{\beta}(\boldsymbol{\theta}) \right)
\end{align*}\]</span></p>
<ul>
<li>Computational complexity – both the log-likelihood and the</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day-7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["STAT-5413.pdf", "STAT-5413.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
