[
["day-6.html", "6 Day 6 6.1 Announcements 6.2 Recall Hierachical modeling", " 6 Day 6 6.1 Announcements Assigned reading: Model Selection for Geostatistical Models library(tidyverse) library(fields) library(mvnfast) 6.2 Recall Hierachical modeling 6.2.1 Data Model \\[\\begin{align*} y(\\mathbf{s}) &amp; = z(\\mathbf{s}) + \\varepsilon(\\mathbf{s}) \\\\ \\tag{6.1} \\varepsilon(\\mathbf{s}) \\stackrel{iid}{\\sim} N(0, \\sigma^2) \\end{align*}\\] \\(y(\\mathbf{s})\\) is the observation at site \\(\\mathbf{s}\\) \\(z(\\mathbf{s})\\) is the process of interest at site \\(\\mathbf{s}\\) \\(\\varepsilon(\\mathbf{s}) \\sim N(0, \\sigma^2)\\) is the measurement error Commonly called the “nugget” Geostatistics came from mining Microsite-variability \\(z(\\mathbf{s})\\) is the process of interest at site \\(\\mathbf{s}\\) Process Model (using Gaussian process) \\[\\begin{align*} z(\\mathbf{s}) &amp; = \\mu(\\mathbf{s}) + \\eta(\\mathbf{s}) \\tag{6.2} \\end{align*}\\] \\(\\mu(\\mathbf{s})\\) is the GP mean function \\(\\boldsymbol{\\eta} = (\\eta(\\mathbf{s}_1), \\ldots, \\eta(\\mathbf{s}_n))&#39; \\sim N(\\mathbf{0}, \\boldsymbol{\\Sigma})\\) \\(Cov(\\eta(\\mathbf{s}_i), \\eta(\\mathbf{s}_j)) = \\tau^2 C(d_{ij})\\) \\(C(d_ij)\\) is a correlation function \\(\\tau^2\\) is often called the “partial sill” parameter set.seed(101) n &lt;- 40 s &lt;- runif(n) ## mean function mu &lt;- s ## covariance function -- this is positive definite Sigma &lt;- 2 * exp( - rdist(s) / 2) ## generate the spatially (1-d) correlated process ## rmvn returns a matrix -- use c() to coerce to a vector eta &lt;- c(rmvn(1, rep(0, n), Sigma)) z &lt;- mu + eta epsilon &lt;- rnorm(n, 0, 0.25) y &lt;- z + epsilon dat &lt;- data.frame( s = s, y = y, z = z, mu = mu, eta = eta, epsilon = epsilon ) dat %&gt;% ggplot(aes(x = s, y = y)) + geom_point() + geom_segment(aes(xend = s, yend = z), alpha = 0.5) + geom_line(aes(x = s, y = z), color = &quot;blue&quot;) + geom_line(aes(x = s, y = mu), color = &quot;red&quot;) + geom_line(aes(x = s, y = eta), color = &quot;purple&quot;) + theme_bw() A quick check if Sigma meets the conditions of a symmetric positive-definite matrix ## check is Sigma is symmetric all.equal(Sigma, t(Sigma)) ## [1] TRUE ## check is Sigma is posivitive definite Sigma_eigen &lt;- eigen(Sigma) ## check that all eigenvalues are positive Sigma_eigen$values ## [1] 68.614998226 6.469640157 1.846887044 1.013225060 0.526987113 ## [6] 0.350879290 0.221671629 0.170657210 0.116756563 0.076631073 ## [11] 0.067533590 0.058658782 0.053014720 0.043488483 0.037433411 ## [16] 0.036668397 0.032544320 0.030261646 0.027404563 0.023218999 ## [21] 0.021154516 0.021154380 0.017782847 0.016717572 0.014563450 ## [26] 0.013423514 0.010922956 0.009497946 0.008886870 0.008231217 ## [31] 0.007208472 0.005444425 0.005026785 0.004599434 0.004534839 ## [36] 0.004238142 0.003219602 0.002366398 0.001348648 0.001117710 all(Sigma_eigen$values &gt; 0) ## [1] TRUE Variance decomposition Combining the equations (6.1) and (6.2) \\[\\begin{align*} y(\\mathbf{s}) &amp; = \\mu(\\mathbf{s}) + \\eta(\\mathbf{s}) + \\varepsilon(\\mathbf{s}) \\end{align*}\\] we can have \\[\\begin{align*} Var \\left( y(\\mathbf{s}) \\right) &amp; = Var \\left( \\mu(\\mathbf{s}) + \\eta(\\mathbf{s}) + \\varepsilon(\\mathbf{s}) \\right) \\\\ &amp; = Var \\left( \\mu(\\mathbf{s}) \\right) + Var \\left( \\eta(\\mathbf{s}) \\right) + Var \\left( \\varepsilon(\\mathbf{s}) \\right) + \\\\ &amp; \\hspace{2em} 2 Cov \\left( \\mu(\\mathbf{s}), \\varepsilon(\\mathbf{s}) \\right) + 2 Cov \\left( \\mu(\\mathbf{s}), \\eta(\\mathbf{s}) \\right) + 2 Cov \\left( \\eta(\\mathbf{s}), \\varepsilon(\\mathbf{s}) \\right) \\\\ &amp; = 0 + Var \\left( \\eta(\\mathbf{s}) \\right) + Var \\left( \\varepsilon(\\mathbf{s}) \\right) + 0 + 0 + 0 \\\\ &amp; = \\tau^2 + \\sigma^2 \\end{align*}\\] the total variance is the “sill” \\(\\tau^2 + \\sigma^2\\) For future classes (basis representations) Visual exploration of Gaussian Processes "]
]
