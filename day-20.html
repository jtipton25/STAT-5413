<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter20 Day 20 | Notes for STAT 5413 - Spatial Statistics</title>
  <meta name="description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  <meta name="generator" content="bookdown 0.24.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter20 Day 20 | Notes for STAT 5413 - Spatial Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter20 Day 20 | Notes for STAT 5413 - Spatial Statistics" />
  
  <meta name="twitter:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

<meta name="author" content="John Tipton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day-19.html"/>
<link rel="next" href="day-21.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.19/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 5413 Spatial Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="day-1.html"><a href="day-1.html"><i class="fa fa-check"></i><b>1</b> Day 1</a><ul>
<li class="chapter" data-level="1.1" data-path="day-1.html"><a href="day-1.html#notation"><i class="fa fa-check"></i><b>1.1</b> Notation</a></li>
<li class="chapter" data-level="1.2" data-path="day-1.html"><a href="day-1.html#probability-distributions"><i class="fa fa-check"></i><b>1.2</b> Probability Distributions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="day-1.html"><a href="day-1.html#example-linear-regression"><i class="fa fa-check"></i><b>1.2.1</b> Example: linear regression</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="day-1.html"><a href="day-1.html#hierarchical-modeling"><i class="fa fa-check"></i><b>1.3</b> Hierarchical modeling</a><ul>
<li class="chapter" data-level="1.3.1" data-path="day-1.html"><a href="day-1.html#bayesian-hierarchical-models-bhms"><i class="fa fa-check"></i><b>1.3.1</b> Bayesian Hierarchical models (BHMs)</a></li>
<li class="chapter" data-level="1.3.2" data-path="day-1.html"><a href="day-1.html#empirical-hierarchical-models-ehms"><i class="fa fa-check"></i><b>1.3.2</b> Empirical Hierarchical models (EHMs)</a></li>
<li class="chapter" data-level="1.3.3" data-path="day-1.html"><a href="day-1.html#data-model"><i class="fa fa-check"></i><b>1.3.3</b> Data Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="day-1.html"><a href="day-1.html#process-model"><i class="fa fa-check"></i><b>1.3.4</b> Process Model</a></li>
<li class="chapter" data-level="1.3.5" data-path="day-1.html"><a href="day-1.html#parameter-prior-model-bmhs-only"><i class="fa fa-check"></i><b>1.3.5</b> Parameter (Prior) Model (BMHs only)</a></li>
<li class="chapter" data-level="1.3.6" data-path="day-1.html"><a href="day-1.html#posterior-distribution"><i class="fa fa-check"></i><b>1.3.6</b> Posterior Distribution</a></li>
<li class="chapter" data-level="1.3.7" data-path="day-1.html"><a href="day-1.html#scientifically-motivated-statistical-modeling"><i class="fa fa-check"></i><b>1.3.7</b> Scientifically Motivated Statistical Modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-2.html"><a href="day-2.html"><i class="fa fa-check"></i><b>2</b> Day 2</a><ul>
<li class="chapter" data-level="2.1" data-path="day-2.html"><a href="day-2.html#spatial-data"><i class="fa fa-check"></i><b>2.1</b> Spatial Data</a></li>
<li class="chapter" data-level="2.2" data-path="day-2.html"><a href="day-2.html#types-of-spatial-data"><i class="fa fa-check"></i><b>2.2</b> Types of spatial data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="day-2.html"><a href="day-2.html#geostatistical-data"><i class="fa fa-check"></i><b>2.2.1</b> Geostatistical data</a></li>
<li class="chapter" data-level="2.2.2" data-path="day-2.html"><a href="day-2.html#areal-data"><i class="fa fa-check"></i><b>2.2.2</b> Areal data</a></li>
<li class="chapter" data-level="2.2.3" data-path="day-2.html"><a href="day-2.html#point-process-data"><i class="fa fa-check"></i><b>2.2.3</b> Point process data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-3.html"><a href="day-3.html"><i class="fa fa-check"></i><b>3</b> Day 3</a><ul>
<li class="chapter" data-level="3.1" data-path="day-3.html"><a href="day-3.html#anouncements"><i class="fa fa-check"></i><b>3.1</b> Anouncements</a></li>
<li class="chapter" data-level="3.2" data-path="day-3.html"><a href="day-3.html#files-for-spatial-data"><i class="fa fa-check"></i><b>3.2</b> Files for spatial data</a></li>
<li class="chapter" data-level="3.3" data-path="day-3.html"><a href="day-3.html#textbook-package"><i class="fa fa-check"></i><b>3.3</b> Textbook package</a></li>
<li class="chapter" data-level="3.4" data-path="day-3.html"><a href="day-3.html#spatial-visualization"><i class="fa fa-check"></i><b>3.4</b> Spatial Visualization</a><ul>
<li class="chapter" data-level="3.4.1" data-path="day-3.html"><a href="day-3.html#spatial-visualization-using-fields"><i class="fa fa-check"></i><b>3.4.1</b> Spatial visualization using <em>fields</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-4.html"><a href="day-4.html"><i class="fa fa-check"></i><b>4</b> Day 4</a><ul>
<li class="chapter" data-level="4.1" data-path="day-4.html"><a href="day-4.html#announcements"><i class="fa fa-check"></i><b>4.1</b> Announcements</a></li>
<li class="chapter" data-level="4.2" data-path="day-4.html"><a href="day-4.html#visualization-continued"><i class="fa fa-check"></i><b>4.2</b> Visualization (continued)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="day-4.html"><a href="day-4.html#spatial-visualization-using-fields-1"><i class="fa fa-check"></i><b>4.2.1</b> Spatial visualization using <em>fields</em></a></li>
<li class="chapter" data-level="4.2.2" data-path="day-4.html"><a href="day-4.html#in-class-activity"><i class="fa fa-check"></i><b>4.2.2</b> In Class Activity:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day-4.html"><a href="day-4.html#interactive-visualization-interactive-with-html-format-only"><i class="fa fa-check"></i><b>4.3</b> Interactive visualization (Interactive with HTML format only)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="day-4.html"><a href="day-4.html#interactive-display-of-data"><i class="fa fa-check"></i><b>4.3.1</b> Interactive display of data</a></li>
<li class="chapter" data-level="4.3.2" data-path="day-4.html"><a href="day-4.html#animations"><i class="fa fa-check"></i><b>4.3.2</b> Animations</a></li>
<li class="chapter" data-level="4.3.3" data-path="day-4.html"><a href="day-4.html#interactive-plotting-using-plotly"><i class="fa fa-check"></i><b>4.3.3</b> Interactive plotting using <em>plotly</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day-5.html"><a href="day-5.html"><i class="fa fa-check"></i><b>5</b> Day 5</a><ul>
<li class="chapter" data-level="5.1" data-path="day-5.html"><a href="day-5.html#announcements-1"><i class="fa fa-check"></i><b>5.1</b> Announcements</a></li>
<li class="chapter" data-level="5.2" data-path="day-5.html"><a href="day-5.html#spatial-means-and-covariances"><i class="fa fa-check"></i><b>5.2</b> Spatial means and covariances</a><ul>
<li class="chapter" data-level="5.2.1" data-path="day-5.html"><a href="day-5.html#gaussian-processes"><i class="fa fa-check"></i><b>5.2.1</b> Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day-6.html"><a href="day-6.html"><i class="fa fa-check"></i><b>6</b> Day 6</a><ul>
<li class="chapter" data-level="6.1" data-path="day-6.html"><a href="day-6.html#announcements-2"><i class="fa fa-check"></i><b>6.1</b> Announcements</a></li>
<li class="chapter" data-level="6.2" data-path="day-6.html"><a href="day-6.html#gaussian-process-assumptions"><i class="fa fa-check"></i><b>6.2</b> Gaussian process assumptions</a></li>
<li class="chapter" data-level="6.3" data-path="day-6.html"><a href="day-6.html#recall-hierachical-modeling"><i class="fa fa-check"></i><b>6.3</b> Recall Hierachical modeling</a><ul>
<li class="chapter" data-level="6.3.1" data-path="day-6.html"><a href="day-6.html#data-model-1"><i class="fa fa-check"></i><b>6.3.1</b> Data Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="day-7.html"><a href="day-7.html"><i class="fa fa-check"></i><b>7</b> Day 7</a><ul>
<li class="chapter" data-level="7.1" data-path="day-7.html"><a href="day-7.html#common-isotropic-correlation-functions"><i class="fa fa-check"></i><b>7.1</b> Common isotropic correlation functions</a></li>
<li class="chapter" data-level="7.2" data-path="day-7.html"><a href="day-7.html#covariograms-and-semivariograms"><i class="fa fa-check"></i><b>7.2</b> Covariograms and semivariograms</a><ul>
<li class="chapter" data-level="7.2.1" data-path="day-7.html"><a href="day-7.html#semivariograms-and-variograms"><i class="fa fa-check"></i><b>7.2.1</b> Semivariograms and variograms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="day-8.html"><a href="day-8.html"><i class="fa fa-check"></i><b>8</b> Day 8</a><ul>
<li class="chapter" data-level="8.1" data-path="day-8.html"><a href="day-8.html#announcements-3"><i class="fa fa-check"></i><b>8.1</b> Announcements</a></li>
<li class="chapter" data-level="8.2" data-path="day-8.html"><a href="day-8.html#estimation-of-the-spatial-process"><i class="fa fa-check"></i><b>8.2</b> Estimation of the spatial process</a><ul>
<li class="chapter" data-level="8.2.1" data-path="day-8.html"><a href="day-8.html#estimation-of-the-spatial-process-using-variograms"><i class="fa fa-check"></i><b>8.2.1</b> Estimation of the spatial process using variograms</a></li>
<li class="chapter" data-level="8.2.2" data-path="day-8.html"><a href="day-8.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.2.2</b> Maximum Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="day-8.html"><a href="day-8.html#maximum-likelihood-1"><i class="fa fa-check"></i><b>8.3</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="day-9.html"><a href="day-9.html"><i class="fa fa-check"></i><b>9</b> Day 9</a><ul>
<li class="chapter" data-level="9.1" data-path="day-9.html"><a href="day-9.html#announcements-4"><i class="fa fa-check"></i><b>9.1</b> Announcements</a></li>
<li class="chapter" data-level="9.2" data-path="day-9.html"><a href="day-9.html#asymptotic-properties-of-the-mle"><i class="fa fa-check"></i><b>9.2</b> Asymptotic properties of the MLE</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="day-10.html"><a href="day-10.html"><i class="fa fa-check"></i><b>10</b> Day 10</a><ul>
<li class="chapter" data-level="10.1" data-path="day-10.html"><a href="day-10.html#announcements-5"><i class="fa fa-check"></i><b>10.1</b> Announcements</a></li>
<li class="chapter" data-level="10.2" data-path="day-10.html"><a href="day-10.html#asymptotic-properties-of-the-mle-1"><i class="fa fa-check"></i><b>10.2</b> Asymptotic properties of the MLE</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="day-11.html"><a href="day-11.html"><i class="fa fa-check"></i><b>11</b> Day 11</a><ul>
<li class="chapter" data-level="11.1" data-path="day-11.html"><a href="day-11.html#announcements-6"><i class="fa fa-check"></i><b>11.1</b> Announcements</a></li>
<li class="chapter" data-level="11.2" data-path="day-11.html"><a href="day-11.html#example-spatial-analysis"><i class="fa fa-check"></i><b>11.2</b> Example spatial analysis</a></li>
<li class="chapter" data-level="11.3" data-path="day-11.html"><a href="day-11.html#spatial-model-fitting"><i class="fa fa-check"></i><b>11.3</b> Spatial model fitting</a><ul>
<li class="chapter" data-level="11.3.1" data-path="day-11.html"><a href="day-11.html#fit-the-maximum-likelihood-estimate-using-the-geor-package"><i class="fa fa-check"></i><b>11.3.1</b> Fit the maximum likelihood estimate using the <em>geoR</em> package</a></li>
<li class="chapter" data-level="11.3.2" data-path="day-11.html"><a href="day-11.html#fitting-a-spatial-model-using-the-nlme-package"><i class="fa fa-check"></i><b>11.3.2</b> Fitting a spatial model using the <em>nlme</em> package</a></li>
<li class="chapter" data-level="11.3.3" data-path="day-11.html"><a href="day-11.html#model-fitting-with-autokrige-function"><i class="fa fa-check"></i><b>11.3.3</b> model fitting with <em>autokrige</em> function</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="day-11.html"><a href="day-11.html#kriging"><i class="fa fa-check"></i><b>11.4</b> Kriging</a><ul>
<li class="chapter" data-level="11.4.1" data-path="day-11.html"><a href="day-11.html#kriging-equations-with-mean-mu-0"><i class="fa fa-check"></i><b>11.4.1</b> Kriging Equations with mean <span class="math inline">\(\mu = 0\)</span></a></li>
<li class="chapter" data-level="11.4.2" data-path="day-11.html"><a href="day-11.html#kriging-equations-with-unknown-mean"><i class="fa fa-check"></i><b>11.4.2</b> Kriging Equations with unknown mean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="day-12.html"><a href="day-12.html"><i class="fa fa-check"></i><b>12</b> Day 12</a><ul>
<li class="chapter" data-level="12.1" data-path="day-12.html"><a href="day-12.html#announcements-7"><i class="fa fa-check"></i><b>12.1</b> Announcements</a></li>
<li class="chapter" data-level="12.2" data-path="day-12.html"><a href="day-12.html#introduction-to-mcmc"><i class="fa fa-check"></i><b>12.2</b> Introduction to MCMC</a></li>
<li class="chapter" data-level="12.3" data-path="day-12.html"><a href="day-12.html#example-simple-linear-regression"><i class="fa fa-check"></i><b>12.3</b> Example: Simple linear regression</a></li>
<li class="chapter" data-level="12.4" data-path="day-12.html"><a href="day-12.html#the-posterior-distribution"><i class="fa fa-check"></i><b>12.4</b> The posterior distribution</a><ul>
<li class="chapter" data-level="12.4.1" data-path="day-12.html"><a href="day-12.html#full-conditional-distribution-of-mu"><i class="fa fa-check"></i><b>12.4.1</b> Full conditional distribution of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="12.4.2" data-path="day-12.html"><a href="day-12.html#full-conditional-distribution-for-beta"><i class="fa fa-check"></i><b>12.4.2</b> Full conditional distribution for <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="12.4.3" data-path="day-12.html"><a href="day-12.html#full-conditional-distribution-for-sigma2"><i class="fa fa-check"></i><b>12.4.3</b> Full conditional distribution for <span class="math inline">\(\sigma^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="day-12.html"><a href="day-12.html#fitting-the-model"><i class="fa fa-check"></i><b>12.5</b> Fitting the model</a><ul>
<li class="chapter" data-level="12.5.1" data-path="day-12.html"><a href="day-12.html#general-recommendations-for-writing-mcmc-software"><i class="fa fa-check"></i><b>12.5.1</b> General recommendations for writing MCMC software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="day-13.html"><a href="day-13.html"><i class="fa fa-check"></i><b>13</b> Day 13</a><ul>
<li class="chapter" data-level="13.1" data-path="day-13.html"><a href="day-13.html#announcements-8"><i class="fa fa-check"></i><b>13.1</b> Announcements</a></li>
<li class="chapter" data-level="13.2" data-path="day-13.html"><a href="day-13.html#the-metropolis-algorithm"><i class="fa fa-check"></i><b>13.2</b> The Metropolis Algorithm</a></li>
<li class="chapter" data-level="13.3" data-path="day-13.html"><a href="day-13.html#the-proposal-distribution"><i class="fa fa-check"></i><b>13.3</b> The proposal distribution</a></li>
<li class="chapter" data-level="13.4" data-path="day-13.html"><a href="day-13.html#the-metropolis-update"><i class="fa fa-check"></i><b>13.4</b> The Metropolis update</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="day-14.html"><a href="day-14.html"><i class="fa fa-check"></i><b>14</b> Day 14</a><ul>
<li class="chapter" data-level="14.1" data-path="day-14.html"><a href="day-14.html#announcements-9"><i class="fa fa-check"></i><b>14.1</b> Announcements</a></li>
<li class="chapter" data-level="14.2" data-path="day-14.html"><a href="day-14.html#the-metropolis-hastings-algorithm"><i class="fa fa-check"></i><b>14.2</b> The Metropolis-Hastings Algorithm</a></li>
<li class="chapter" data-level="14.3" data-path="day-14.html"><a href="day-14.html#the-metropolis-hastings-algorithm-1"><i class="fa fa-check"></i><b>14.3</b> The Metropolis-Hastings algorithm</a></li>
<li class="chapter" data-level="14.4" data-path="day-14.html"><a href="day-14.html#example-1"><i class="fa fa-check"></i><b>14.4</b> Example</a></li>
<li class="chapter" data-level="14.5" data-path="day-14.html"><a href="day-14.html#posterior"><i class="fa fa-check"></i><b>14.5</b> Posterior</a></li>
<li class="chapter" data-level="14.6" data-path="day-14.html"><a href="day-14.html#conditional-posterior-for-phi"><i class="fa fa-check"></i><b>14.6</b> Conditional posterior for <span class="math inline">\(\phi\)</span></a></li>
<li class="chapter" data-level="14.7" data-path="day-14.html"><a href="day-14.html#conditional-posterior-for-sigma2"><i class="fa fa-check"></i><b>14.7</b> Conditional posterior for <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="14.8" data-path="day-14.html"><a href="day-14.html#mcmc-using-a-symmetric-proposal-metropolis"><i class="fa fa-check"></i><b>14.8</b> MCMC using a symmetric proposal (Metropolis)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="day-15.html"><a href="day-15.html"><i class="fa fa-check"></i><b>15</b> Day 15</a><ul>
<li class="chapter" data-level="15.1" data-path="day-15.html"><a href="day-15.html#announcements-10"><i class="fa fa-check"></i><b>15.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="day-16.html"><a href="day-16.html"><i class="fa fa-check"></i><b>16</b> Day 16</a><ul>
<li class="chapter" data-level="16.1" data-path="day-16.html"><a href="day-16.html#announcements-11"><i class="fa fa-check"></i><b>16.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="day-17.html"><a href="day-17.html"><i class="fa fa-check"></i><b>17</b> Day 17</a><ul>
<li class="chapter" data-level="17.1" data-path="day-17.html"><a href="day-17.html#announcements-12"><i class="fa fa-check"></i><b>17.1</b> Announcements</a></li>
<li class="chapter" data-level="17.2" data-path="day-17.html"><a href="day-17.html#gaussian-process-representations"><i class="fa fa-check"></i><b>17.2</b> Gaussian process representations</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="day-18.html"><a href="day-18.html"><i class="fa fa-check"></i><b>18</b> Day 18</a><ul>
<li class="chapter" data-level="18.1" data-path="day-18.html"><a href="day-18.html#announcements-13"><i class="fa fa-check"></i><b>18.1</b> Announcements</a></li>
<li class="chapter" data-level="18.2" data-path="day-18.html"><a href="day-18.html#gaussian-process-representations-continued"><i class="fa fa-check"></i><b>18.2</b> Gaussian process representations continued</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="day-19.html"><a href="day-19.html"><i class="fa fa-check"></i><b>19</b> Day 19</a><ul>
<li class="chapter" data-level="19.1" data-path="day-19.html"><a href="day-19.html#announcements-14"><i class="fa fa-check"></i><b>19.1</b> Announcements</a></li>
<li class="chapter" data-level="19.2" data-path="day-19.html"><a href="day-19.html#stochastic-integration"><i class="fa fa-check"></i><b>19.2</b> Stochastic Integration</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="day-20.html"><a href="day-20.html"><i class="fa fa-check"></i><b>20</b> Day 20</a><ul>
<li class="chapter" data-level="20.1" data-path="day-20.html"><a href="day-20.html#announcements-15"><i class="fa fa-check"></i><b>20.1</b> Announcements</a></li>
<li class="chapter" data-level="20.2" data-path="day-20.html"><a href="day-20.html#spbayes-example"><i class="fa fa-check"></i><b>20.2</b> spBayes example</a></li>
<li class="chapter" data-level="20.3" data-path="day-20.html"><a href="day-20.html#global-vs.-local-basis-function"><i class="fa fa-check"></i><b>20.3</b> Global vs. Local Basis function</a><ul>
<li class="chapter" data-level="20.3.1" data-path="day-20.html"><a href="day-20.html#an-example-global-basis-fourier-basis"><i class="fa fa-check"></i><b>20.3.1</b> An example global basis: Fourier Basis</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="day-20.html"><a href="day-20.html#example-local-basis"><i class="fa fa-check"></i><b>20.4</b> example local basis</a></li>
<li class="chapter" data-level="20.5" data-path="day-20.html"><a href="day-20.html#fitting-spatial-models-many-ways"><i class="fa fa-check"></i><b>20.5</b> Fitting spatial models many ways</a></li>
<li class="chapter" data-level="20.6" data-path="day-20.html"><a href="day-20.html#empirical-orthogonal-functions"><i class="fa fa-check"></i><b>20.6</b> Empirical Orthogonal Functions</a></li>
<li class="chapter" data-level="20.7" data-path="day-20.html"><a href="day-20.html#spatial-modeling-with-mgcv-package"><i class="fa fa-check"></i><b>20.7</b> Spatial modeling with <code>mgcv</code> package</a></li>
<li class="chapter" data-level="20.8" data-path="day-20.html"><a href="day-20.html#spatial-modeling-with-kernels"><i class="fa fa-check"></i><b>20.8</b> Spatial modeling with Kernels</a><ul>
<li class="chapter" data-level="20.8.1" data-path="day-20.html"><a href="day-20.html#kernel-regression-with-a-ridge-penalty"><i class="fa fa-check"></i><b>20.8.1</b> Kernel regression with a ridge penalty</a></li>
<li class="chapter" data-level="20.8.2" data-path="day-20.html"><a href="day-20.html#kernel-regression-with-a-lasso-penalty"><i class="fa fa-check"></i><b>20.8.2</b> Kernel regression with a lasso penalty</a></li>
<li class="chapter" data-level="20.8.3" data-path="day-20.html"><a href="day-20.html#truncated-kernels---local-support"><i class="fa fa-check"></i><b>20.8.3</b> Truncated Kernels - local support</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="day-20.html"><a href="day-20.html#sparse-vs.-dense-matrix-computation"><i class="fa fa-check"></i><b>20.9</b> Sparse vs. Dense matrix computation</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="day-21.html"><a href="day-21.html"><i class="fa fa-check"></i><b>21</b> Day 21</a><ul>
<li class="chapter" data-level="21.1" data-path="day-21.html"><a href="day-21.html#announcements-16"><i class="fa fa-check"></i><b>21.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="day-22.html"><a href="day-22.html"><i class="fa fa-check"></i><b>22</b> Day 22</a><ul>
<li class="chapter" data-level="22.1" data-path="day-22.html"><a href="day-22.html#announcements-17"><i class="fa fa-check"></i><b>22.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="day-23.html"><a href="day-23.html"><i class="fa fa-check"></i><b>23</b> Day 23</a><ul>
<li class="chapter" data-level="23.1" data-path="day-23.html"><a href="day-23.html#announcements-18"><i class="fa fa-check"></i><b>23.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html"><i class="fa fa-check"></i><b>24</b> Day 24 – Scaling GPs for large data</a><ul>
<li class="chapter" data-level="24.1" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#announcements-19"><i class="fa fa-check"></i><b>24.1</b> Announcements</a></li>
<li class="chapter" data-level="24.2" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#local-analysis"><i class="fa fa-check"></i><b>24.2</b> Local analysis</a></li>
<li class="chapter" data-level="24.3" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#low-rank-approimxations"><i class="fa fa-check"></i><b>24.3</b> Low rank approimxations</a></li>
<li class="chapter" data-level="24.4" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#spectral-basis-functions"><i class="fa fa-check"></i><b>24.4</b> Spectral basis functions</a></li>
<li class="chapter" data-level="24.5" data-path="day-24-scaling-gps-for-large-data.html"><a href="day-24-scaling-gps-for-large-data.html#kernel-convolutions"><i class="fa fa-check"></i><b>24.5</b> Kernel convolutions</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html"><i class="fa fa-check"></i><b>25</b> Day 25 – Scaling GPs for large data</a><ul>
<li class="chapter" data-level="25.1" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#announcements-20"><i class="fa fa-check"></i><b>25.1</b> Announcements</a></li>
<li class="chapter" data-level="25.2" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#gaussian-predictive-process-spbayes-package"><i class="fa fa-check"></i><b>25.2</b> <span>Gaussian Predictive Process</span> (spBayes package)</a></li>
<li class="chapter" data-level="25.3" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#sparse-matrix-routines"><i class="fa fa-check"></i><b>25.3</b> Sparse matrix routines</a></li>
<li class="chapter" data-level="25.4" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#the-stochastic-pde-approach"><i class="fa fa-check"></i><b>25.4</b> The stochastic PDE approach</a></li>
<li class="chapter" data-level="25.5" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#approximate-likelihood-methods"><i class="fa fa-check"></i><b>25.5</b> Approximate likelihood methods</a></li>
<li class="chapter" data-level="25.6" data-path="day-25-scaling-gps-for-large-data.html"><a href="day-25-scaling-gps-for-large-data.html#vecchia-approximations"><i class="fa fa-check"></i><b>25.6</b> Vecchia Approximations</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="day-26.html"><a href="day-26.html"><i class="fa fa-check"></i><b>26</b> Day 26</a><ul>
<li class="chapter" data-level="26.1" data-path="day-26.html"><a href="day-26.html#announcements-21"><i class="fa fa-check"></i><b>26.1</b> Announcements</a></li>
<li class="chapter" data-level="26.2" data-path="day-26.html"><a href="day-26.html#multivariate-data"><i class="fa fa-check"></i><b>26.2</b> Multivariate Data</a></li>
<li class="chapter" data-level="26.3" data-path="day-26.html"><a href="day-26.html#classical-multivariate-geostatistics"><i class="fa fa-check"></i><b>26.3</b> Classical Multivariate Geostatistics</a><ul>
<li class="chapter" data-level="26.3.1" data-path="day-26.html"><a href="day-26.html#cross-variograms-and-cross-covariance-functions"><i class="fa fa-check"></i><b>26.3.1</b> cross-variograms and cross-covariance functions</a></li>
<li class="chapter" data-level="26.3.2" data-path="day-26.html"><a href="day-26.html#cokriging"><i class="fa fa-check"></i><b>26.3.2</b> Cokriging</a></li>
<li class="chapter" data-level="26.3.3" data-path="day-26.html"><a href="day-26.html#linear-model-of-coregionalization"><i class="fa fa-check"></i><b>26.3.3</b> Linear Model of Coregionalization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="day-27.html"><a href="day-27.html"><i class="fa fa-check"></i><b>27</b> Day 27</a><ul>
<li class="chapter" data-level="27.1" data-path="day-27.html"><a href="day-27.html#announcements-22"><i class="fa fa-check"></i><b>27.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="day-28.html"><a href="day-28.html"><i class="fa fa-check"></i><b>28</b> Day 28</a><ul>
<li class="chapter" data-level="28.1" data-path="day-28.html"><a href="day-28.html#announcements-23"><i class="fa fa-check"></i><b>28.1</b> Announcements</a></li>
<li class="chapter" data-level="28.2" data-path="day-28.html"><a href="day-28.html#intro-to-stan"><i class="fa fa-check"></i><b>28.2</b> Intro to stan</a><ul>
<li class="chapter" data-level="28.2.1" data-path="day-28.html"><a href="day-28.html#example-linear-regression-1"><i class="fa fa-check"></i><b>28.2.1</b> Example: Linear regression</a></li>
<li class="chapter" data-level="28.2.2" data-path="day-28.html"><a href="day-28.html#example-spatial-model-in-stan"><i class="fa fa-check"></i><b>28.2.2</b> Example: Spatial model in stan</a></li>
<li class="chapter" data-level="28.2.3" data-path="day-28.html"><a href="day-28.html#example-predictive-process-model-in-stan"><i class="fa fa-check"></i><b>28.2.3</b> Example: Predictive process model in stan</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="day-28.html"><a href="day-28.html#stan-hints-and-tips"><i class="fa fa-check"></i><b>28.3</b> stan Hints and tips</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="day-29.html"><a href="day-29.html"><i class="fa fa-check"></i><b>29</b> Day 29</a><ul>
<li class="chapter" data-level="29.1" data-path="day-29.html"><a href="day-29.html#announcements-24"><i class="fa fa-check"></i><b>29.1</b> Announcements</a></li>
<li class="chapter" data-level="29.2" data-path="day-29.html"><a href="day-29.html#areal-data-1"><i class="fa fa-check"></i><b>29.2</b> Areal Data</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="day-30.html"><a href="day-30.html"><i class="fa fa-check"></i><b>30</b> Day 30</a><ul>
<li class="chapter" data-level="30.1" data-path="day-30.html"><a href="day-30.html#announcements-25"><i class="fa fa-check"></i><b>30.1</b> Announcements</a></li>
<li class="chapter" data-level="30.2" data-path="day-30.html"><a href="day-30.html#gaussian-markov-random-fields-gmrfs"><i class="fa fa-check"></i><b>30.2</b> Gaussian Markov random fields (GMRFs)</a><ul>
<li class="chapter" data-level="30.2.1" data-path="day-30.html"><a href="day-30.html#example-2"><i class="fa fa-check"></i><b>30.2.1</b> Example:</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="day-30.html"><a href="day-30.html#conditional-autoregressive-models-car-models"><i class="fa fa-check"></i><b>30.3</b> Conditional Autoregressive models (CAR models)</a><ul>
<li class="chapter" data-level="30.3.1" data-path="day-30.html"><a href="day-30.html#models-built-based-on-conditional-distributions-y_i-mathbfy_-i"><i class="fa fa-check"></i><b>30.3.1</b> Models built based on conditional distributions: <span class="math inline">\(y_i | \mathbf{y}_{-i}\)</span></a></li>
<li class="chapter" data-level="30.3.2" data-path="day-30.html"><a href="day-30.html#simultaneous-autoregressive-sar-model"><i class="fa fa-check"></i><b>30.3.2</b> Simultaneous autoregressive (SAR) model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="day-31.html"><a href="day-31.html"><i class="fa fa-check"></i><b>31</b> Day 31</a><ul>
<li class="chapter" data-level="31.1" data-path="day-31.html"><a href="day-31.html#announcements-26"><i class="fa fa-check"></i><b>31.1</b> Announcements</a></li>
<li class="chapter" data-level="31.2" data-path="day-31.html"><a href="day-31.html#change-of-spatial-support"><i class="fa fa-check"></i><b>31.2</b> Change of Spatial Support</a></li>
<li class="chapter" data-level="31.3" data-path="day-31.html"><a href="day-31.html#modeling-change-of-support-continuous-discrete-modeling"><i class="fa fa-check"></i><b>31.3</b> Modeling change of support – continuous-discrete modeling</a></li>
<li class="chapter" data-level="31.4" data-path="day-31.html"><a href="day-31.html#modeling-change-of-support-discrete-discrete-modeling"><i class="fa fa-check"></i><b>31.4</b> Modeling change of support – discrete-discrete modeling</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="day-32.html"><a href="day-32.html"><i class="fa fa-check"></i><b>32</b> Day 32</a><ul>
<li class="chapter" data-level="32.1" data-path="day-32.html"><a href="day-32.html#announcements-27"><i class="fa fa-check"></i><b>32.1</b> Announcements</a></li>
<li class="chapter" data-level="32.2" data-path="day-32.html"><a href="day-32.html#generalized-non-gaussian-spatial-models"><i class="fa fa-check"></i><b>32.2</b> Generalized (non-Gaussian) spatial models</a></li>
<li class="chapter" data-level="32.3" data-path="day-32.html"><a href="day-32.html#generalized-linear-models-glms-for-non-spatial-data"><i class="fa fa-check"></i><b>32.3</b> Generalized linear models (GLMs) for non-spatial data</a><ul>
<li class="chapter" data-level="32.3.1" data-path="day-32.html"><a href="day-32.html#example-binary-logistic-regression"><i class="fa fa-check"></i><b>32.3.1</b> Example: binary (logistic) regression</a></li>
<li class="chapter" data-level="32.3.2" data-path="day-32.html"><a href="day-32.html#example-poisson-count-regression"><i class="fa fa-check"></i><b>32.3.2</b> Example: Poisson (count) regression</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="day-32.html"><a href="day-32.html#generalized-linear-models-glms-for-spatial-data"><i class="fa fa-check"></i><b>32.4</b> Generalized linear models (GLMs) for spatial data</a><ul>
<li class="chapter" data-level="32.4.1" data-path="day-32.html"><a href="day-32.html#example-spatial-binary-logistic-regression"><i class="fa fa-check"></i><b>32.4.1</b> Example: spatial binary (logistic) regression</a></li>
<li class="chapter" data-level="32.4.2" data-path="day-32.html"><a href="day-32.html#example-spatial-poisson-count-regression"><i class="fa fa-check"></i><b>32.4.2</b> Example: spatial Poisson (count) regression</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="day-32.html"><a href="day-32.html#how-to-improve-computation-in-spatial-glms"><i class="fa fa-check"></i><b>32.5</b> How to improve computation in spatial GLMs</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="day-33.html"><a href="day-33.html"><i class="fa fa-check"></i><b>33</b> Day 33</a><ul>
<li class="chapter" data-level="33.1" data-path="day-33.html"><a href="day-33.html#announcements-28"><i class="fa fa-check"></i><b>33.1</b> Announcements</a></li>
<li class="chapter" data-level="33.2" data-path="day-33.html"><a href="day-33.html#spatio-temporal-data"><i class="fa fa-check"></i><b>33.2</b> Spatio-temporal data</a><ul>
<li class="chapter" data-level="33.2.1" data-path="day-33.html"><a href="day-33.html#review-discrete-time"><i class="fa fa-check"></i><b>33.2.1</b> Review: discrete time</a></li>
<li class="chapter" data-level="33.2.2" data-path="day-33.html"><a href="day-33.html#continuous-space-discrete-time-the-spatial-ar1-model"><i class="fa fa-check"></i><b>33.2.2</b> Continuous space, discrete time – the spatial AR(1) model</a></li>
</ul></li>
<li class="chapter" data-level="33.3" data-path="day-33.html"><a href="day-33.html#seperable-models-are-computationally-more-efficient"><i class="fa fa-check"></i><b>33.3</b> seperable models are computationally more efficient:</a><ul>
<li class="chapter" data-level="33.3.1" data-path="day-33.html"><a href="day-33.html#more-flexible-models"><i class="fa fa-check"></i><b>33.3.1</b> More flexible models</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="day-33.html"><a href="day-33.html#continuous-space-continuous-time-models"><i class="fa fa-check"></i><b>33.4</b> Continuous space, continuous time models</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="day-34.html"><a href="day-34.html"><i class="fa fa-check"></i><b>34</b> Day 34</a><ul>
<li class="chapter" data-level="34.1" data-path="day-34.html"><a href="day-34.html#announcements-29"><i class="fa fa-check"></i><b>34.1</b> Announcements</a></li>
<li class="chapter" data-level="34.2" data-path="day-34.html"><a href="day-34.html#point-process-data-1"><i class="fa fa-check"></i><b>34.2</b> Point Process Data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for STAT 5413 - Spatial Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-20" class="section level1">
<h1><span class="header-section-number">Chapter20</span> Day 20</h1>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="day-20.html#cb279-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb279-2"><a href="day-20.html#cb279-2"></a><span class="kw">library</span>(STRbook)</span>
<span id="cb279-3"><a href="day-20.html#cb279-3"></a><span class="kw">library</span>(fields)</span>
<span id="cb279-4"><a href="day-20.html#cb279-4"></a><span class="kw">library</span>(mvnfast)</span>
<span id="cb279-5"><a href="day-20.html#cb279-5"></a><span class="kw">library</span>(fda)</span>
<span id="cb279-6"><a href="day-20.html#cb279-6"></a><span class="kw">library</span>(spBayes)</span>
<span id="cb279-7"><a href="day-20.html#cb279-7"></a><span class="kw">library</span>(coda)</span>
<span id="cb279-8"><a href="day-20.html#cb279-8"></a><span class="kw">library</span>(mgcv)</span>
<span id="cb279-9"><a href="day-20.html#cb279-9"></a><span class="kw">library</span>(glmnet)</span>
<span id="cb279-10"><a href="day-20.html#cb279-10"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Registering fonts with R</code></pre>
<pre><code>## Scanning ttf files in /Library/Fonts/, /System/Library/Fonts ...</code></pre>
<pre><code>## Extracting .afm files from .ttf files...</code></pre>
<pre><code>## /System/Library/Fonts/Supplemental/Arial Unicode.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Unicode.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Unicode&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Apple Braille Outline 6 Dot.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Apple Braille Outline 6 Dot.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Braille Outline 6
## Dot&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Apple Braille Outline 8 Dot.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Apple Braille Outline 8 Dot.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Braille Outline 8
## Dot&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Apple Braille Pinpoint 6 Dot.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Apple Braille Pinpoint 6 Dot.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Braille Pinpoint 6
## Dot&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Apple Braille Pinpoint 8 Dot.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Apple Braille Pinpoint 8 Dot.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Braille Pinpoint 8
## Dot&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Apple Braille.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Apple Braille.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Braille&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Apple Symbols.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Apple Symbols.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Symbols&#39; 2&gt;&amp;1&#39; had
## status 1</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Keyboard.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Keyboard.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//
## RtmpMIF4wT/fonts/Keyboard&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/NewYork.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/NewYork.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//
## RtmpMIF4wT/fonts/NewYork&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/NewYorkItalic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/NewYorkItalic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NewYorkItalic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFCompact.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/SFCompact.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//
## RtmpMIF4wT/fonts/SFCompact&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFCompactItalic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/SFCompactItalic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/SFCompactItalic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFCompactRounded.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/SFCompactRounded.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/SFCompactRounded&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFNS.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/SFNS.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//
## RtmpMIF4wT/fonts/SFNS&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFNSItalic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/SFNSItalic.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/
## T//RtmpMIF4wT/fonts/SFNSItalic&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFNSMono.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/SFNSMono.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//
## RtmpMIF4wT/fonts/SFNSMono&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFNSMonoItalic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/SFNSMonoItalic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/SFNSMonoItalic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/SFNSRounded.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/SFNSRounded.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/
## T//RtmpMIF4wT/fonts/SFNSRounded&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Academy Engraved LET Fonts.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Academy Engraved LET Fonts.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Academy Engraved LET
## Fonts&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Andale Mono.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Andale Mono.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Andale Mono&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Apple Chancery.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Apple Chancery.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Apple Chancery&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/AppleGothic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/AppleGothic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/AppleGothic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/AppleMyungjo.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/AppleMyungjo.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/AppleMyungjo&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Black.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Black.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Black&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Bold Italic&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a
## -GfAe &#39;/System/Library/Fonts/Supplemental/Arial Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Bold&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Italic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Narrow Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Arial Narrow Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Narrow Bold Italic&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Narrow Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Narrow Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Narrow Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Narrow Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Narrow Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Narrow Italic&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Narrow.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Narrow.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Narrow&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Rounded Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Rounded Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Rounded Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial Unicode.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Arial Unicode.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial Unicode&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Arial.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Arial.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Arial&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Ayuthaya.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Ayuthaya.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Ayuthaya&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/BigCaslon.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/BigCaslon.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/BigCaslon&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Bodoni 72 Smallcaps Book.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Bodoni 72 Smallcaps Book.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Bodoni 72 Smallcaps Book&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Bodoni Ornaments.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Bodoni Ornaments.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Bodoni Ornaments&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Bradley Hand Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Bradley Hand Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Bradley Hand Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Brush Script.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Brush Script.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Brush Script&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Chalkduster.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Chalkduster.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Chalkduster&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Comic Sans MS Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Comic Sans MS Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Comic Sans MS Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Comic Sans MS.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Comic Sans MS.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Comic Sans MS&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Courier New Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Courier New Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Courier New Bold Italic&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Courier New Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Courier New Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Courier New Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Courier New Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Courier New Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Courier New Italic&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Courier New.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Courier New.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Courier New&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/DIN Alternate Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/DIN Alternate Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/DIN Alternate Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/DIN Condensed Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/DIN Condensed Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/DIN Condensed Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Diwan Thuluth.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Diwan Thuluth.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Diwan Thuluth&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Farisi.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Farisi.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Farisi&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Georgia Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Georgia Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Georgia Bold Italic&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Georgia Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Georgia Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Georgia Bold&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Georgia Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Georgia Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Georgia Italic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Georgia.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Georgia.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Georgia&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Gurmukhi.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Gurmukhi.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Gurmukhi&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Herculanum.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a
## -GfAe &#39;/System/Library/Fonts/Supplemental/Herculanum.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Herculanum&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Hoefler Text Ornaments.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Hoefler Text Ornaments.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Hoefler Text Ornaments&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Impact.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Impact.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Impact&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Khmer Sangam MN.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Khmer Sangam MN.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Khmer Sangam MN&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Kokonor.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Kokonor.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Kokonor&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Krungthep.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Krungthep.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Krungthep&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Lao Sangam MN.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Lao Sangam MN.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Lao Sangam MN&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Luminari.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Luminari.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Luminari&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Microsoft Sans Serif.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Microsoft Sans Serif.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Microsoft Sans Serif&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Mishafi Gold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Mishafi Gold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Mishafi Gold&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Mishafi.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Mishafi.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Mishafi&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NISC18030.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/NISC18030.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NISC18030&#39; 2&gt;&amp;1&#39; had
## status 1</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansAdlam-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansAdlam-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansAdlam-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansAvestan-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansAvestan-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansAvestan-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBamum-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansBamum-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBamum-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBassaVah-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansBassaVah-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBassaVah-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBatak-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansBatak-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBatak-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBhaiksuki-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansBhaiksuki-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBhaiksuki-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBrahmi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansBrahmi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBrahmi-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBuginese-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansBuginese-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBuginese-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansBuhid-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansBuhid-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansBuhid-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansCarian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansCarian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansCarian-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansCaucasianAlbanian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansCaucasianAlbanian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansCaucasianAlbanian-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansChakma-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansChakma-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansChakma-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansCham-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansCham-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansCham-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansCoptic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansCoptic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansCoptic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansCuneiform-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansCuneiform-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansCuneiform-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansCypriot-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansCypriot-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansCypriot-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansDuployan-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansDuployan-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansDuployan-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansEgyptianHieroglyphs-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansEgyptianHieroglyphs-Regular.ttf&#39; &#39;/
## var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/
## NotoSansEgyptianHieroglyphs-Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansElbasan-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansElbasan-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansElbasan-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansGlagolitic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansGlagolitic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansGlagolitic-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansGothic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansGothic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansGothic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansHanifiRohingya-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansHanifiRohingya-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansHanifiRohingya-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansHanunoo-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansHanunoo-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansHanunoo-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansHatran-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansHatran-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansHatran-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansImperialAramaic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansImperialAramaic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansImperialAramaic-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansInscriptionalPahlavi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansInscriptionalPahlavi-Regular.ttf&#39; &#39;/
## var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/
## NotoSansInscriptionalPahlavi-Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansInscriptionalParthian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansInscriptionalParthian-Regular.ttf&#39; &#39;/
## var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/
## NotoSansInscriptionalParthian-Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansKaithi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansKaithi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansKaithi-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansKayahLi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansKayahLi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansKayahLi-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansKharoshthi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansKharoshthi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansKharoshthi-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansKhojki-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansKhojki-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansKhojki-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansKhudawadi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansKhudawadi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansKhudawadi-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLepcha-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansLepcha-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLepcha-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLimbu-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansLimbu-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLimbu-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLinearA-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansLinearA-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLinearA-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLinearB-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansLinearB-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLinearB-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLisu-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansLisu-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLisu-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLycian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansLycian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLycian-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansLydian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansLydian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansLydian-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMahajani-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMahajani-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMahajani-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMandaic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMandaic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMandaic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansManichaean-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansManichaean-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansManichaean-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMarchen-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMarchen-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMarchen-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMeeteiMayek-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMeeteiMayek-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMeeteiMayek-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMendeKikakui-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMendeKikakui-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMendeKikakui-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMeroitic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMeroitic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMeroitic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMiao-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansMiao-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMiao-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansModi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansModi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansModi-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMongolian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMongolian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMongolian-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMro-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansMro-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMro-Regular&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansMultani-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansMultani-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansMultani-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansNabataean-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansNabataean-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansNabataean-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansNewa-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansNewa-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansNewa-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansNewTaiLue-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansNewTaiLue-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansNewTaiLue-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansNKo-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansNKo-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansNKo-Regular&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOgham-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansOgham-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOgham-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOlChiki-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOlChiki-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOlChiki-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldHungarian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldHungarian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldHungarian-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldItalic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldItalic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldItalic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldNorthArabian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldNorthArabian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldNorthArabian-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldPermic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldPermic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldPermic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldPersian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldPersian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldPersian-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldSouthArabian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldSouthArabian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldSouthArabian-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOldTurkic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOldTurkic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOldTurkic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOsage-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansOsage-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOsage-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansOsmanya-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansOsmanya-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansOsmanya-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansPahawhHmong-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansPahawhHmong-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansPahawhHmong-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansPalmyrene-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansPalmyrene-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansPalmyrene-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansPauCinHau-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansPauCinHau-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansPauCinHau-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansPhagsPa-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansPhagsPa-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansPhagsPa-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansPhoenician-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansPhoenician-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansPhoenician-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansPsalterPahlavi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansPsalterPahlavi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansPsalterPahlavi-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansRejang-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansRejang-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansRejang-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansRunic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansRunic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansRunic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSamaritan-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSamaritan-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSamaritan-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSaurashtra-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSaurashtra-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSaurashtra-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSharada-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSharada-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSharada-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansShavian-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansShavian-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansShavian-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSiddham-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSiddham-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSiddham-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSoraSompeng-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSoraSompeng-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSoraSompeng-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSundanese-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSundanese-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSundanese-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSylotiNagri-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSylotiNagri-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSylotiNagri-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansSyriac-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansSyriac-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansSyriac-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTagalog-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansTagalog-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTagalog-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTagbanwa-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansTagbanwa-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTagbanwa-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTaiLe-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansTaiLe-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTaiLe-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTaiTham-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansTaiTham-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTaiTham-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTaiViet-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansTaiViet-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTaiViet-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTakri-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansTakri-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTakri-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansThaana-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansThaana-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansThaana-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTifinagh-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansTifinagh-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTifinagh-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansTirhuta-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansTirhuta-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansTirhuta-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansUgaritic-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansUgaritic-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansUgaritic-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansVai-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansVai-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansVai-Regular&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansWancho-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansWancho-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansWancho-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansWarangCiti-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSansWarangCiti-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansWarangCiti-
## Regular&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSansYi-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSansYi-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSansYi-Regular&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSerifAhom-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/NotoSerifAhom-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSerifAhom-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/NotoSerifBalinese-Regular.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/NotoSerifBalinese-Regular.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/NotoSerifBalinese-Regular&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/PartyLET-plain.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/PartyLET-plain.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/PartyLET-plain&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/PlantagenetCherokee.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/PlantagenetCherokee.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/PlantagenetCherokee&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Sathu.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Sathu.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Sathu&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Silom.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Silom.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Silom&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Skia.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Skia.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Skia&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Tahoma Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Tahoma Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Tahoma Bold&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Tahoma.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Tahoma.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Tahoma&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Times New Roman Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Times New Roman Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Times New Roman Bold
## Italic&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Times New Roman Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Times New Roman Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Times New Roman Bold&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Times New Roman Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Times New Roman Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Times New Roman Italic&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Times New Roman.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Times New Roman.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Times New Roman&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Trattatello.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Trattatello.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Trattatello&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Trebuchet MS Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Supplemental/Trebuchet MS Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Trebuchet MS Bold Italic&#39;
## 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Trebuchet MS Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Trebuchet MS Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Trebuchet MS Bold&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Trebuchet MS Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Trebuchet MS Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Trebuchet MS Italic&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Trebuchet MS.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Trebuchet MS.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Trebuchet MS&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Verdana Bold Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Verdana Bold Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Verdana Bold Italic&#39; 2&gt;&amp;1&#39;
## had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Verdana Bold.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Verdana Bold.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Verdana Bold&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Verdana Italic.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Verdana Italic.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Verdana Italic&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Verdana.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Verdana.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Verdana&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Webdings.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Webdings.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Webdings&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Wingdings 2.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Wingdings 2.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Wingdings 2&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Wingdings 3.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/
## System/Library/Fonts/Supplemental/Wingdings 3.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Wingdings 3&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Wingdings.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Wingdings.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Wingdings&#39; 2&gt;&amp;1&#39; had
## status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Supplemental/Zapfino.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/
## Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/
## Rttf2pt1/1.3.9/da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39;
## -a -GfAe &#39;/System/Library/Fonts/Supplemental/Zapfino.ttf&#39; &#39;/var/folders/
## 24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpMIF4wT/fonts/Zapfino&#39; 2&gt;&amp;1&#39; had status
## 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/Symbol.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/Symbol.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//
## RtmpMIF4wT/fonts/Symbol&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## /System/Library/Fonts/ZapfDingbats.ttf</code></pre>
<pre><code>## Warning in system2(ttf2pt1, c(args, shQuote(ttfiles[i]),
## shQuote(tmpfiles[i])), : running command &#39;&#39;/Users/runner/Library/Application
## Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/Rttf2pt1/1.3.9/
## da6ab407fa2e5e498ac980f92798cfed/Rttf2pt1/exec//ttf2pt1&#39; -a -GfAe &#39;/System/
## Library/Fonts/ZapfDingbats.ttf&#39; &#39;/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/
## T//RtmpMIF4wT/fonts/ZapfDingbats&#39; 2&gt;&amp;1&#39; had status 139</code></pre>
<pre><code>##  : No FontName. Skipping.
## Found FontName for 0 fonts.
## Scanning afm files in /Users/runner/Library/Application Support/renv/cache/v5/R-4.1/x86_64-apple-darwin17.0/extrafontdb/1.0/a861555ddec7451c653b40e713166c6f/extrafontdb/metrics</code></pre>
<div id="announcements-15" class="section level2">
<h2><span class="header-section-number">20.1</span> Announcements</h2>
</div>
<div id="spbayes-example" class="section level2">
<h2><span class="header-section-number">20.2</span> spBayes example</h2>
<p>Fitting a spatial model using the <code>NOAA_df_1990</code> data.frame from the <code>STRbook</code> package. We will focus on the average max temperature for July 1990.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="day-20.html#cb672-1"></a><span class="kw">data</span>(<span class="st">&quot;NOAA_df_1990&quot;</span>)</span>
<span id="cb672-2"><a href="day-20.html#cb672-2"></a><span class="co">## add a factor variable for left_join</span></span>
<span id="cb672-3"><a href="day-20.html#cb672-3"></a>NOAA_df_<span class="dv">1990</span><span class="op">$</span>id_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(NOAA_df_<span class="dv">1990</span><span class="op">$</span>id)</span>
<span id="cb672-4"><a href="day-20.html#cb672-4"></a>dat &lt;-<span class="st"> </span>NOAA_df_<span class="dv">1990</span> <span class="op">%&gt;%</span></span>
<span id="cb672-5"><a href="day-20.html#cb672-5"></a><span class="st">    </span><span class="kw">subset</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1990</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>proc <span class="op">==</span><span class="st"> &quot;Tmax&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb672-6"><a href="day-20.html#cb672-6"></a><span class="st">    </span><span class="kw">group_by</span>(id_factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb672-7"><a href="day-20.html#cb672-7"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_Tmax =</span> <span class="kw">mean</span>(z)) <span class="co">#</span></span>
<span id="cb672-8"><a href="day-20.html#cb672-8"></a></span>
<span id="cb672-9"><a href="day-20.html#cb672-9"></a><span class="co">## add back in the lat/lon variables</span></span>
<span id="cb672-10"><a href="day-20.html#cb672-10"></a>dat &lt;-<span class="st"> </span>NOAA_df_<span class="dv">1990</span> <span class="op">%&gt;%</span></span>
<span id="cb672-11"><a href="day-20.html#cb672-11"></a><span class="st">    </span><span class="kw">subset</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1990</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>proc <span class="op">==</span><span class="st"> &quot;Tmax&quot;</span> <span class="op">&amp;</span><span class="st"> </span>day <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb672-12"><a href="day-20.html#cb672-12"></a><span class="st">    </span><span class="kw">left_join</span>(dat, <span class="dt">by =</span> <span class="st">&quot;id_factor&quot;</span>) </span></code></pre></div>
<p>First we fit the <code>spBayes</code> model using an exponential covariance function.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="day-20.html#cb673-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb673-2"><a href="day-20.html#cb673-2"></a></span>
<span id="cb673-3"><a href="day-20.html#cb673-3"></a>n.samples &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb673-4"><a href="day-20.html#cb673-4"></a></span>
<span id="cb673-5"><a href="day-20.html#cb673-5"></a>starting &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">phi =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">100</span>, <span class="dt">sigma.sq =</span> <span class="dv">2</span>, <span class="dt">tau.sq =</span> <span class="dv">2</span>)</span>
<span id="cb673-6"><a href="day-20.html#cb673-6"></a>tuning &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">phi =</span> <span class="fl">2.5</span>, <span class="dt">sigma.sq =</span> <span class="fl">0.1</span>, <span class="dt">tau.sq =</span> <span class="fl">0.1</span>)</span>
<span id="cb673-7"><a href="day-20.html#cb673-7"></a>p &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">## use lat and lon as predictors (plus an intercept)</span></span>
<span id="cb673-8"><a href="day-20.html#cb673-8"></a>coords &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(dat<span class="op">$</span>lon, dat<span class="op">$</span>lat))</span>
<span id="cb673-9"><a href="day-20.html#cb673-9"></a>max_dist &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">rdist</span>(coords))</span>
<span id="cb673-10"><a href="day-20.html#cb673-10"></a>priors &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb673-11"><a href="day-20.html#cb673-11"></a>    <span class="dt">beta.Norm   =</span> <span class="kw">list</span>(<span class="kw">rep</span>(<span class="dv">0</span>, p), <span class="kw">diag</span>(<span class="fl">1e+06</span>, p)),</span>
<span id="cb673-12"><a href="day-20.html#cb673-12"></a>    <span class="dt">phi.Unif    =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>),</span>
<span id="cb673-13"><a href="day-20.html#cb673-13"></a>    <span class="dt">sigma.sq.IG =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), </span>
<span id="cb673-14"><a href="day-20.html#cb673-14"></a>    <span class="dt">tau.sq.IG   =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb673-15"><a href="day-20.html#cb673-15"></a>)</span>
<span id="cb673-16"><a href="day-20.html#cb673-16"></a>cov.model &lt;-<span class="st"> &quot;exponential&quot;</span></span>
<span id="cb673-17"><a href="day-20.html#cb673-17"></a></span>
<span id="cb673-18"><a href="day-20.html#cb673-18"></a>fit_e &lt;-<span class="st"> </span><span class="kw">spLM</span>(</span>
<span id="cb673-19"><a href="day-20.html#cb673-19"></a>    dat<span class="op">$</span>z <span class="op">~</span><span class="st"> </span>dat<span class="op">$</span>lon <span class="op">+</span><span class="st"> </span>dat<span class="op">$</span>lat,</span>
<span id="cb673-20"><a href="day-20.html#cb673-20"></a>    <span class="dt">coords    =</span> coords,</span>
<span id="cb673-21"><a href="day-20.html#cb673-21"></a>    <span class="dt">starting  =</span> starting,</span>
<span id="cb673-22"><a href="day-20.html#cb673-22"></a>    <span class="dt">tuning    =</span> tuning, </span>
<span id="cb673-23"><a href="day-20.html#cb673-23"></a>    <span class="dt">priors    =</span> priors, </span>
<span id="cb673-24"><a href="day-20.html#cb673-24"></a>    <span class="dt">cov.model =</span> cov.model, </span>
<span id="cb673-25"><a href="day-20.html#cb673-25"></a>    <span class="dt">n.samples =</span> n.samples,</span>
<span id="cb673-26"><a href="day-20.html#cb673-26"></a>    <span class="dt">n.report  =</span> <span class="dv">1000</span></span>
<span id="cb673-27"><a href="day-20.html#cb673-27"></a>)</span></code></pre></div>
<pre><code>## ----------------------------------------
##  General model description
## ----------------------------------------
## Model fit with 136 observations.
## 
## Number of covariates 3 (including intercept if specified).
## 
## Using the exponential spatial correlation model.
## 
## Number of MCMC samples 5000.
## 
## Priors and hyperpriors:
##  beta normal:
##  mu: 0.000   0.000   0.000   
##  cov:
##  1000000.000 0.000   0.000   
##  0.000   1000000.000 0.000   
##  0.000   0.000   1000000.000 
## 
##  sigma.sq IG hyperpriors shape=2.00000 and scale=2.00000
##  tau.sq IG hyperpriors shape=2.00000 and scale=2.00000
##  phi Unif hyperpriors a=0.01000 and b=100.00000
## -------------------------------------------------
##      Sampling
## -------------------------------------------------
## Sampled: 1000 of 5000, 20.00%
## Report interval Metrop. Acceptance rate: 11.00%
## Overall Metrop. Acceptance rate: 11.00%
## -------------------------------------------------
## Sampled: 2000 of 5000, 40.00%
## Report interval Metrop. Acceptance rate: 11.00%
## Overall Metrop. Acceptance rate: 11.00%
## -------------------------------------------------
## Sampled: 3000 of 5000, 60.00%
## Report interval Metrop. Acceptance rate: 9.20%
## Overall Metrop. Acceptance rate: 10.40%
## -------------------------------------------------
## Sampled: 4000 of 5000, 80.00%
## Report interval Metrop. Acceptance rate: 10.20%
## Overall Metrop. Acceptance rate: 10.35%
## -------------------------------------------------
## Sampled: 5000 of 5000, 100.00%
## Report interval Metrop. Acceptance rate: 9.00%
## Overall Metrop. Acceptance rate: 10.08%
## -------------------------------------------------</code></pre>
<p>The above fits the model. However, sometimes it is hard to “tune” the model to get the desired Metropolis acceptance rate. <code>spLM</code> has an option for adaptive MCMC tuning. To enable this option, we add an <code>amcmc</code> option. We are also going to change to a Matern covarince function in the next code as well.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="day-20.html#cb675-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb675-2"><a href="day-20.html#cb675-2"></a></span>
<span id="cb675-3"><a href="day-20.html#cb675-3"></a>n.samples    &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb675-4"><a href="day-20.html#cb675-4"></a>batch.length &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb675-5"><a href="day-20.html#cb675-5"></a>n.batch      &lt;-<span class="st"> </span>n.samples <span class="op">/</span><span class="st"> </span>batch.length</span>
<span id="cb675-6"><a href="day-20.html#cb675-6"></a></span>
<span id="cb675-7"><a href="day-20.html#cb675-7"></a><span class="co">## must add in values for the smoothness paramter nu</span></span>
<span id="cb675-8"><a href="day-20.html#cb675-8"></a>starting &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">phi =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">100</span>, <span class="dt">sigma.sq =</span> <span class="dv">2</span>, <span class="dt">tau.sq =</span> <span class="dv">2</span>, <span class="dt">nu =</span> <span class="dv">1</span>)</span>
<span id="cb675-9"><a href="day-20.html#cb675-9"></a>tuning &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">phi =</span> <span class="fl">2.5</span>, <span class="dt">sigma.sq =</span> <span class="fl">0.1</span>, <span class="dt">tau.sq =</span> <span class="fl">0.1</span>, <span class="dt">nu =</span> <span class="fl">0.1</span>)</span>
<span id="cb675-10"><a href="day-20.html#cb675-10"></a>p &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">## use lat and lon as predictors (plus an intercept)</span></span>
<span id="cb675-11"><a href="day-20.html#cb675-11"></a>coords &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(dat<span class="op">$</span>lon, dat<span class="op">$</span>lat))</span>
<span id="cb675-12"><a href="day-20.html#cb675-12"></a>max_dist &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">rdist</span>(coords))</span>
<span id="cb675-13"><a href="day-20.html#cb675-13"></a>priors &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb675-14"><a href="day-20.html#cb675-14"></a>    <span class="dt">beta.Norm   =</span> <span class="kw">list</span>(<span class="kw">rep</span>(<span class="dv">0</span>, p), <span class="kw">diag</span>(<span class="fl">1e+06</span>, p)),</span>
<span id="cb675-15"><a href="day-20.html#cb675-15"></a>    <span class="dt">phi.Unif    =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>),</span>
<span id="cb675-16"><a href="day-20.html#cb675-16"></a>    <span class="dt">nu.Unif     =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>),</span>
<span id="cb675-17"><a href="day-20.html#cb675-17"></a>    <span class="dt">sigma.sq.IG =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), </span>
<span id="cb675-18"><a href="day-20.html#cb675-18"></a>    <span class="dt">tau.sq.IG   =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb675-19"><a href="day-20.html#cb675-19"></a>)</span>
<span id="cb675-20"><a href="day-20.html#cb675-20"></a>cov.model &lt;-<span class="st"> &quot;matern&quot;</span></span>
<span id="cb675-21"><a href="day-20.html#cb675-21"></a></span>
<span id="cb675-22"><a href="day-20.html#cb675-22"></a>fit_m &lt;-<span class="st"> </span><span class="kw">spLM</span>(</span>
<span id="cb675-23"><a href="day-20.html#cb675-23"></a>    dat<span class="op">$</span>z <span class="op">~</span><span class="st"> </span>dat<span class="op">$</span>lon <span class="op">+</span><span class="st"> </span>dat<span class="op">$</span>lat,</span>
<span id="cb675-24"><a href="day-20.html#cb675-24"></a>    <span class="dt">coords    =</span> coords,</span>
<span id="cb675-25"><a href="day-20.html#cb675-25"></a>    <span class="dt">starting  =</span> starting,</span>
<span id="cb675-26"><a href="day-20.html#cb675-26"></a>    <span class="dt">tuning    =</span> tuning, </span>
<span id="cb675-27"><a href="day-20.html#cb675-27"></a>    <span class="dt">priors    =</span> priors, </span>
<span id="cb675-28"><a href="day-20.html#cb675-28"></a>    <span class="dt">cov.model =</span> cov.model, </span>
<span id="cb675-29"><a href="day-20.html#cb675-29"></a>    <span class="dt">n.samples =</span> n.samples,</span>
<span id="cb675-30"><a href="day-20.html#cb675-30"></a>    <span class="dt">amcmc     =</span> <span class="kw">list</span>(</span>
<span id="cb675-31"><a href="day-20.html#cb675-31"></a>        <span class="dt">n.batch =</span> n.batch, </span>
<span id="cb675-32"><a href="day-20.html#cb675-32"></a>        <span class="dt">batch.length =</span> batch.length,</span>
<span id="cb675-33"><a href="day-20.html#cb675-33"></a>        <span class="dt">accept.rate =</span> <span class="fl">0.44</span></span>
<span id="cb675-34"><a href="day-20.html#cb675-34"></a>    ),</span>
<span id="cb675-35"><a href="day-20.html#cb675-35"></a>    <span class="dt">n.report  =</span> <span class="dv">10</span> <span class="co">## report every 10 adaptive batches</span></span>
<span id="cb675-36"><a href="day-20.html#cb675-36"></a>)</span></code></pre></div>
<pre><code>## ----------------------------------------
##  General model description
## ----------------------------------------
## Model fit with 136 observations.
## 
## Number of covariates 3 (including intercept if specified).
## 
## Using the matern spatial correlation model.
## 
## Using adaptive MCMC.
## 
##  Number of batches 100.
##  Batch length 50.
##  Target acceptance rate 0.44000.
## 
## Priors and hyperpriors:
##  beta normal:
##  mu: 0.000   0.000   0.000   
##  cov:
##  1000000.000 0.000   0.000   
##  0.000   1000000.000 0.000   
##  0.000   0.000   1000000.000 
## 
##  sigma.sq IG hyperpriors shape=2.00000 and scale=2.00000
##  tau.sq IG hyperpriors shape=2.00000 and scale=2.00000
##  phi Unif hyperpriors a=0.01000 and b=100.00000
##  nu Unif hyperpriors a=0.01000 and b=100.00000
## -------------------------------------------------
##      Sampling
## -------------------------------------------------
## Batch: 10 of 100, 10.00%
##  parameter   acceptance  tuning
##  sigma.sq    54.0        0.34257
##  tau.sq      68.0        0.34949
##  phi     28.0        1.43067
##  nu      36.0        0.29192
## -------------------------------------------------
## Batch: 20 of 100, 20.00%
##  parameter   acceptance  tuning
##  sigma.sq    52.0        0.36375
##  tau.sq      44.0        0.37859
##  phi     16.0        1.29453
##  nu      48.0        0.28613
## -------------------------------------------------
## Batch: 30 of 100, 30.00%
##  parameter   acceptance  tuning
##  sigma.sq    54.0        0.39404
##  tau.sq      50.0        0.41013
##  phi     10.0        1.17134
##  nu      52.0        0.28047
## -------------------------------------------------
## Batch: 40 of 100, 40.00%
##  parameter   acceptance  tuning
##  sigma.sq    56.0        0.39404
##  tau.sq      58.0        0.43549
##  phi     22.0        1.05987
##  nu      46.0        0.29192
## -------------------------------------------------
## Batch: 50 of 100, 50.00%
##  parameter   acceptance  tuning
##  sigma.sq    42.0        0.37859
##  tau.sq      60.0        0.48129
##  phi     16.0        0.95901
##  nu      36.0        0.27492
## -------------------------------------------------
## Batch: 60 of 100, 60.00%
##  parameter   acceptance  tuning
##  sigma.sq    36.0        0.36375
##  tau.sq      58.0        0.53190
##  phi     20.0        0.86775
##  nu      38.0        0.25378
## -------------------------------------------------
## Batch: 70 of 100, 70.00%
##  parameter   acceptance  tuning
##  sigma.sq    44.0        0.37110
##  tau.sq      48.0        0.55361
##  phi     22.0        0.78517
##  nu      54.0        0.24875
## -------------------------------------------------
## Batch: 80 of 100, 80.00%
##  parameter   acceptance  tuning
##  sigma.sq    60.0        0.39404
##  tau.sq      52.0        0.58784
##  phi     18.0        0.71045
##  nu      36.0        0.24383
## -------------------------------------------------
## Batch: 90 of 100, 90.00%
##  parameter   acceptance  tuning
##  sigma.sq    36.0        0.39404
##  tau.sq      52.0        0.58784
##  phi     28.0        0.64284
##  nu      42.0        0.23427
## -------------------------------------------------
## Batch: 100 of 100, 100.00%
##  parameter   acceptance  tuning
##  sigma.sq    58.0        0.38624
##  tau.sq      54.0        0.61184
##  phi     26.0        0.58167
##  nu      50.0        0.22508
## -------------------------------------------------</code></pre>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="day-20.html#cb677-1"></a><span class="co">## can update the initial tuning parameters given the adapted values</span></span></code></pre></div>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="day-20.html#cb678-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb678-2"><a href="day-20.html#cb678-2"></a></span>
<span id="cb678-3"><a href="day-20.html#cb678-3"></a>tuning &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">phi =</span> <span class="fl">0.5</span>, <span class="dt">sigma.sq =</span> <span class="fl">0.38</span>, <span class="dt">tau.sq =</span> <span class="fl">0.6</span>, <span class="dt">nu =</span> <span class="fl">0.3</span>)</span>
<span id="cb678-4"><a href="day-20.html#cb678-4"></a>fit_m &lt;-<span class="st"> </span><span class="kw">spLM</span>(</span>
<span id="cb678-5"><a href="day-20.html#cb678-5"></a>    dat<span class="op">$</span>z <span class="op">~</span><span class="st"> </span>dat<span class="op">$</span>lon <span class="op">+</span><span class="st"> </span>dat<span class="op">$</span>lat,</span>
<span id="cb678-6"><a href="day-20.html#cb678-6"></a>    <span class="dt">coords    =</span> coords,</span>
<span id="cb678-7"><a href="day-20.html#cb678-7"></a>    <span class="dt">starting  =</span> starting,</span>
<span id="cb678-8"><a href="day-20.html#cb678-8"></a>    <span class="dt">tuning    =</span> tuning, </span>
<span id="cb678-9"><a href="day-20.html#cb678-9"></a>    <span class="dt">priors    =</span> priors, </span>
<span id="cb678-10"><a href="day-20.html#cb678-10"></a>    <span class="dt">cov.model =</span> cov.model, </span>
<span id="cb678-11"><a href="day-20.html#cb678-11"></a>    <span class="dt">n.samples =</span> n.samples,</span>
<span id="cb678-12"><a href="day-20.html#cb678-12"></a>    <span class="dt">amcmc     =</span> <span class="kw">list</span>(</span>
<span id="cb678-13"><a href="day-20.html#cb678-13"></a>        <span class="dt">n.batch =</span> n.batch, </span>
<span id="cb678-14"><a href="day-20.html#cb678-14"></a>        <span class="dt">batch.length =</span> batch.length,</span>
<span id="cb678-15"><a href="day-20.html#cb678-15"></a>        <span class="dt">accept.rate =</span> <span class="fl">0.44</span></span>
<span id="cb678-16"><a href="day-20.html#cb678-16"></a>    ),</span>
<span id="cb678-17"><a href="day-20.html#cb678-17"></a>    <span class="dt">n.report  =</span> <span class="dv">10</span> <span class="co">## report every 10 adaptive batches</span></span>
<span id="cb678-18"><a href="day-20.html#cb678-18"></a>)</span></code></pre></div>
<pre><code>## ----------------------------------------
##  General model description
## ----------------------------------------
## Model fit with 136 observations.
## 
## Number of covariates 3 (including intercept if specified).
## 
## Using the matern spatial correlation model.
## 
## Using adaptive MCMC.
## 
##  Number of batches 100.
##  Batch length 50.
##  Target acceptance rate 0.44000.
## 
## Priors and hyperpriors:
##  beta normal:
##  mu: 0.000   0.000   0.000   
##  cov:
##  1000000.000 0.000   0.000   
##  0.000   1000000.000 0.000   
##  0.000   0.000   1000000.000 
## 
##  sigma.sq IG hyperpriors shape=2.00000 and scale=2.00000
##  tau.sq IG hyperpriors shape=2.00000 and scale=2.00000
##  phi Unif hyperpriors a=0.01000 and b=100.00000
##  nu Unif hyperpriors a=0.01000 and b=100.00000
## -------------------------------------------------
##      Sampling
## -------------------------------------------------
## Batch: 10 of 100, 10.00%
##  parameter   acceptance  tuning
##  sigma.sq    34.0        0.56905
##  tau.sq      46.0        0.72949
##  phi     56.0        0.65274
##  nu      24.0        0.49560
## -------------------------------------------------
## Batch: 20 of 100, 20.00%
##  parameter   acceptance  tuning
##  sigma.sq    32.0        0.51490
##  tau.sq      28.0        0.72949
##  phi     30.0        0.59063
##  nu      36.0        0.44844
## -------------------------------------------------
## Batch: 30 of 100, 30.00%
##  parameter   acceptance  tuning
##  sigma.sq    50.0        0.49471
##  tau.sq      40.0        0.71504
##  phi     22.0        0.53442
##  nu      34.0        0.40576
## -------------------------------------------------
## Batch: 40 of 100, 40.00%
##  parameter   acceptance  tuning
##  sigma.sq    48.0        0.47531
##  tau.sq      50.0        0.71504
##  phi     24.0        0.48356
##  nu      28.0        0.36715
## -------------------------------------------------
## Batch: 50 of 100, 50.00%
##  parameter   acceptance  tuning
##  sigma.sq    42.0        0.43008
##  tau.sq      50.0        0.77460
##  phi     28.0        0.44638
##  nu      28.0        0.33221
## -------------------------------------------------
## Batch: 60 of 100, 60.00%
##  parameter   acceptance  tuning
##  sigma.sq    38.0        0.41321
##  tau.sq      46.0        0.71504
##  phi     36.0        0.40391
##  nu      32.0        0.30667
## -------------------------------------------------
## Batch: 70 of 100, 70.00%
##  parameter   acceptance  tuning
##  sigma.sq    42.0        0.40503
##  tau.sq      42.0        0.67340
##  phi     44.0        0.36547
##  nu      40.0        0.28881
## -------------------------------------------------
## Batch: 80 of 100, 80.00%
##  parameter   acceptance  tuning
##  sigma.sq    52.0        0.41321
##  tau.sq      52.0        0.68701
##  phi     30.0        0.33737
##  nu      36.0        0.27199
## -------------------------------------------------
## Batch: 90 of 100, 90.00%
##  parameter   acceptance  tuning
##  sigma.sq    38.0        0.38915
##  tau.sq      60.0        0.67340
##  phi     48.0        0.31772
##  nu      36.0        0.25615
## -------------------------------------------------
## Batch: 100 of 100, 100.00%
##  parameter   acceptance  tuning
##  sigma.sq    54.0        0.38144
##  tau.sq      44.0        0.66007
##  phi     42.0        0.29922
##  nu      48.0        0.24611
## -------------------------------------------------</code></pre>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="day-20.html#cb680-1"></a><span class="co">## can update the initial tuning parameters given the adapted values</span></span></code></pre></div>
<p>To get the fitted parameters, we can recover these with composition sampling.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="day-20.html#cb681-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb681-2"><a href="day-20.html#cb681-2"></a></span>
<span id="cb681-3"><a href="day-20.html#cb681-3"></a><span class="co">## discard the first half of the samples as burn-in</span></span>
<span id="cb681-4"><a href="day-20.html#cb681-4"></a>burn.in &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>n.samples</span>
<span id="cb681-5"><a href="day-20.html#cb681-5"></a><span class="co">## trace plots for the exponential model</span></span>
<span id="cb681-6"><a href="day-20.html#cb681-6"></a>fit_e &lt;-<span class="st"> </span><span class="kw">spRecover</span>(fit_e, <span class="dt">start =</span> burn.in, <span class="dt">thin =</span> <span class="dv">2</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb681-7"><a href="day-20.html#cb681-7"></a>theta.samps &lt;-<span class="st"> </span><span class="kw">mcmc.list</span>(fit_e<span class="op">$</span>p.theta.samples, fit_e<span class="op">$</span>p.theta.samples)</span>
<span id="cb681-8"><a href="day-20.html#cb681-8"></a><span class="kw">plot</span>(theta.samps, <span class="dt">density =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/spBayes-recover-1.png" width="672" /></p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="day-20.html#cb682-1"></a>beta.samps &lt;-<span class="st"> </span><span class="kw">mcmc.list</span>(fit_e<span class="op">$</span>p.beta.recover.samples, fit_e<span class="op">$</span>p.beta.recover.samples)  </span>
<span id="cb682-2"><a href="day-20.html#cb682-2"></a><span class="kw">plot</span>(beta.samps, <span class="dt">density =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/spBayes-recover-2.png" width="672" /></p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="day-20.html#cb683-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb683-2"><a href="day-20.html#cb683-2"></a></span>
<span id="cb683-3"><a href="day-20.html#cb683-3"></a><span class="co">## trace plots for the matern model</span></span>
<span id="cb683-4"><a href="day-20.html#cb683-4"></a>fit_m &lt;-<span class="st"> </span><span class="kw">spRecover</span>(fit_m, <span class="dt">start =</span> burn.in, <span class="dt">thin =</span> <span class="dv">2</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb683-5"><a href="day-20.html#cb683-5"></a>theta.samps &lt;-<span class="st"> </span><span class="kw">mcmc.list</span>(fit_m<span class="op">$</span>p.theta.samples, fit_m<span class="op">$</span>p.theta.samples)</span>
<span id="cb683-6"><a href="day-20.html#cb683-6"></a><span class="kw">plot</span>(theta.samps, <span class="dt">density =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/spBayes-recover-matern-1.png" width="672" /></p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="day-20.html#cb684-1"></a>beta.samps &lt;-<span class="st"> </span><span class="kw">mcmc.list</span>(fit_m<span class="op">$</span>p.beta.recover.samples, fit_m<span class="op">$</span>p.beta.recover.samples)  </span>
<span id="cb684-2"><a href="day-20.html#cb684-2"></a><span class="kw">plot</span>(beta.samps, <span class="dt">density =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/spBayes-recover-matern-2.png" width="672" /></p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="day-20.html#cb685-1"></a><span class="kw">round</span>(<span class="kw">summary</span>(theta.samps)<span class="op">$</span>quantiles, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##            2.5%    25%    50%    75%  97.5%
## sigma.sq 14.886 20.102 24.518 31.869 51.329
## tau.sq    0.560  1.070  1.493  1.981  3.126
## phi       0.151  0.346  0.507  0.713  1.389
## nu        0.532  0.857  1.115  1.508  3.532</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="day-20.html#cb687-1"></a><span class="co">## recover the spatial random effects</span></span>
<span id="cb687-2"><a href="day-20.html#cb687-2"></a>fit_e_w &lt;-<span class="st"> </span>fit_e<span class="op">$</span>p.w.recover.samples</span>
<span id="cb687-3"><a href="day-20.html#cb687-3"></a>fit_m_w &lt;-<span class="st"> </span>fit_m<span class="op">$</span>p.w.recover.samples</span>
<span id="cb687-4"><a href="day-20.html#cb687-4"></a></span>
<span id="cb687-5"><a href="day-20.html#cb687-5"></a><span class="co">## recover the spatial random effects (eta&#39;s in our class notation)</span></span>
<span id="cb687-6"><a href="day-20.html#cb687-6"></a>w.samps &lt;-<span class="st"> </span><span class="kw">cbind</span>(fit_e_w, fit_m_w)</span>
<span id="cb687-7"><a href="day-20.html#cb687-7"></a>w.summary &lt;-<span class="st"> </span><span class="kw">apply</span>(w.samps, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb687-8"><a href="day-20.html#cb687-8"></a>    <span class="kw">quantile</span>(x, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb687-9"><a href="day-20.html#cb687-9"></a>})</span></code></pre></div>
<p>Next we can genereate predictions for the exponential model</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="day-20.html#cb688-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb688-2"><a href="day-20.html#cb688-2"></a></span>
<span id="cb688-3"><a href="day-20.html#cb688-3"></a>states &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)</span>
<span id="cb688-4"><a href="day-20.html#cb688-4"></a></span>
<span id="cb688-5"><a href="day-20.html#cb688-5"></a>pred_coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb688-6"><a href="day-20.html#cb688-6"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb688-7"><a href="day-20.html#cb688-7"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb688-8"><a href="day-20.html#cb688-8"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb688-9"><a href="day-20.html#cb688-9"></a>    )</span>
<span id="cb688-10"><a href="day-20.html#cb688-10"></a>)</span>
<span id="cb688-11"><a href="day-20.html#cb688-11"></a><span class="kw">colnames</span>(pred_coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb688-12"><a href="day-20.html#cb688-12"></a></span>
<span id="cb688-13"><a href="day-20.html#cb688-13"></a><span class="co">## predict using the tuned Matern fit</span></span>
<span id="cb688-14"><a href="day-20.html#cb688-14"></a>preds &lt;-<span class="st"> </span><span class="kw">spPredict</span>(</span>
<span id="cb688-15"><a href="day-20.html#cb688-15"></a>    fit_e, </span>
<span id="cb688-16"><a href="day-20.html#cb688-16"></a>    <span class="dt">start =</span> burn.in, </span>
<span id="cb688-17"><a href="day-20.html#cb688-17"></a>    <span class="dt">thin =</span> <span class="dv">10</span>, </span>
<span id="cb688-18"><a href="day-20.html#cb688-18"></a>    <span class="dt">pred.coords =</span> <span class="kw">cbind</span>(pred_coords<span class="op">$</span>lon, pred_coords<span class="op">$</span>lat), </span>
<span id="cb688-19"><a href="day-20.html#cb688-19"></a>    <span class="dt">pred.covars =</span> <span class="kw">cbind</span>(<span class="dv">1</span>, pred_coords<span class="op">$</span>lon, pred_coords<span class="op">$</span>lat)</span>
<span id="cb688-20"><a href="day-20.html#cb688-20"></a>)</span></code></pre></div>
<pre><code>## ----------------------------------------
##  General model description
## ----------------------------------------
## Model fit with 136 observations.
## 
## Prediction at 10000 locations.
## 
## Number of covariates 3 (including intercept if specified).
## 
## Using the exponential spatial correlation model.
## 
## -------------------------------------------------
##      Sampling
## -------------------------------------------------
## Sampled: 100 of 251, 39.44%
## Sampled: 200 of 251, 79.28%</code></pre>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="day-20.html#cb690-1"></a><span class="co">## Calculate the prediction means and variances</span></span>
<span id="cb690-2"><a href="day-20.html#cb690-2"></a>pred_coords<span class="op">$</span>pred_e_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(preds<span class="op">$</span>p.y.predictive.samples, <span class="dv">1</span>, mean)</span>
<span id="cb690-3"><a href="day-20.html#cb690-3"></a>pred_coords<span class="op">$</span>pred_e_var &lt;-<span class="st"> </span><span class="kw">apply</span>(preds<span class="op">$</span>p.y.predictive.samples, <span class="dv">1</span>, var)</span>
<span id="cb690-4"><a href="day-20.html#cb690-4"></a></span>
<span id="cb690-5"><a href="day-20.html#cb690-5"></a><span class="co">## calculate 95% credible intervals for the predictions</span></span>
<span id="cb690-6"><a href="day-20.html#cb690-6"></a>pred.summary &lt;-<span class="st"> </span><span class="kw">apply</span>(preds<span class="op">$</span>p.y.predictive.samples, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb690-7"><a href="day-20.html#cb690-7"></a>    <span class="kw">quantile</span>(x, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb690-8"><a href="day-20.html#cb690-8"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="day-20.html#cb691-1"></a><span class="co"># not sure why this plot keeps failing...</span></span>
<span id="cb691-2"><a href="day-20.html#cb691-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_coords, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_e_ean)) <span class="op">+</span></span>
<span id="cb691-3"><a href="day-20.html#cb691-3"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb691-4"><a href="day-20.html#cb691-4"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb691-5"><a href="day-20.html#cb691-5"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb691-6"><a href="day-20.html#cb691-6"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb691-7"><a href="day-20.html#cb691-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Predicted Average July max Temperature in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb691-8"><a href="day-20.html#cb691-8"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span>
<span id="cb691-9"><a href="day-20.html#cb691-9"></a></span>
<span id="cb691-10"><a href="day-20.html#cb691-10"></a></span>
<span id="cb691-11"><a href="day-20.html#cb691-11"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_coords, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_e_var)) <span class="op">+</span></span>
<span id="cb691-12"><a href="day-20.html#cb691-12"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb691-13"><a href="day-20.html#cb691-13"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb691-14"><a href="day-20.html#cb691-14"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb691-15"><a href="day-20.html#cb691-15"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb691-16"><a href="day-20.html#cb691-16"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average July max Temperature prediction variance in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb691-17"><a href="day-20.html#cb691-17"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p>Then we can genereate predictions for the exponential model</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="day-20.html#cb692-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb692-2"><a href="day-20.html#cb692-2"></a></span>
<span id="cb692-3"><a href="day-20.html#cb692-3"></a>states &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)</span>
<span id="cb692-4"><a href="day-20.html#cb692-4"></a></span>
<span id="cb692-5"><a href="day-20.html#cb692-5"></a>pred_coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb692-6"><a href="day-20.html#cb692-6"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb692-7"><a href="day-20.html#cb692-7"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb692-8"><a href="day-20.html#cb692-8"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb692-9"><a href="day-20.html#cb692-9"></a>    )</span>
<span id="cb692-10"><a href="day-20.html#cb692-10"></a>)</span>
<span id="cb692-11"><a href="day-20.html#cb692-11"></a><span class="kw">colnames</span>(pred_coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb692-12"><a href="day-20.html#cb692-12"></a></span>
<span id="cb692-13"><a href="day-20.html#cb692-13"></a><span class="co">## predict using the tuned Matern fit</span></span>
<span id="cb692-14"><a href="day-20.html#cb692-14"></a>preds &lt;-<span class="st"> </span><span class="kw">spPredict</span>(</span>
<span id="cb692-15"><a href="day-20.html#cb692-15"></a>    fit_m, </span>
<span id="cb692-16"><a href="day-20.html#cb692-16"></a>    <span class="dt">start =</span> burn.in, </span>
<span id="cb692-17"><a href="day-20.html#cb692-17"></a>    <span class="dt">thin =</span> <span class="dv">10</span>, </span>
<span id="cb692-18"><a href="day-20.html#cb692-18"></a>    <span class="dt">pred.coords =</span> <span class="kw">cbind</span>(pred_coords<span class="op">$</span>lon, pred_coords<span class="op">$</span>lat), </span>
<span id="cb692-19"><a href="day-20.html#cb692-19"></a>    <span class="dt">pred.covars =</span> <span class="kw">cbind</span>(<span class="dv">1</span>, pred_coords<span class="op">$</span>lon, pred_coords<span class="op">$</span>lat)</span>
<span id="cb692-20"><a href="day-20.html#cb692-20"></a>)</span></code></pre></div>
<pre><code>## ----------------------------------------
##  General model description
## ----------------------------------------
## Model fit with 136 observations.
## 
## Prediction at 10000 locations.
## 
## Number of covariates 3 (including intercept if specified).
## 
## Using the matern spatial correlation model.
## 
## -------------------------------------------------
##      Sampling
## -------------------------------------------------
## Sampled: 100 of 251, 39.44%
## Sampled: 200 of 251, 79.28%</code></pre>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="day-20.html#cb694-1"></a><span class="co">## Calculate the prediction means and variances</span></span>
<span id="cb694-2"><a href="day-20.html#cb694-2"></a>pred_coords<span class="op">$</span>pred_m_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(preds<span class="op">$</span>p.y.predictive.samples, <span class="dv">1</span>, mean)</span>
<span id="cb694-3"><a href="day-20.html#cb694-3"></a>pred_coords<span class="op">$</span>pred_m_var &lt;-<span class="st"> </span><span class="kw">apply</span>(preds<span class="op">$</span>p.y.predictive.samples, <span class="dv">1</span>, var)</span>
<span id="cb694-4"><a href="day-20.html#cb694-4"></a></span>
<span id="cb694-5"><a href="day-20.html#cb694-5"></a><span class="co">## calculate 95% credible intervals for the predictions</span></span>
<span id="cb694-6"><a href="day-20.html#cb694-6"></a>pred.summary &lt;-<span class="st"> </span><span class="kw">apply</span>(preds<span class="op">$</span>p.y.predictive.samples, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb694-7"><a href="day-20.html#cb694-7"></a>    <span class="kw">quantile</span>(x, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb694-8"><a href="day-20.html#cb694-8"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="day-20.html#cb695-1"></a><span class="co"># not sure why this plot keeps failing...</span></span>
<span id="cb695-2"><a href="day-20.html#cb695-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_coords, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_m_mean)) <span class="op">+</span></span>
<span id="cb695-3"><a href="day-20.html#cb695-3"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb695-4"><a href="day-20.html#cb695-4"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb695-5"><a href="day-20.html#cb695-5"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb695-6"><a href="day-20.html#cb695-6"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb695-7"><a href="day-20.html#cb695-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Predicted Average July max Temperature in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb695-8"><a href="day-20.html#cb695-8"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span>
<span id="cb695-9"><a href="day-20.html#cb695-9"></a></span>
<span id="cb695-10"><a href="day-20.html#cb695-10"></a></span>
<span id="cb695-11"><a href="day-20.html#cb695-11"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_coords, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_m_var)) <span class="op">+</span></span>
<span id="cb695-12"><a href="day-20.html#cb695-12"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb695-13"><a href="day-20.html#cb695-13"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb695-14"><a href="day-20.html#cb695-14"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb695-15"><a href="day-20.html#cb695-15"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb695-16"><a href="day-20.html#cb695-16"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average July max Temperature prediction variance in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb695-17"><a href="day-20.html#cb695-17"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p>Note these variances are higher than the MLE estimates (potentially by a lot – link to MLE fits day 11)</p>
</div>
<div id="global-vs.-local-basis-function" class="section level2">
<h2><span class="header-section-number">20.3</span> Global vs. Local Basis function</h2>
<ul>
<li>simulate some data</li>
</ul>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="day-20.html#cb696-1"></a><span class="kw">set.seed</span>(<span class="dv">44</span>)</span>
<span id="cb696-2"><a href="day-20.html#cb696-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb696-3"><a href="day-20.html#cb696-3"></a>sigma &lt;-<span class="st"> </span><span class="fl">0.2</span></span>
<span id="cb696-4"><a href="day-20.html#cb696-4"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> n)</span>
<span id="cb696-5"><a href="day-20.html#cb696-5"></a>Sigma &lt;-<span class="st"> </span><span class="kw">exp</span>( <span class="op">-</span><span class="st"> </span><span class="kw">rdist</span>(x)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="fl">0.02</span>)</span>
<span id="cb696-6"><a href="day-20.html#cb696-6"></a></span>
<span id="cb696-7"><a href="day-20.html#cb696-7"></a><span class="co">## Gaussian covariance with a small amount of &quot;error&quot;</span></span>
<span id="cb696-8"><a href="day-20.html#cb696-8"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rmvn</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>, n), Sigma <span class="op">+</span><span class="st"> </span><span class="fl">1e-10</span> <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(n))) </span>
<span id="cb696-9"><a href="day-20.html#cb696-9"></a>y &lt;-<span class="st"> </span>mu <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb696-10"><a href="day-20.html#cb696-10"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb696-11"><a href="day-20.html#cb696-11"></a>    <span class="dt">x  =</span> x,</span>
<span id="cb696-12"><a href="day-20.html#cb696-12"></a>    <span class="dt">y  =</span> y, </span>
<span id="cb696-13"><a href="day-20.html#cb696-13"></a>    <span class="dt">mu =</span> mu</span>
<span id="cb696-14"><a href="day-20.html#cb696-14"></a>)</span>
<span id="cb696-15"><a href="day-20.html#cb696-15"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> mu)) <span class="op">+</span></span>
<span id="cb696-16"><a href="day-20.html#cb696-16"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb696-17"><a href="day-20.html#cb696-17"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y))</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="an-example-global-basis-fourier-basis" class="section level3">
<h3><span class="header-section-number">20.3.1</span> An example global basis: Fourier Basis</h3>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="day-20.html#cb697-1"></a>make_fourier_basis &lt;-<span class="st"> </span><span class="cf">function</span>(x, num_freq) {</span>
<span id="cb697-2"><a href="day-20.html#cb697-2"></a>    <span class="co"># if (!is.integer(num_freq)) {</span></span>
<span id="cb697-3"><a href="day-20.html#cb697-3"></a>    <span class="co">#     stop(&quot;num_freq must be an odd integer&quot;)</span></span>
<span id="cb697-4"><a href="day-20.html#cb697-4"></a>    <span class="co"># }</span></span>
<span id="cb697-5"><a href="day-20.html#cb697-5"></a>    <span class="co"># if (num_freq %% 2 == 0) {</span></span>
<span id="cb697-6"><a href="day-20.html#cb697-6"></a>    <span class="co">#     stop(&quot;num_freq must be an odd integer&quot;)</span></span>
<span id="cb697-7"><a href="day-20.html#cb697-7"></a>    <span class="co"># }</span></span>
<span id="cb697-8"><a href="day-20.html#cb697-8"></a>    </span>
<span id="cb697-9"><a href="day-20.html#cb697-9"></a>    X_fourier &lt;-<span class="st"> </span><span class="kw">cbind</span>(</span>
<span id="cb697-10"><a href="day-20.html#cb697-10"></a>        <span class="dv">1</span>, </span>
<span id="cb697-11"><a href="day-20.html#cb697-11"></a>        <span class="kw">do.call</span>(</span>
<span id="cb697-12"><a href="day-20.html#cb697-12"></a>            cbind, </span>
<span id="cb697-13"><a href="day-20.html#cb697-13"></a>            <span class="kw">sapply</span>(</span>
<span id="cb697-14"><a href="day-20.html#cb697-14"></a>                <span class="dv">1</span><span class="op">:</span>((num_freq <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>), <span class="cf">function</span>(i) { </span>
<span id="cb697-15"><a href="day-20.html#cb697-15"></a>                    <span class="kw">cbind</span>(<span class="kw">sin</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>i <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>x), <span class="kw">cos</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>i <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>x))</span>
<span id="cb697-16"><a href="day-20.html#cb697-16"></a>                }, </span>
<span id="cb697-17"><a href="day-20.html#cb697-17"></a>            <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb697-18"><a href="day-20.html#cb697-18"></a>            )</span>
<span id="cb697-19"><a href="day-20.html#cb697-19"></a>        )</span>
<span id="cb697-20"><a href="day-20.html#cb697-20"></a>    )</span>
<span id="cb697-21"><a href="day-20.html#cb697-21"></a>    </span>
<span id="cb697-22"><a href="day-20.html#cb697-22"></a><span class="kw">return</span>(X_fourier)</span>
<span id="cb697-23"><a href="day-20.html#cb697-23"></a>}</span>
<span id="cb697-24"><a href="day-20.html#cb697-24"></a></span>
<span id="cb697-25"><a href="day-20.html#cb697-25"></a>X_fourier &lt;-<span class="st"> </span><span class="kw">make_fourier_basis</span>(x, <span class="dt">num_freq =</span> <span class="dv">5</span>)</span>
<span id="cb697-26"><a href="day-20.html#cb697-26"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb697-27"><a href="day-20.html#cb697-27"></a>    <span class="dt">x         =</span> x, </span>
<span id="cb697-28"><a href="day-20.html#cb697-28"></a>    <span class="dt">y         =</span> y,</span>
<span id="cb697-29"><a href="day-20.html#cb697-29"></a>    <span class="dt">mu        =</span> mu,</span>
<span id="cb697-30"><a href="day-20.html#cb697-30"></a>    <span class="dt">X_fourier =</span> <span class="kw">c</span>(X_fourier),</span>
<span id="cb697-31"><a href="day-20.html#cb697-31"></a>    <span class="dt">basis     =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_fourier), <span class="dt">each =</span> n))</span>
<span id="cb697-32"><a href="day-20.html#cb697-32"></a>)</span>
<span id="cb697-33"><a href="day-20.html#cb697-33"></a></span>
<span id="cb697-34"><a href="day-20.html#cb697-34"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb697-35"><a href="day-20.html#cb697-35"></a><span class="st">    </span><span class="co"># geom_point() +</span></span>
<span id="cb697-36"><a href="day-20.html#cb697-36"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> X_fourier, <span class="dt">group =</span> basis, <span class="dt">color =</span> basis)) <span class="op">+</span></span>
<span id="cb697-37"><a href="day-20.html#cb697-37"></a><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="op">+</span></span>
<span id="cb697-38"><a href="day-20.html#cb697-38"></a><span class="st">    </span><span class="kw">theme_dark</span>()</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="day-20.html#cb698-1"></a><span class="co">## fit a model using the Fourier basis</span></span>
<span id="cb698-2"><a href="day-20.html#cb698-2"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X_fourier <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="day-20.html#cb699-1"></a><span class="co">## plot the basis with fitted coefficients</span></span>
<span id="cb699-2"><a href="day-20.html#cb699-2"></a>dat<span class="op">$</span>fitted_basis &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb699-3"><a href="day-20.html#cb699-3"></a>    <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_fourier), <span class="cf">function</span>(i) X_fourier[, i] <span class="op">*</span><span class="st"> </span>fit<span class="op">$</span>coefficients[i])</span>
<span id="cb699-4"><a href="day-20.html#cb699-4"></a>)</span>
<span id="cb699-5"><a href="day-20.html#cb699-5"></a></span>
<span id="cb699-6"><a href="day-20.html#cb699-6"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb699-7"><a href="day-20.html#cb699-7"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb699-8"><a href="day-20.html#cb699-8"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> fitted_basis, <span class="dt">color =</span> basis, <span class="dt">group =</span> basis)) <span class="op">+</span></span>
<span id="cb699-9"><a href="day-20.html#cb699-9"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Weighted Fourier Basis functions&quot;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="day-20.html#cb700-1"></a><span class="co">## calculate the fitted function -- the sum of the bases</span></span>
<span id="cb700-2"><a href="day-20.html#cb700-2"></a>dat<span class="op">$</span>mu_hat &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_fourier), <span class="cf">function</span>(i) X_fourier[, i] <span class="op">*</span><span class="st"> </span>fit<span class="op">$</span>coefficients[i]), <span class="dv">1</span>, sum)</span>
<span id="cb700-3"><a href="day-20.html#cb700-3"></a></span>
<span id="cb700-4"><a href="day-20.html#cb700-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb700-5"><a href="day-20.html#cb700-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb700-6"><a href="day-20.html#cb700-6"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> mu_hat), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd  =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb700-7"><a href="day-20.html#cb700-7"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> mu), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb700-8"><a href="day-20.html#cb700-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Fitted function vs. simulated function&quot;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ul>
<li>The Fourier basis is global</li>
</ul>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="day-20.html#cb701-1"></a><span class="co">## only a small percentage of these values are zero</span></span>
<span id="cb701-2"><a href="day-20.html#cb701-2"></a><span class="kw">mean</span>(X_fourier <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 4e-04</code></pre>
</div>
</div>
<div id="example-local-basis" class="section level2">
<h2><span class="header-section-number">20.4</span> example local basis</h2>
<ul>
<li><p>B-splines are piecewise polynomial functions</p></li>
<li><p>degrees of freedom are the number of functions</p>
<ul>
<li>More degrees of freedom – more “wiggly” fit – potential for overfitting</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="day-20.html#cb703-1"></a><span class="co">## B-splines</span></span>
<span id="cb703-2"><a href="day-20.html#cb703-2"></a>X_bs &lt;-<span class="st"> </span><span class="kw">bs</span>(x, <span class="dt">intercept =</span> <span class="ot">TRUE</span>, <span class="dt">df =</span> <span class="dv">6</span>)</span>
<span id="cb703-3"><a href="day-20.html#cb703-3"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb703-4"><a href="day-20.html#cb703-4"></a>    <span class="dt">x     =</span> x, </span>
<span id="cb703-5"><a href="day-20.html#cb703-5"></a>    <span class="dt">y     =</span> y,</span>
<span id="cb703-6"><a href="day-20.html#cb703-6"></a>    <span class="dt">mu    =</span> mu,</span>
<span id="cb703-7"><a href="day-20.html#cb703-7"></a>    <span class="dt">X_bs  =</span> <span class="kw">c</span>(X_bs),</span>
<span id="cb703-8"><a href="day-20.html#cb703-8"></a>    <span class="dt">basis =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_bs), <span class="dt">each =</span> n))</span>
<span id="cb703-9"><a href="day-20.html#cb703-9"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="day-20.html#cb704-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb704-2"><a href="day-20.html#cb704-2"></a><span class="st">    </span><span class="co"># geom_point() +</span></span>
<span id="cb704-3"><a href="day-20.html#cb704-3"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> X_bs, <span class="dt">group =</span> basis, <span class="dt">color =</span> basis)) <span class="op">+</span></span>
<span id="cb704-4"><a href="day-20.html#cb704-4"></a><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="op">+</span></span>
<span id="cb704-5"><a href="day-20.html#cb704-5"></a><span class="st">    </span><span class="kw">theme_dark</span>()</span></code></pre></div>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="day-20.html#cb705-1"></a><span class="co">## fit a model using the B-spline basis</span></span>
<span id="cb705-2"><a href="day-20.html#cb705-2"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X_bs <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="day-20.html#cb706-1"></a><span class="co">## plot the basis with fitted coefficients</span></span>
<span id="cb706-2"><a href="day-20.html#cb706-2"></a>dat<span class="op">$</span>fitted_basis &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb706-3"><a href="day-20.html#cb706-3"></a>    <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_bs), <span class="cf">function</span>(i) X_bs[, i] <span class="op">*</span><span class="st"> </span>fit<span class="op">$</span>coefficients[i])</span>
<span id="cb706-4"><a href="day-20.html#cb706-4"></a>)</span>
<span id="cb706-5"><a href="day-20.html#cb706-5"></a></span>
<span id="cb706-6"><a href="day-20.html#cb706-6"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb706-7"><a href="day-20.html#cb706-7"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb706-8"><a href="day-20.html#cb706-8"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> fitted_basis, <span class="dt">color =</span> basis, <span class="dt">group =</span> basis)) <span class="op">+</span></span>
<span id="cb706-9"><a href="day-20.html#cb706-9"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Weighted B-spline Basis functions&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="day-20.html#cb707-1"></a><span class="co">## calculate the fitted function -- the sum of the bases</span></span>
<span id="cb707-2"><a href="day-20.html#cb707-2"></a>dat<span class="op">$</span>mu_hat &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_bs), <span class="cf">function</span>(i) X_bs[, i] <span class="op">*</span><span class="st"> </span>fit<span class="op">$</span>coefficients[i]), <span class="dv">1</span>, sum)</span>
<span id="cb707-3"><a href="day-20.html#cb707-3"></a></span>
<span id="cb707-4"><a href="day-20.html#cb707-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb707-5"><a href="day-20.html#cb707-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb707-6"><a href="day-20.html#cb707-6"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> mu_hat), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd  =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb707-7"><a href="day-20.html#cb707-7"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> mu), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb707-8"><a href="day-20.html#cb707-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Fitted function vs. simulated function&quot;</span>)</span></code></pre></div>
<ul>
<li>The B-spline basis is local</li>
</ul>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="day-20.html#cb708-1"></a><span class="co">## a much larger percentage of these values are zero -- can use sparse matrix</span></span>
<span id="cb708-2"><a href="day-20.html#cb708-2"></a><span class="co">##     routines to solve these equations much faster</span></span>
<span id="cb708-3"><a href="day-20.html#cb708-3"></a><span class="kw">mean</span>(X_bs <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.3346667</code></pre>
</div>
<div id="fitting-spatial-models-many-ways" class="section level2">
<h2><span class="header-section-number">20.5</span> Fitting spatial models many ways</h2>
</div>
<div id="empirical-orthogonal-functions" class="section level2">
<h2><span class="header-section-number">20.6</span> Empirical Orthogonal Functions</h2>
<ul>
<li><p>Recall the Karhunen-Loève expansion</p></li>
<li><p>Analog for PCA for spatio-temporal data</p></li>
<li><p>Use the sea surface temperature (SST) data in <span class="citation">Wikle, Zammit-Mangion, and Cressie (<a href="#ref-wikle2019spatio" role="doc-biblioref">2019</a>)</span></p></li>
</ul>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="day-20.html#cb710-1"></a><span class="kw">data</span>(<span class="st">&quot;SSTlandmask&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;STRbook&quot;</span>)</span>
<span id="cb710-2"><a href="day-20.html#cb710-2"></a><span class="kw">data</span>(<span class="st">&quot;SSTlonlat&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;STRbook&quot;</span>) </span>
<span id="cb710-3"><a href="day-20.html#cb710-3"></a><span class="kw">data</span>(<span class="st">&quot;SSTdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;STRbook&quot;</span>)</span></code></pre></div>
<p>Delete the values of SST that are over land (e.g. <code>SSTlandmask</code> is 1)</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="day-20.html#cb711-1"></a>delete_rows &lt;-<span class="st"> </span><span class="kw">which</span>(SSTlandmask <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb711-2"><a href="day-20.html#cb711-2"></a>SSTdata &lt;-<span class="st"> </span>SSTdata[<span class="op">-</span>delete_rows, <span class="dv">1</span><span class="op">:</span><span class="dv">396</span>]</span></code></pre></div>
<p>The eigen decomposition of the sample covariance of the data is equivalent to the singular value decomposition of the scaled and detrended data <span class="math inline">\(\mathbf{y}\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\tilde{\mathbf{y}} &amp; \equiv \frac{1}{\sqrt{T - 1}} \left( \right)
\end{align*}\]</span></p>
<p>To get a spatial EOF, we need to transform the data into space-wide format</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="day-20.html#cb712-1"></a>y &lt;-<span class="st"> </span><span class="kw">t</span>(SSTdata)</span>
<span id="cb712-2"><a href="day-20.html#cb712-2"></a><span class="kw">dim</span>(y)</span></code></pre></div>
<pre><code>## [1]  396 2261</code></pre>
<p>To use the equation above, we need to calculate the spatial mean and the number of spatial replicates and scale and detrend the data</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="day-20.html#cb714-1"></a>spatial_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(SSTdata, <span class="dv">1</span>, mean)</span>
<span id="cb714-2"><a href="day-20.html#cb714-2"></a>nT &lt;-<span class="st"> </span><span class="kw">ncol</span>(SSTdata)</span>
<span id="cb714-3"><a href="day-20.html#cb714-3"></a>y_tilde &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(nT <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(y <span class="op">-</span><span class="st"> </span><span class="kw">outer</span>(<span class="kw">rep</span>(<span class="dv">1</span>, nT), spatial_mean))</span></code></pre></div>
<p>We carry out the SVD on this scaled and detrended data</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="day-20.html#cb715-1"></a>svd_y &lt;-<span class="st"> </span><span class="kw">svd</span>(y_tilde)</span></code></pre></div>
<p>which returns a list with three elements <span class="math inline">\(\mathbf{U}\)</span> <span class="math inline">\(\mathbf{D}\)</span> <span class="math inline">\(\mathbf{V}\)</span></p>
<p><span class="math display">\[\begin{align*}
\tilde{\mathbf{y}} &amp; = \mathbf{U} \mathbf{D} \mathbf{V}
\end{align*}\]</span></p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="day-20.html#cb716-1"></a>V &lt;-<span class="st"> </span>svd_y<span class="op">$</span>v</span>
<span id="cb716-2"><a href="day-20.html#cb716-2"></a><span class="kw">colnames</span>(V) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;EOF&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(SSTdata))</span>
<span id="cb716-3"><a href="day-20.html#cb716-3"></a>EOFs &lt;-<span class="st"> </span><span class="kw">cbind</span>(SSTlonlat[ <span class="op">-</span><span class="st"> </span>delete_rows, ], V)</span>
<span id="cb716-4"><a href="day-20.html#cb716-4"></a><span class="kw">glimpse</span>(EOFs[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, ])</span></code></pre></div>
<pre><code>## Rows: 2,261
## Columns: 6
## $ lon  &lt;dbl&gt; 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, …
## $ lat  &lt;dbl&gt; -29, -29, -29, -29, -29, -29, -29, -29, -29, -29, -29, -29, -29, …
## $ EOF1 &lt;dbl&gt; -0.004915064, -0.001412275, 0.000245909, 0.001454972, 0.002265778…
## $ EOF2 &lt;dbl&gt; -1.212957e-02, -2.276177e-03, 2.298082e-03, 2.303585e-03, 1.64313…
## $ EOF3 &lt;dbl&gt; -0.02882162, -0.02552841, -0.01933020, -0.01905901, -0.02251571, …
## $ EOF4 &lt;dbl&gt; 8.540892e-05, 6.726077e-03, 8.591251e-03, 1.025538e-02, 1.125295e…</code></pre>
<p>Plot the EOFs</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="day-20.html#cb718-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> EOFs, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> EOF1)) <span class="op">+</span></span>
<span id="cb718-2"><a href="day-20.html#cb718-2"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb718-3"><a href="day-20.html#cb718-3"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="op">+</span></span>
<span id="cb718-4"><a href="day-20.html#cb718-4"></a><span class="st">    </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="fl">1.3</span>) <span class="op">+</span></span>
<span id="cb718-5"><a href="day-20.html#cb718-5"></a><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb718-6"><a href="day-20.html#cb718-6"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Longitude (deg)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb718-7"><a href="day-20.html#cb718-7"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Latitude (deg)&quot;</span>) <span class="op">+</span></span>
<span id="cb718-8"><a href="day-20.html#cb718-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;First EOF&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="day-20.html#cb719-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> EOFs, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> EOF2)) <span class="op">+</span></span>
<span id="cb719-2"><a href="day-20.html#cb719-2"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb719-3"><a href="day-20.html#cb719-3"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="op">+</span></span>
<span id="cb719-4"><a href="day-20.html#cb719-4"></a><span class="st">    </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="fl">1.3</span>) <span class="op">+</span></span>
<span id="cb719-5"><a href="day-20.html#cb719-5"></a><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb719-6"><a href="day-20.html#cb719-6"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Longitude (deg)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb719-7"><a href="day-20.html#cb719-7"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Latitude (deg)&quot;</span>) <span class="op">+</span></span>
<span id="cb719-8"><a href="day-20.html#cb719-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Second EOF&quot;</span>)</span></code></pre></div>
<ul>
<li>Let’s assume I have data for January 1970.</li>
</ul>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="day-20.html#cb720-1"></a>dat &lt;-<span class="st"> </span>SST_df <span class="op">%&gt;%</span></span>
<span id="cb720-2"><a href="day-20.html#cb720-2"></a><span class="st">    </span><span class="kw">subset</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1970</span> <span class="op">&amp;</span><span class="st"> </span>Month <span class="op">==</span><span class="st"> &quot;Jan&quot;</span>)</span>
<span id="cb720-3"><a href="day-20.html#cb720-3"></a>EOFs<span class="op">$</span>y &lt;-<span class="st"> </span>dat<span class="op">$</span>sst[ <span class="op">-</span><span class="st"> </span>delete_rows]</span></code></pre></div>
<p>Model the data using the first few EOFs as basis functions</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="day-20.html#cb721-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>EOF1, <span class="dt">data =</span> EOFs)</span>
<span id="cb721-2"><a href="day-20.html#cb721-2"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ EOF1, data = EOFs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.04426 -0.27708  0.06354  0.32827  1.07502 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.28238    0.01106   25.53   &lt;2e-16 ***
## EOF1        -7.98942    0.52592  -15.19   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4545 on 2259 degrees of freedom
## Multiple R-squared:  0.09269,    Adjusted R-squared:  0.09229 
## F-statistic: 230.8 on 1 and 2259 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="day-20.html#cb723-1"></a><span class="kw">plot</span>(EOFs<span class="op">$</span>y, <span class="kw">predict</span>(mod), <span class="dt">main =</span> <span class="st">&quot;Fitted vs. Predicted&quot;</span>)</span>
<span id="cb723-2"><a href="day-20.html#cb723-2"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="day-20.html#cb724-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>EOF1 <span class="op">+</span><span class="st"> </span>EOF2 <span class="op">+</span><span class="st"> </span>EOF3 <span class="op">+</span><span class="st"> </span>EOF4 <span class="op">+</span><span class="st"> </span>EOF5, <span class="dt">data =</span> EOFs)</span>
<span id="cb724-2"><a href="day-20.html#cb724-2"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ EOF1 + EOF2 + EOF3 + EOF4 + EOF5, data = EOFs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.67754 -0.21413  0.00333  0.23298  0.88277 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.20949    0.02166  -9.673   &lt;2e-16 ***
## EOF1        -19.75559    0.62317 -31.702   &lt;2e-16 ***
## EOF2        -12.34214    0.61654 -20.018   &lt;2e-16 ***
## EOF3        -11.82360    0.67202 -17.594   &lt;2e-16 ***
## EOF4         11.33128    0.36951  30.666   &lt;2e-16 ***
## EOF5         13.57274    0.42853  31.673   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3463 on 2255 degrees of freedom
## Multiple R-squared:  0.4741, Adjusted R-squared:  0.4729 
## F-statistic: 406.6 on 5 and 2255 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="day-20.html#cb726-1"></a><span class="kw">plot</span>(EOFs<span class="op">$</span>y, <span class="kw">predict</span>(mod), <span class="dt">main =</span> <span class="st">&quot;Fitted vs. Predicted&quot;</span>)</span>
<span id="cb726-2"><a href="day-20.html#cb726-2"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="day-20.html#cb727-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>EOF1 <span class="op">+</span><span class="st"> </span>EOF2 <span class="op">+</span><span class="st"> </span>EOF3 <span class="op">+</span><span class="st"> </span>EOF4 <span class="op">+</span><span class="st"> </span>EOF5 <span class="op">+</span><span class="st"> </span></span>
<span id="cb727-2"><a href="day-20.html#cb727-2"></a><span class="st">              </span>EOF6 <span class="op">+</span><span class="st"> </span>EOF7 <span class="op">+</span><span class="st"> </span>EOF8 <span class="op">+</span><span class="st"> </span>EOF9 <span class="op">+</span><span class="st"> </span>EOF10, <span class="dt">data =</span> EOFs)</span>
<span id="cb727-3"><a href="day-20.html#cb727-3"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ EOF1 + EOF2 + EOF3 + EOF4 + EOF5 + EOF6 + EOF7 + 
##     EOF8 + EOF9 + EOF10, data = EOFs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.50504 -0.20972  0.00895  0.22751  0.96819 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.23303    0.02293 -10.164  &lt; 2e-16 ***
## EOF1        -20.31876    0.63979 -31.759  &lt; 2e-16 ***
## EOF2        -12.89662    0.63255 -20.388  &lt; 2e-16 ***
## EOF3        -12.44963    0.69299 -17.965  &lt; 2e-16 ***
## EOF4         11.47126    0.35653  32.175  &lt; 2e-16 ***
## EOF5         13.84706    0.42414  32.647  &lt; 2e-16 ***
## EOF6         -4.10984    0.33493 -12.271  &lt; 2e-16 ***
## EOF7          1.52329    0.32944   4.624 3.98e-06 ***
## EOF8         -2.59078    0.35383  -7.322 3.38e-13 ***
## EOF9          0.43296    0.33083   1.309    0.191    
## EOF10         0.58359    0.33645   1.735    0.083 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3294 on 2250 degrees of freedom
## Multiple R-squared:  0.5253, Adjusted R-squared:  0.5232 
## F-statistic: 248.9 on 10 and 2250 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="day-20.html#cb729-1"></a><span class="kw">plot</span>(EOFs<span class="op">$</span>y, <span class="kw">predict</span>(mod), <span class="dt">main =</span> <span class="st">&quot;Fitted vs. Predicted&quot;</span>)</span>
<span id="cb729-2"><a href="day-20.html#cb729-2"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="day-20.html#cb730-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>EOF1 <span class="op">+</span><span class="st"> </span>EOF2 <span class="op">+</span><span class="st"> </span>EOF3 <span class="op">+</span><span class="st"> </span>EOF4 <span class="op">+</span><span class="st"> </span>EOF5 <span class="op">+</span><span class="st"> </span></span>
<span id="cb730-2"><a href="day-20.html#cb730-2"></a><span class="st">              </span>EOF6 <span class="op">+</span><span class="st"> </span>EOF7 <span class="op">+</span><span class="st"> </span>EOF8 <span class="op">+</span><span class="st"> </span>EOF9 <span class="op">+</span><span class="st"> </span>EOF10 <span class="op">+</span></span>
<span id="cb730-3"><a href="day-20.html#cb730-3"></a><span class="st">              </span>EOF11 <span class="op">+</span><span class="st"> </span>EOF12 <span class="op">+</span><span class="st"> </span>EOF13 <span class="op">+</span><span class="st"> </span>EOF14 <span class="op">+</span><span class="st"> </span>EOF15 <span class="op">+</span><span class="st"> </span></span>
<span id="cb730-4"><a href="day-20.html#cb730-4"></a><span class="st">              </span>EOF16 <span class="op">+</span><span class="st"> </span>EOF17 <span class="op">+</span><span class="st"> </span>EOF18 <span class="op">+</span><span class="st"> </span>EOF19 <span class="op">+</span><span class="st"> </span>EOF20, <span class="dt">data =</span> EOFs)</span>
<span id="cb730-5"><a href="day-20.html#cb730-5"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ EOF1 + EOF2 + EOF3 + EOF4 + EOF5 + EOF6 + EOF7 + 
##     EOF8 + EOF9 + EOF10 + EOF11 + EOF12 + EOF13 + EOF14 + EOF15 + 
##     EOF16 + EOF17 + EOF18 + EOF19 + EOF20, data = EOFs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.97597 -0.15091  0.01253  0.16319  0.64190 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.16939    0.02276  -7.442 1.40e-13 ***
## EOF1        -18.79654    0.59554 -31.562  &lt; 2e-16 ***
## EOF2        -11.39789    0.58787 -19.389  &lt; 2e-16 ***
## EOF3        -10.75749    0.65158 -16.510  &lt; 2e-16 ***
## EOF4         11.09291    0.27661  40.103  &lt; 2e-16 ***
## EOF5         13.10558    0.35853  36.554  &lt; 2e-16 ***
## EOF6         -4.27748    0.24858 -17.208  &lt; 2e-16 ***
## EOF7          1.52556    0.24124   6.324 3.07e-10 ***
## EOF8         -2.23244    0.27318  -8.172 5.01e-16 ***
## EOF9          0.34871    0.24312   1.434   0.1516    
## EOF10         0.39386    0.25060   1.572   0.1162    
## EOF11        -0.45291    0.24187  -1.873   0.0613 .  
## EOF12        -1.68052    0.24169  -6.953 4.66e-12 ***
## EOF13         1.48991    0.24124   6.176 7.78e-10 ***
## EOF14        -1.27051    0.24415  -5.204 2.13e-07 ***
## EOF15        -1.94992    0.24216  -8.052 1.31e-15 ***
## EOF16         3.83311    0.29754  12.883  &lt; 2e-16 ***
## EOF17        -3.70161    0.24697 -14.988  &lt; 2e-16 ***
## EOF18         3.70714    0.25973  14.273  &lt; 2e-16 ***
## EOF19        -5.54106    0.24200 -22.897  &lt; 2e-16 ***
## EOF20         5.58156    0.24867  22.446  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2412 on 2240 degrees of freedom
## Multiple R-squared:  0.7466, Adjusted R-squared:  0.7443 
## F-statistic: 329.9 on 20 and 2240 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="day-20.html#cb732-1"></a><span class="kw">plot</span>(EOFs<span class="op">$</span>y, <span class="kw">predict</span>(mod), <span class="dt">main =</span> <span class="st">&quot;Fitted vs. Predicted&quot;</span>)</span>
<span id="cb732-2"><a href="day-20.html#cb732-2"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<ul>
<li><p>Disadvantages</p>
<ul>
<li>Calculation of the SVD scales with <span class="math inline">\(O(n^3)\)</span></li>
<li>Each of the EOFs are global (almost always nonzero)</li>
</ul></li>
</ul>
</div>
<div id="spatial-modeling-with-mgcv-package" class="section level2">
<h2><span class="header-section-number">20.7</span> Spatial modeling with <code>mgcv</code> package</h2>
<p>Use the same temperature data</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="day-20.html#cb733-1"></a><span class="kw">data</span>(<span class="st">&quot;NOAA_df_1990&quot;</span>)</span>
<span id="cb733-2"><a href="day-20.html#cb733-2"></a><span class="co">## add a factor variable for left_join</span></span>
<span id="cb733-3"><a href="day-20.html#cb733-3"></a>NOAA_df_<span class="dv">1990</span><span class="op">$</span>id_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(NOAA_df_<span class="dv">1990</span><span class="op">$</span>id)</span>
<span id="cb733-4"><a href="day-20.html#cb733-4"></a>dat &lt;-<span class="st"> </span>NOAA_df_<span class="dv">1990</span> <span class="op">%&gt;%</span></span>
<span id="cb733-5"><a href="day-20.html#cb733-5"></a><span class="st">    </span><span class="kw">subset</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1990</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>proc <span class="op">==</span><span class="st"> &quot;Tmax&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb733-6"><a href="day-20.html#cb733-6"></a><span class="st">    </span><span class="kw">group_by</span>(id_factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb733-7"><a href="day-20.html#cb733-7"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_Tmax =</span> <span class="kw">mean</span>(z)) <span class="co">#</span></span>
<span id="cb733-8"><a href="day-20.html#cb733-8"></a></span>
<span id="cb733-9"><a href="day-20.html#cb733-9"></a><span class="co">## add back in the lat/lon variables</span></span>
<span id="cb733-10"><a href="day-20.html#cb733-10"></a>dat &lt;-<span class="st"> </span>NOAA_df_<span class="dv">1990</span> <span class="op">%&gt;%</span></span>
<span id="cb733-11"><a href="day-20.html#cb733-11"></a><span class="st">    </span><span class="kw">subset</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1990</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>proc <span class="op">==</span><span class="st"> &quot;Tmax&quot;</span> <span class="op">&amp;</span><span class="st"> </span>day <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb733-12"><a href="day-20.html#cb733-12"></a><span class="st">    </span><span class="kw">left_join</span>(dat, <span class="dt">by =</span> <span class="st">&quot;id_factor&quot;</span>) </span>
<span id="cb733-13"><a href="day-20.html#cb733-13"></a></span>
<span id="cb733-14"><a href="day-20.html#cb733-14"></a>fit &lt;-<span class="st"> </span><span class="kw">gam</span>(z <span class="op">~</span><span class="st"> </span>lon <span class="op">+</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(lon, lat, <span class="dt">bs =</span> <span class="st">&quot;tp&quot;</span>, <span class="dt">k =</span> <span class="dv">30</span>), <span class="dt">data =</span> dat)</span>
<span id="cb733-15"><a href="day-20.html#cb733-15"></a><span class="co"># tensor product of a 2-d thin plate regression spline and 1-d cr spline  </span></span></code></pre></div>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="day-20.html#cb734-1"></a><span class="co">## explore model residuals</span></span>
<span id="cb734-2"><a href="day-20.html#cb734-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb734-3"><a href="day-20.html#cb734-3"></a><span class="kw">gam.check</span>(fit)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre><code>## 
## Method: GCV   Optimizer: magic
## Smoothing parameter selection converged after 5 iterations.
## The RMS GCV score gradient at convergence was 0.0005041193 .
## The Hessian was positive definite.
## Model rank =  30 / 32 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##            k&#39; edf k-index p-value
## s(lon,lat) 29  24    0.97     0.3</code></pre>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="day-20.html#cb736-1"></a><span class="co"># not sure why this isn&#39;t working on the website</span></span>
<span id="cb736-2"><a href="day-20.html#cb736-2"></a></span>
<span id="cb736-3"><a href="day-20.html#cb736-3"></a><span class="co">## generate model predictions</span></span>
<span id="cb736-4"><a href="day-20.html#cb736-4"></a>pred_coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb736-5"><a href="day-20.html#cb736-5"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb736-6"><a href="day-20.html#cb736-6"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb736-7"><a href="day-20.html#cb736-7"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb736-8"><a href="day-20.html#cb736-8"></a>    )</span>
<span id="cb736-9"><a href="day-20.html#cb736-9"></a>)</span>
<span id="cb736-10"><a href="day-20.html#cb736-10"></a><span class="kw">colnames</span>(pred_coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb736-11"><a href="day-20.html#cb736-11"></a></span>
<span id="cb736-12"><a href="day-20.html#cb736-12"></a>preds &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata =</span> pred_coords, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</span>
<span id="cb736-13"><a href="day-20.html#cb736-13"></a>pred_coords<span class="op">$</span>pred_mean &lt;-<span class="st"> </span>preds<span class="op">$</span>fit</span>
<span id="cb736-14"><a href="day-20.html#cb736-14"></a>pred_coords<span class="op">$</span>pred_var &lt;-<span class="st"> </span>preds<span class="op">$</span>se.fit<span class="op">^</span><span class="dv">2</span></span>
<span id="cb736-15"><a href="day-20.html#cb736-15"></a></span>
<span id="cb736-16"><a href="day-20.html#cb736-16"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_coords, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_mean)) <span class="op">+</span></span>
<span id="cb736-17"><a href="day-20.html#cb736-17"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb736-18"><a href="day-20.html#cb736-18"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb736-19"><a href="day-20.html#cb736-19"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb736-20"><a href="day-20.html#cb736-20"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb736-21"><a href="day-20.html#cb736-21"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Predicted Average July max Temperature in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb736-22"><a href="day-20.html#cb736-22"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span>
<span id="cb736-23"><a href="day-20.html#cb736-23"></a></span>
<span id="cb736-24"><a href="day-20.html#cb736-24"></a></span>
<span id="cb736-25"><a href="day-20.html#cb736-25"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_coords, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_var)) <span class="op">+</span></span>
<span id="cb736-26"><a href="day-20.html#cb736-26"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb736-27"><a href="day-20.html#cb736-27"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb736-28"><a href="day-20.html#cb736-28"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb736-29"><a href="day-20.html#cb736-29"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb736-30"><a href="day-20.html#cb736-30"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average July max Temperature prediction variance in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb736-31"><a href="day-20.html#cb736-31"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span></code></pre></div>
</div>
<div id="spatial-modeling-with-kernels" class="section level2">
<h2><span class="header-section-number">20.8</span> Spatial modeling with Kernels</h2>
<ul>
<li><p>Kernel functions can be either local or global</p>
<ul>
<li>Gaussian, exponential kernels are global</li>
<li>Truncated Gaussian and truncated exponential are local</li>
</ul></li>
<li><p>Kernel functions require specifying a kernel shape, a “bandwith”, and the number of “knots”.</p></li>
</ul>
<p>Use the same temperature data with Gaussian Kernels</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="day-20.html#cb737-1"></a><span class="kw">data</span>(<span class="st">&quot;NOAA_df_1990&quot;</span>)</span>
<span id="cb737-2"><a href="day-20.html#cb737-2"></a><span class="co">## add a factor variable for left_join</span></span>
<span id="cb737-3"><a href="day-20.html#cb737-3"></a>NOAA_df_<span class="dv">1990</span><span class="op">$</span>id_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(NOAA_df_<span class="dv">1990</span><span class="op">$</span>id)</span>
<span id="cb737-4"><a href="day-20.html#cb737-4"></a>dat &lt;-<span class="st"> </span>NOAA_df_<span class="dv">1990</span> <span class="op">%&gt;%</span></span>
<span id="cb737-5"><a href="day-20.html#cb737-5"></a><span class="st">    </span><span class="kw">subset</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1990</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>proc <span class="op">==</span><span class="st"> &quot;Tmax&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb737-6"><a href="day-20.html#cb737-6"></a><span class="st">    </span><span class="kw">group_by</span>(id_factor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb737-7"><a href="day-20.html#cb737-7"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_Tmax =</span> <span class="kw">mean</span>(z)) <span class="co">#</span></span>
<span id="cb737-8"><a href="day-20.html#cb737-8"></a></span>
<span id="cb737-9"><a href="day-20.html#cb737-9"></a><span class="co">## add back in the lat/lon variables</span></span>
<span id="cb737-10"><a href="day-20.html#cb737-10"></a>dat &lt;-<span class="st"> </span>NOAA_df_<span class="dv">1990</span> <span class="op">%&gt;%</span></span>
<span id="cb737-11"><a href="day-20.html#cb737-11"></a><span class="st">    </span><span class="kw">subset</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1990</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>proc <span class="op">==</span><span class="st"> &quot;Tmax&quot;</span> <span class="op">&amp;</span><span class="st"> </span>day <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb737-12"><a href="day-20.html#cb737-12"></a><span class="st">    </span><span class="kw">left_join</span>(dat, <span class="dt">by =</span> <span class="st">&quot;id_factor&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="day-20.html#cb738-1"></a><span class="co">## For simplicity, assume this is a square number</span></span>
<span id="cb738-2"><a href="day-20.html#cb738-2"></a>n_knots &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb738-3"><a href="day-20.html#cb738-3"></a>knots &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb738-4"><a href="day-20.html#cb738-4"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots)), </span>
<span id="cb738-5"><a href="day-20.html#cb738-5"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots))</span>
<span id="cb738-6"><a href="day-20.html#cb738-6"></a>)</span>
<span id="cb738-7"><a href="day-20.html#cb738-7"></a></span>
<span id="cb738-8"><a href="day-20.html#cb738-8"></a>make_kernel_basis &lt;-<span class="st"> </span><span class="cf">function</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> <span class="dv">1</span>, <span class="dt">threshold =</span> <span class="ot">NULL</span>) {</span>
<span id="cb738-9"><a href="day-20.html#cb738-9"></a>    <span class="cf">if</span> (<span class="op">!</span>(kernel <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;exponential&quot;</span>))) {</span>
<span id="cb738-10"><a href="day-20.html#cb738-10"></a>        <span class="kw">stop</span>(<span class="st">&quot;only kernels available are gaussian and exponential&quot;</span>)</span>
<span id="cb738-11"><a href="day-20.html#cb738-11"></a>    }</span>
<span id="cb738-12"><a href="day-20.html#cb738-12"></a>    D &lt;-<span class="st"> </span>fields<span class="op">::</span><span class="kw">rdist</span>(<span class="kw">as.matrix</span>(coords), <span class="kw">as.matrix</span>(knots))</span>
<span id="cb738-13"><a href="day-20.html#cb738-13"></a>    X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(D), <span class="kw">ncol</span>(D))</span>
<span id="cb738-14"><a href="day-20.html#cb738-14"></a>    <span class="cf">if</span> (kernel <span class="op">==</span><span class="st"> &quot;exponential&quot;</span>) {</span>
<span id="cb738-15"><a href="day-20.html#cb738-15"></a>        X &lt;-<span class="st"> </span><span class="kw">exp</span> (<span class="op">-</span><span class="st"> </span>D <span class="op">/</span><span class="st"> </span>bandwith)</span>
<span id="cb738-16"><a href="day-20.html#cb738-16"></a>    } <span class="cf">else</span> <span class="cf">if</span> (kernel <span class="op">==</span><span class="st"> &quot;gaussian&quot;</span>) {</span>
<span id="cb738-17"><a href="day-20.html#cb738-17"></a>        X &lt;-<span class="st"> </span><span class="kw">exp</span> (<span class="op">-</span><span class="st"> </span>D<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>bandwith)</span>
<span id="cb738-18"><a href="day-20.html#cb738-18"></a>    }</span>
<span id="cb738-19"><a href="day-20.html#cb738-19"></a>    </span>
<span id="cb738-20"><a href="day-20.html#cb738-20"></a>    <span class="co">## add in a minimum distance threshold</span></span>
<span id="cb738-21"><a href="day-20.html#cb738-21"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(threshold)) {</span>
<span id="cb738-22"><a href="day-20.html#cb738-22"></a>        X[D <span class="op">&gt;</span><span class="st"> </span>threshold] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb738-23"><a href="day-20.html#cb738-23"></a>    }</span>
<span id="cb738-24"><a href="day-20.html#cb738-24"></a></span>
<span id="cb738-25"><a href="day-20.html#cb738-25"></a>    <span class="kw">return</span>(X)</span>
<span id="cb738-26"><a href="day-20.html#cb738-26"></a>}</span></code></pre></div>
<p>We can plot the kernels over the domain of interest using the code below. Note that it is useful to change the bandwith parameter so that the kernel covers multiple other knots</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="day-20.html#cb739-1"></a><span class="co"># not sure why this isn&#39;t working on the website</span></span>
<span id="cb739-2"><a href="day-20.html#cb739-2"></a></span>
<span id="cb739-3"><a href="day-20.html#cb739-3"></a>coords &lt;-<span class="st"> </span><span class="kw">cbind</span>(dat<span class="op">$</span>lon, dat<span class="op">$</span>lat)</span>
<span id="cb739-4"><a href="day-20.html#cb739-4"></a>coords_plot &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb739-5"><a href="day-20.html#cb739-5"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb739-6"><a href="day-20.html#cb739-6"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb739-7"><a href="day-20.html#cb739-7"></a>)</span>
<span id="cb739-8"><a href="day-20.html#cb739-8"></a><span class="kw">colnames</span>(coords_plot) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb739-9"><a href="day-20.html#cb739-9"></a></span>
<span id="cb739-10"><a href="day-20.html#cb739-10"></a>X_plot &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords_plot, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> <span class="dv">20</span>)</span>
<span id="cb739-11"><a href="day-20.html#cb739-11"></a></span>
<span id="cb739-12"><a href="day-20.html#cb739-12"></a><span class="co">## plot the kernel basis</span></span>
<span id="cb739-13"><a href="day-20.html#cb739-13"></a>dat_plot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb739-14"><a href="day-20.html#cb739-14"></a>    <span class="dt">x     =</span> coords_plot[, <span class="dv">1</span>], </span>
<span id="cb739-15"><a href="day-20.html#cb739-15"></a>    <span class="dt">y     =</span> coords_plot[, <span class="dv">2</span>],</span>
<span id="cb739-16"><a href="day-20.html#cb739-16"></a>    <span class="dt">X     =</span> <span class="kw">c</span>(X_plot),</span>
<span id="cb739-17"><a href="day-20.html#cb739-17"></a>    <span class="dt">basis =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X_plot), <span class="dt">each =</span> <span class="kw">nrow</span>(coords_plot)))</span>
<span id="cb739-18"><a href="day-20.html#cb739-18"></a>)</span>
<span id="cb739-19"><a href="day-20.html#cb739-19"></a>dat_knots &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb739-20"><a href="day-20.html#cb739-20"></a>  <span class="dt">x =</span> knots[, <span class="dv">1</span>],</span>
<span id="cb739-21"><a href="day-20.html#cb739-21"></a>  <span class="dt">y =</span> knots[, <span class="dv">2</span>]</span>
<span id="cb739-22"><a href="day-20.html#cb739-22"></a>)</span>
<span id="cb739-23"><a href="day-20.html#cb739-23"></a></span>
<span id="cb739-24"><a href="day-20.html#cb739-24"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_plot, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> X)) <span class="op">+</span></span>
<span id="cb739-25"><a href="day-20.html#cb739-25"></a><span class="st">  </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb739-26"><a href="day-20.html#cb739-26"></a><span class="st">  </span><span class="co"># geom(aes(x = x, y = X_fourier, group = basis, color = basis)) +</span></span>
<span id="cb739-27"><a href="day-20.html#cb739-27"></a><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="op">+</span></span>
<span id="cb739-28"><a href="day-20.html#cb739-28"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb739-29"><a href="day-20.html#cb739-29"></a><span class="st">  </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>basis, <span class="dt">ncol =</span> <span class="kw">sqrt</span>(n_knots)) <span class="op">+</span></span>
<span id="cb739-30"><a href="day-20.html#cb739-30"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Kernel Basis&quot;</span>) <span class="op">+</span></span>
<span id="cb739-31"><a href="day-20.html#cb739-31"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dat_knots, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) </span></code></pre></div>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="day-20.html#cb740-1"></a><span class="co">## apply the kernel basis to the data</span></span>
<span id="cb740-2"><a href="day-20.html#cb740-2"></a>bw &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb740-3"><a href="day-20.html#cb740-3"></a>check_AICc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="kw">length</span>(bw)) </span>
<span id="cb740-4"><a href="day-20.html#cb740-4"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>) {</span>
<span id="cb740-5"><a href="day-20.html#cb740-5"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bw)) {</span>
<span id="cb740-6"><a href="day-20.html#cb740-6"></a>    n_knots &lt;-<span class="st"> </span>j<span class="op">^</span><span class="dv">2</span></span>
<span id="cb740-7"><a href="day-20.html#cb740-7"></a>    knots &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb740-8"><a href="day-20.html#cb740-8"></a>      <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots)), </span>
<span id="cb740-9"><a href="day-20.html#cb740-9"></a>      <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots))</span>
<span id="cb740-10"><a href="day-20.html#cb740-10"></a>    )</span>
<span id="cb740-11"><a href="day-20.html#cb740-11"></a>    X &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[k])</span>
<span id="cb740-12"><a href="day-20.html#cb740-12"></a>    <span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb740-13"><a href="day-20.html#cb740-13"></a>    X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X)</span>
<span id="cb740-14"><a href="day-20.html#cb740-14"></a>    fit &lt;-<span class="st"> </span><span class="kw">lm</span>(dat<span class="op">$</span>z <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> X)</span>
<span id="cb740-15"><a href="day-20.html#cb740-15"></a>    check_AICc[j, k] &lt;-<span class="st"> </span><span class="kw">AIC</span>(fit) <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(j<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(j<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(X) <span class="op">-</span><span class="st"> </span>j<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb740-16"><a href="day-20.html#cb740-16"></a>  }</span>
<span id="cb740-17"><a href="day-20.html#cb740-17"></a>}</span>
<span id="cb740-18"><a href="day-20.html#cb740-18"></a><span class="kw">matplot</span>(check_AICc, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="day-20.html#cb741-1"></a>best_idx &lt;-<span class="st"> </span><span class="kw">which</span>(check_AICc <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(check_AICc), <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)</span>
<span id="cb741-2"><a href="day-20.html#cb741-2"></a><span class="co">## the best fitting model has 5 knots and bandwidth 20</span></span>
<span id="cb741-3"><a href="day-20.html#cb741-3"></a>best_idx</span></code></pre></div>
<pre><code>##      row col
## [1,]   5   3</code></pre>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="day-20.html#cb743-1"></a>n_knots &lt;-<span class="st"> </span>best_idx[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb743-2"><a href="day-20.html#cb743-2"></a>knots &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb743-3"><a href="day-20.html#cb743-3"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots)), </span>
<span id="cb743-4"><a href="day-20.html#cb743-4"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots))</span>
<span id="cb743-5"><a href="day-20.html#cb743-5"></a>)</span>
<span id="cb743-6"><a href="day-20.html#cb743-6"></a>X &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]])</span>
<span id="cb743-7"><a href="day-20.html#cb743-7"></a><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb743-8"><a href="day-20.html#cb743-8"></a>X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X)</span>
<span id="cb743-9"><a href="day-20.html#cb743-9"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(dat<span class="op">$</span>z <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> X)</span></code></pre></div>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="day-20.html#cb744-1"></a><span class="co">## generate model predictions</span></span>
<span id="cb744-2"><a href="day-20.html#cb744-2"></a>pred_coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb744-3"><a href="day-20.html#cb744-3"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb744-4"><a href="day-20.html#cb744-4"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb744-5"><a href="day-20.html#cb744-5"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb744-6"><a href="day-20.html#cb744-6"></a>    )</span>
<span id="cb744-7"><a href="day-20.html#cb744-7"></a>)</span>
<span id="cb744-8"><a href="day-20.html#cb744-8"></a><span class="kw">colnames</span>(pred_coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb744-9"><a href="day-20.html#cb744-9"></a>X_pred &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(pred_coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]])</span>
<span id="cb744-10"><a href="day-20.html#cb744-10"></a><span class="kw">colnames</span>(X_pred) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb744-11"><a href="day-20.html#cb744-11"></a>X_pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X_pred)</span>
<span id="cb744-12"><a href="day-20.html#cb744-12"></a></span>
<span id="cb744-13"><a href="day-20.html#cb744-13"></a>preds &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata =</span> X_pred, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</span>
<span id="cb744-14"><a href="day-20.html#cb744-14"></a></span>
<span id="cb744-15"><a href="day-20.html#cb744-15"></a>dat_pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb744-16"><a href="day-20.html#cb744-16"></a>  <span class="dt">lon       =</span> pred_coords<span class="op">$</span>lon,</span>
<span id="cb744-17"><a href="day-20.html#cb744-17"></a>  <span class="dt">lat       =</span> pred_coords<span class="op">$</span>lat,</span>
<span id="cb744-18"><a href="day-20.html#cb744-18"></a>  <span class="co">## prediction mean</span></span>
<span id="cb744-19"><a href="day-20.html#cb744-19"></a>  <span class="dt">pred_mean =</span> preds<span class="op">$</span>fit,</span>
<span id="cb744-20"><a href="day-20.html#cb744-20"></a>  <span class="co">## prediction variance</span></span>
<span id="cb744-21"><a href="day-20.html#cb744-21"></a>  <span class="dt">pred_var  =</span> preds<span class="op">$</span>se.fit<span class="op">^</span><span class="dv">2</span></span>
<span id="cb744-22"><a href="day-20.html#cb744-22"></a>)</span>
<span id="cb744-23"><a href="day-20.html#cb744-23"></a></span>
<span id="cb744-24"><a href="day-20.html#cb744-24"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_pred, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_mean)) <span class="op">+</span></span>
<span id="cb744-25"><a href="day-20.html#cb744-25"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb744-26"><a href="day-20.html#cb744-26"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb744-27"><a href="day-20.html#cb744-27"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb744-28"><a href="day-20.html#cb744-28"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb744-29"><a href="day-20.html#cb744-29"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Predicted Average July max Temperature in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb744-30"><a href="day-20.html#cb744-30"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span>
<span id="cb744-31"><a href="day-20.html#cb744-31"></a></span>
<span id="cb744-32"><a href="day-20.html#cb744-32"></a></span>
<span id="cb744-33"><a href="day-20.html#cb744-33"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_pred, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_var)) <span class="op">+</span></span>
<span id="cb744-34"><a href="day-20.html#cb744-34"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb744-35"><a href="day-20.html#cb744-35"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb744-36"><a href="day-20.html#cb744-36"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb744-37"><a href="day-20.html#cb744-37"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb744-38"><a href="day-20.html#cb744-38"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average July max Temperature prediction variance in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb744-39"><a href="day-20.html#cb744-39"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p>Notice that the above model is overfit – see the large variance surface. This can be resolved with penalized models (ridge, lasso, elastic net, etc). Many basis-function models show “edge effects” in the model fit. This is because at the edges of the domain there are one or two basis functions that see little data and therefore have high variability in the estimate. One can either add duplicate knots or extend the spatial domain of the knots and add a penalty term to the fit.</p>
<div id="kernel-regression-with-a-ridge-penalty" class="section level3">
<h3><span class="header-section-number">20.8.1</span> Kernel regression with a ridge penalty</h3>
<ul>
<li>Note: glmnet doesn’t have a theoretically-motivated method for calculating prediction standard errors</li>
</ul>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="day-20.html#cb745-1"></a><span class="co">## set alpha = 0 for ridge regression</span></span>
<span id="cb745-2"><a href="day-20.html#cb745-2"></a>X &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]])</span>
<span id="cb745-3"><a href="day-20.html#cb745-3"></a><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb745-4"><a href="day-20.html#cb745-4"></a>X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X)</span>
<span id="cb745-5"><a href="day-20.html#cb745-5"></a></span>
<span id="cb745-6"><a href="day-20.html#cb745-6"></a>cv_fit &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="kw">as.matrix</span>(X), dat<span class="op">$</span>z, <span class="dt">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb745-7"><a href="day-20.html#cb745-7"></a>fit &lt;-<span class="st"> </span><span class="kw">glmnet</span>(<span class="kw">as.matrix</span>(X), dat<span class="op">$</span>z, <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">lambda =</span> cv_fit<span class="op">$</span>lambda.min)</span>
<span id="cb745-8"><a href="day-20.html#cb745-8"></a></span>
<span id="cb745-9"><a href="day-20.html#cb745-9"></a><span class="co">## generate model predictions</span></span>
<span id="cb745-10"><a href="day-20.html#cb745-10"></a>pred_coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb745-11"><a href="day-20.html#cb745-11"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb745-12"><a href="day-20.html#cb745-12"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb745-13"><a href="day-20.html#cb745-13"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb745-14"><a href="day-20.html#cb745-14"></a>    )</span>
<span id="cb745-15"><a href="day-20.html#cb745-15"></a>)</span>
<span id="cb745-16"><a href="day-20.html#cb745-16"></a><span class="kw">colnames</span>(pred_coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb745-17"><a href="day-20.html#cb745-17"></a></span>
<span id="cb745-18"><a href="day-20.html#cb745-18"></a>X_pred &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(pred_coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]])</span>
<span id="cb745-19"><a href="day-20.html#cb745-19"></a><span class="kw">colnames</span>(X_pred) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb745-20"><a href="day-20.html#cb745-20"></a>X_pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X_pred)</span>
<span id="cb745-21"><a href="day-20.html#cb745-21"></a></span>
<span id="cb745-22"><a href="day-20.html#cb745-22"></a>preds &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newx =</span> <span class="kw">as.matrix</span>(X_pred))</span></code></pre></div>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="day-20.html#cb746-1"></a>dat_pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb746-2"><a href="day-20.html#cb746-2"></a>  <span class="dt">lon       =</span> pred_coords<span class="op">$</span>lon,</span>
<span id="cb746-3"><a href="day-20.html#cb746-3"></a>  <span class="dt">lat       =</span> pred_coords<span class="op">$</span>lat,</span>
<span id="cb746-4"><a href="day-20.html#cb746-4"></a>  <span class="dt">pred_mean =</span> <span class="kw">c</span>(preds)</span>
<span id="cb746-5"><a href="day-20.html#cb746-5"></a>)</span>
<span id="cb746-6"><a href="day-20.html#cb746-6"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_pred, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_mean)) <span class="op">+</span></span>
<span id="cb746-7"><a href="day-20.html#cb746-7"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb746-8"><a href="day-20.html#cb746-8"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb746-9"><a href="day-20.html#cb746-9"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb746-10"><a href="day-20.html#cb746-10"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb746-11"><a href="day-20.html#cb746-11"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Predicted Average July max Temperature in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb746-12"><a href="day-20.html#cb746-12"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span></code></pre></div>
</div>
<div id="kernel-regression-with-a-lasso-penalty" class="section level3">
<h3><span class="header-section-number">20.8.2</span> Kernel regression with a lasso penalty</h3>
<ul>
<li>Note: glmnet doesn’t have a theoretically-motivated method for calculating prediction standard errors</li>
</ul>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="day-20.html#cb747-1"></a><span class="co">## set alpha = 1 for ridge regression</span></span>
<span id="cb747-2"><a href="day-20.html#cb747-2"></a>X &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]])</span>
<span id="cb747-3"><a href="day-20.html#cb747-3"></a><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb747-4"><a href="day-20.html#cb747-4"></a>X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X)</span>
<span id="cb747-5"><a href="day-20.html#cb747-5"></a></span>
<span id="cb747-6"><a href="day-20.html#cb747-6"></a>cv_fit &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="kw">as.matrix</span>(X), dat<span class="op">$</span>z, <span class="dt">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb747-7"><a href="day-20.html#cb747-7"></a>fit &lt;-<span class="st"> </span><span class="kw">glmnet</span>(<span class="kw">as.matrix</span>(X), dat<span class="op">$</span>z, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">lambda =</span> cv_fit<span class="op">$</span>lambda.min)</span>
<span id="cb747-8"><a href="day-20.html#cb747-8"></a></span>
<span id="cb747-9"><a href="day-20.html#cb747-9"></a><span class="co">## generate model predictions</span></span>
<span id="cb747-10"><a href="day-20.html#cb747-10"></a>pred_coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb747-11"><a href="day-20.html#cb747-11"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb747-12"><a href="day-20.html#cb747-12"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">100</span>), </span>
<span id="cb747-13"><a href="day-20.html#cb747-13"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb747-14"><a href="day-20.html#cb747-14"></a>    )</span>
<span id="cb747-15"><a href="day-20.html#cb747-15"></a>)</span>
<span id="cb747-16"><a href="day-20.html#cb747-16"></a><span class="kw">colnames</span>(pred_coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb747-17"><a href="day-20.html#cb747-17"></a></span>
<span id="cb747-18"><a href="day-20.html#cb747-18"></a>X_pred &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(pred_coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]])</span>
<span id="cb747-19"><a href="day-20.html#cb747-19"></a><span class="kw">colnames</span>(X_pred) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb747-20"><a href="day-20.html#cb747-20"></a>X_pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X_pred)</span>
<span id="cb747-21"><a href="day-20.html#cb747-21"></a></span>
<span id="cb747-22"><a href="day-20.html#cb747-22"></a>preds &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newx =</span> <span class="kw">as.matrix</span>(X_pred))</span></code></pre></div>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="day-20.html#cb748-1"></a>dat_pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb748-2"><a href="day-20.html#cb748-2"></a>  <span class="dt">lon       =</span> pred_coords<span class="op">$</span>lon,</span>
<span id="cb748-3"><a href="day-20.html#cb748-3"></a>  <span class="dt">lat       =</span> pred_coords<span class="op">$</span>lat,</span>
<span id="cb748-4"><a href="day-20.html#cb748-4"></a>  <span class="dt">pred_mean =</span> <span class="kw">c</span>(preds)</span>
<span id="cb748-5"><a href="day-20.html#cb748-5"></a>)</span>
<span id="cb748-6"><a href="day-20.html#cb748-6"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_pred, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> pred_mean)) <span class="op">+</span></span>
<span id="cb748-7"><a href="day-20.html#cb748-7"></a><span class="st">    </span><span class="kw">geom_raster</span>() <span class="op">+</span></span>
<span id="cb748-8"><a href="day-20.html#cb748-8"></a><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> states, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb748-9"><a href="day-20.html#cb748-9"></a>                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb748-10"><a href="day-20.html#cb748-10"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb748-11"><a href="day-20.html#cb748-11"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Predicted Average July max Temperature in 1990&quot;</span>)  <span class="op">+</span></span>
<span id="cb748-12"><a href="day-20.html#cb748-12"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lon), <span class="dt">ylim =</span> <span class="kw">range</span>(dat<span class="op">$</span>lat), <span class="dt">ratio =</span> <span class="fl">1.3</span>)</span></code></pre></div>
</div>
<div id="truncated-kernels---local-support" class="section level3">
<h3><span class="header-section-number">20.8.3</span> Truncated Kernels - local support</h3>
<p>The kernels constructed above are globally supported (dense)</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="day-20.html#cb749-1"></a><span class="kw">mean</span>(X_pred <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li>Can use traditional kernels and truncate using a threshold</li>
</ul>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="day-20.html#cb751-1"></a>X_threshold &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(pred_coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb751-2"><a href="day-20.html#cb751-2"></a>                                 <span class="dt">bandwith =</span> bw[best_idx[<span class="dv">2</span>]], <span class="dt">threshold =</span> <span class="dv">10</span>)</span>
<span id="cb751-3"><a href="day-20.html#cb751-3"></a><span class="kw">mean</span>(X_threshold <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.47296</code></pre>
<p>Can use other functions as a kernel:
- Wendland basis</p>
<p><span class="math display">\[\begin{align*}
\frac{(1 - d)^6 (35 d^2 + 18d + 3)}{3} I\{d &lt; 1\}
\end{align*}\]</span></p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="day-20.html#cb753-1"></a>wendland_basis &lt;-<span class="st"> </span><span class="cf">function</span>(d, radius) {</span>
<span id="cb753-2"><a href="day-20.html#cb753-2"></a>    <span class="cf">if</span> (<span class="kw">any</span>(d <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb753-3"><a href="day-20.html#cb753-3"></a>        <span class="kw">stop</span>(<span class="st">&quot;d must be nonnegative&quot;</span>)</span>
<span id="cb753-4"><a href="day-20.html#cb753-4"></a>    }</span>
<span id="cb753-5"><a href="day-20.html#cb753-5"></a>    d &lt;-<span class="st"> </span>d <span class="op">/</span><span class="st"> </span>radius</span>
<span id="cb753-6"><a href="day-20.html#cb753-6"></a>    <span class="kw">return</span>(((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>d)<span class="op">^</span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">35</span> <span class="op">*</span><span class="st"> </span>d<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">18</span> <span class="op">*</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>(d <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb753-7"><a href="day-20.html#cb753-7"></a>}</span>
<span id="cb753-8"><a href="day-20.html#cb753-8"></a></span>
<span id="cb753-9"><a href="day-20.html#cb753-9"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</span>
<span id="cb753-10"><a href="day-20.html#cb753-10"></a><span class="kw">curve</span>(<span class="kw">wendland_basis</span>(<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>), <span class="dt">radius =</span> <span class="fl">0.15</span>), <span class="dt">n =</span> <span class="dv">1000</span>)</span>
<span id="cb753-11"><a href="day-20.html#cb753-11"></a><span class="kw">curve</span>(<span class="kw">wendland_basis</span>(<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span><span class="fl">0.75</span>), <span class="dt">radius =</span> <span class="fl">0.15</span>), <span class="dt">n =</span> <span class="dv">1000</span>)</span>
<span id="cb753-12"><a href="day-20.html#cb753-12"></a><span class="kw">curve</span>(<span class="kw">wendland_basis</span>(<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>), <span class="dt">radius =</span> <span class="fl">0.5</span>), <span class="dt">n =</span> <span class="dv">1000</span>)</span>
<span id="cb753-13"><a href="day-20.html#cb753-13"></a><span class="kw">curve</span>(<span class="kw">wendland_basis</span>(<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span><span class="fl">0.75</span>), <span class="dt">radius =</span> <span class="fl">0.5</span>), <span class="dt">n =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
</div>
<div id="sparse-vs.-dense-matrix-computation" class="section level2">
<h2><span class="header-section-number">20.9</span> Sparse vs. Dense matrix computation</h2>
<ul>
<li><p>uses the <code>spam64</code> package</p></li>
<li><p>compute time of <span class="math inline">\(\mathbf{X}&#39; \mathbf{X}\)</span> for dense vs. sparse matrices</p></li>
</ul>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="day-20.html#cb754-1"></a>coords &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(</span>
<span id="cb754-2"><a href="day-20.html#cb754-2"></a>    <span class="kw">expand.grid</span>(</span>
<span id="cb754-3"><a href="day-20.html#cb754-3"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="dv">50</span>), </span>
<span id="cb754-4"><a href="day-20.html#cb754-4"></a>        <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="dv">50</span>)</span>
<span id="cb754-5"><a href="day-20.html#cb754-5"></a>    )</span>
<span id="cb754-6"><a href="day-20.html#cb754-6"></a>)</span>
<span id="cb754-7"><a href="day-20.html#cb754-7"></a><span class="kw">colnames</span>(coords) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)</span>
<span id="cb754-8"><a href="day-20.html#cb754-8"></a></span>
<span id="cb754-9"><a href="day-20.html#cb754-9"></a>n_knots &lt;-<span class="st"> </span><span class="dv">25</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb754-10"><a href="day-20.html#cb754-10"></a>knots &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb754-11"><a href="day-20.html#cb754-11"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lon), <span class="kw">max</span>(dat<span class="op">$</span>lon), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots)), </span>
<span id="cb754-12"><a href="day-20.html#cb754-12"></a>    <span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>lat), <span class="kw">max</span>(dat<span class="op">$</span>lat), <span class="dt">length =</span> <span class="kw">sqrt</span>(n_knots))</span>
<span id="cb754-13"><a href="day-20.html#cb754-13"></a>)</span>
<span id="cb754-14"><a href="day-20.html#cb754-14"></a></span>
<span id="cb754-15"><a href="day-20.html#cb754-15"></a>X_dense &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb754-16"><a href="day-20.html#cb754-16"></a>                                 <span class="dt">bandwith =</span> <span class="dv">5</span>)</span>
<span id="cb754-17"><a href="day-20.html#cb754-17"></a>X_sparse &lt;-<span class="st"> </span><span class="kw">make_kernel_basis</span>(coords, knots, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb754-18"><a href="day-20.html#cb754-18"></a>                                 <span class="dt">bandwith =</span> <span class="dv">5</span>, <span class="dt">threshold =</span> <span class="dv">5</span>)</span>
<span id="cb754-19"><a href="day-20.html#cb754-19"></a><span class="kw">mean</span>(X_dense <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="day-20.html#cb756-1"></a><span class="kw">mean</span>(X_sparse <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.7948237</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="day-20.html#cb758-1"></a><span class="co">## convert to a sparse matrix format</span></span>
<span id="cb758-2"><a href="day-20.html#cb758-2"></a>X_sparse &lt;-<span class="st"> </span><span class="kw">as.spam</span>(X_sparse)</span>
<span id="cb758-3"><a href="day-20.html#cb758-3"></a></span>
<span id="cb758-4"><a href="day-20.html#cb758-4"></a><span class="co">## calcuate t(X) %*% X for dense and sparse matrices</span></span>
<span id="cb758-5"><a href="day-20.html#cb758-5"></a>bm &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</span>
<span id="cb758-6"><a href="day-20.html#cb758-6"></a>    <span class="kw">crossprod</span>(X_dense, X_dense),</span>
<span id="cb758-7"><a href="day-20.html#cb758-7"></a>    <span class="kw">crossprod.spam</span>(X_sparse, X_sparse),</span>
<span id="cb758-8"><a href="day-20.html#cb758-8"></a>    <span class="dt">times =</span> <span class="dv">10</span></span>
<span id="cb758-9"><a href="day-20.html#cb758-9"></a>)</span>
<span id="cb758-10"><a href="day-20.html#cb758-10"></a></span>
<span id="cb758-11"><a href="day-20.html#cb758-11"></a>bm</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                                expr      min       lq     mean   median
##         crossprod(X_dense, X_dense) 899.5023 908.9407 912.1017 910.8700
##  crossprod.spam(X_sparse, X_sparse) 152.8823 153.4630 154.1771 154.3775
##        uq      max neval
##  913.8369 929.5905    10
##  154.8450 154.9862    10</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="day-20.html#cb760-1"></a><span class="kw">plot</span>(bm)</span></code></pre></div>
<p><img src="20-day-20_files/figure-html/sparse-kernels-1.png" width="672" /></p>
<ul>
<li>almost a 10-fold speedup in computation time by using sparse matrix operations</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wikle2019spatio">
<p>Wikle, Christopher K, Andrew Zammit-Mangion, and Noel Cressie. 2019. <em>Spatio-Temporal Statistics with R</em>. CRC Press.</p>
</div>
</div>

<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold-solution");
  $folds.wrapInner("<div class=\"fold-solution-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-solution-btn\">Show Solution</button>");  // add a button
  $(".fold-solution-blck").toggle();  // fold all blocks
  $(".fold-solution-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Hide Solution" ? "Show Solution" : "Hide Solution");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-solution-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>





<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold-proof");
  $folds.wrapInner("<div class=\"fold-proof-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-proof-btn\">Show Proof</button>");  // add a button
  $(".fold-proof-blck").toggle();  // fold all blocks
  $(".fold-proof-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Hide Proof" ? "Show Proof" : "Hide Proof");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-proof-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>
            </section>

          </div>
        </div>
      </div>
<a href="day-19.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-21.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["STAT-5413.pdf", "STAT-5413.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
